From deckrider at gmail.com  Fri Jul  1 17:59:05 2005
From: deckrider at gmail.com (David Everly)
Date: Fri, 1 Jul 2005 09:59:05 -0600
Subject: [Qrc-devel] ChangeLog
Message-ID: <20050701155904.GC4271@elbert.is-a-geek.org>

I've populated and committed the ChangeLog.  It has been previously
blank.

Rather than a commit-by-commit view, it tries to follow a friendlier
end-user approach to describing the primary changes from one release to
the next.

Please update and/or let me know in case anything is incorrect or
missing.
-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050701/938ec3a5/attachment.pgp>

From deckrider at gmail.com  Sun Jul  3 16:11:15 2005
From: deckrider at gmail.com (David Everly)
Date: Sun, 3 Jul 2005 08:11:15 -0600
Subject: [Qrc-devel] gaym->buddies and g_hash_table_new_full() question
Message-ID: <20050703141114.GD4271@elbert.is-a-geek.org>

Hi,

Is it a memory management issue that the third parameter to
g_hash_table_new_full() is NULL when building gaym->buddies?  I see this
documentation on the function, but I'm not sure I understand it.

http://developer.gnome.org/doc/API/2.0/glib/glib-Hash-Tables.html

Thanks,
Dave.
-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050703/29ad7bc6/attachment.pgp>

From deckrider at gmail.com  Sun Jul  3 18:50:22 2005
From: deckrider at gmail.com (David Everly)
Date: Sun, 3 Jul 2005 10:50:22 -0600
Subject: [Qrc-devel] "|" replaced by "."
Message-ID: <20050703165022.GF4271@elbert.is-a-geek.org>

Anyone know the original intent of replacing outbound "|" with "." ?

This seems to carry over into IM and Chat also, such that when I send
"|", "." is actually transmitted.
-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050703/22c505e3/attachment.pgp>

From deckrider at gmail.com  Tue Jul  5 15:10:05 2005
From: deckrider at gmail.com (David Everly)
Date: Tue, 5 Jul 2005 07:10:05 -0600
Subject: [Qrc-devel] Another Repository Reorg
Message-ID: <20050705131004.GB7480@elbert.is-a-geek.org>

Hi,

I'm doing a small repository reorg:

During the last reorg, we forgot to allow for additional modules (such
keeping our future home page under svn) as well as any branches and tags
within the each module.  So this is what I'll be changing.  The layout
of the qrc module itself should not change.

I'll send another mail when this is complete.

Thanks,
Dave.
-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050705/cc2cfec9/attachment.pgp>

From deckrider at gmail.com  Tue Jul  5 17:38:47 2005
From: deckrider at gmail.com (David Everly)
Date: Tue, 5 Jul 2005 09:38:47 -0600
Subject: [Qrc-devel] Re: Another Repository Reorg
In-Reply-To: <20050705131004.GB7480@elbert.is-a-geek.org>
References: <20050705131004.GB7480@elbert.is-a-geek.org>
Message-ID: <20050705153847.GC7480@elbert.is-a-geek.org>

This is complete.  The repository structure now is as follows:

Anonymous Root:
   svn://svn.berlios.de/qrc/

Developer Root
   svn+ssh://developername at svn.berlios.de/svnroot/repos/qrc/

There is currently only one module (qrc).  Here is the version
structure:

   qrc/
   qrc/branches/
   qrc/tags/
   qrc/tags/0.21.0/
   qrc/tags/0.33.0/
   qrc/tags/0.34.0/
   qrc/trunk/

Implications:

Typically development occurs on the trunk.  There are currently no
branches, but if there were, these will most likely be more stable than
the trunk.  And we will need to perform regular merges from the branches
to the trunk so that any branch features or fixes will not be lost.
Tags are snapshots in time and should not be altered.

To checkout the latest trunk revision of qrc, do one of the following:

svn co svn://svn.berlios.de/qrc/qrc/trunk
svn co ssh://developername at svn.berlios.de/svnroot/repos/qrc/qrc/trunk

Thanks,
Dave.

On Tue, Jul 05, 2005 at 07:10:05AM -0600,  wrote:
> Hi,
> 
> I'm doing a small repository reorg:
> 
> During the last reorg, we forgot to allow for additional modules (such
> keeping our future home page under svn) as well as any branches and
> tags within the each module.  So this is what I'll be changing.  The
> layout of the qrc module itself should not change.
> 
> I'll send another mail when this is complete.

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050705/a42a1e30/attachment.pgp>

From deckrider at gmail.com  Tue Jul  5 20:11:46 2005
From: deckrider at gmail.com (David Everly)
Date: Tue, 5 Jul 2005 12:11:46 -0600
Subject: [Qrc-devel] 0.34.0 release work
Message-ID: <20050705181145.GD7480@elbert.is-a-geek.org>

Greetings,

I've heard of no additional bugs that were not already in prior interim
releases, so I've tagged in svn, built the source dist for qrc-0.34.0,
and deployed it.

Based on this, I've also built and deployed the corresponding windows
package (it is built from gaim-1.3.0 but works also with gaim-1.3.1).

Additionally, I've built and uploaded corresponding debian/sarge
packages.  The Debian work is managed separately under a debian
subversion module within our berlios project's root.  It has also been
appropriately tagged within svn.  The Debian source and binary packages
are apt get-able as documented in qrc-debian.txt (on our project's
files page).

(Packaging is a distinctly separate activity from a source release.
If a bug is found in the package source there should be no need to
re-release the generic source.  I need to open a bug to separate windows
packaging similarly, since it currently lives in the main generic source
tree.)

Previously, i386 and src rpms have been built, but I have no system from
which to make this happen.  Have sent a note to Chris Weyl asking if he
would do this again, since he was the author of the previous rpms.

I'm not sure what system the original rpms were built for or anything,
but if anyone else knows what other packages can/should be available,
please let me know.

Hopefully, we can have another interim release soon.  (I personally find
bug 004424 -- and the overall cleanup of the "." and "|" process --
particularly urgent, since it currently causes communication/protocol
interference under certain circumstances.)

Pending a stable release (1.0.0), lets stick to an x.y.z notation where
x = 0, y is incremented for new/changed user features and behavior (z =
0 for these), and z is incremented when the release is strictly a bug
fix.

Thanks,
Dave.

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050705/fa029a21/attachment.pgp>

From deckrider at gmail.com  Thu Jul  7 15:51:59 2005
From: deckrider at gmail.com (David Everly)
Date: Thu, 7 Jul 2005 07:51:59 -0600
Subject: [Qrc-devel] 004276 - Change Bio / Profile Mapping
Message-ID: <20050707135158.GA19016@elbert.is-a-geek.org>

I'm getting ready to begin work on this.

My plans are to switch from using ISON to WHOIS for managing the buddy
list.  WHOIS will take a list of comma-separated nicks and return more
information than ISON returns.

The gay.com IRC server does support AWAY (to set an away message) and
WHO (which can show either G(one) or H(ere).  However, no one seems to
currently utilize that mechanism.  This fact, in combination with the
fact that WHO does not support multiple nicks, is why I'm heading to
using WHOIS to manage the buddy list.  (AWAY may still be useful to us
to set our own away messages, and I will keep my eyes open as to how it
might be used.)

This will allow tracking of additional information (such as Bio) in the
buddy list, which can then appear near the buddy's name as well as in
the tooltip.

I plan to use this as an informal status mechanism, ultimately allowing
Gaim's Away mechanism to update the Bio string to show when a GayM user
is away (this practice is already informally used by gay.com members).
When the user is not away, the normal Bio message would be set.

By the way, I've also investigated Gay.com's java applet which has an
"invisible" mode.  The result of enabling invisible is that a "NOTIFY
OFFLINE" is issued to current subscribers.  We don't currently use that
method--and ISON shows these users as online anyway.  I don't think this
is a good method to use for communicating/detecting state/availability.

Please let me know if you have any comments or suggestions on this.

Thanks,
Dave.

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050707/c556cc15/attachment.pgp>

From deckrider at gmail.com  Thu Jul  7 18:16:39 2005
From: deckrider at gmail.com (David Everly)
Date: Thu, 7 Jul 2005 10:16:39 -0600
Subject: [Qrc-devel] Bug Fix Release
Message-ID: <20050707161638.GB19016@elbert.is-a-geek.org>

Hi,

I believe the following bug is fixed (available in last night's build):

   004424 - Nickname bug

Overall, the work on this bug fixed the following:

   - Fixed protocol problem affecting member names beginning with
     non-alpha characters
   - Fixed problem where "|" was replaced by "." in Chat and IM messages
   - Addressed several memory leaks

This seems important enough to do a bug fix release, and I will do that
tomorrow if I don't hear of any objections or any additional bugs
expected to be fixed within a week.

Thanks,
Dave.

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050707/21ff1ee8/attachment.pgp>

From deckrider at gmail.com  Fri Jul  8 05:43:33 2005
From: deckrider at gmail.com (David Everly)
Date: Thu, 7 Jul 2005 21:43:33 -0600
Subject: [Qrc-devel] login process
Message-ID: <20050708034332.GD19016@elbert.is-a-geek.org>

This is probably not a good idea, but I keep thinking about it, so here
it is (just to get it off my chest):

We could just tell the users to log into gay.com from their web browser
(don't they have to do this anyway when clicking on full profile?).

Then after logging in they should go to:

   http://www.gay.com/messenger/get-chat-key.txt

and copy the password, pasting it into the Gaim password field.

This is the final password that is used for chat and all the other web
functions, so I think this eliminates dealing with any cookies.

Also, even if you change your web login password, that change does not
change the value returned in get-chat-key.txt.

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050707/da4f591c/attachment.pgp>

From deckrider at gmail.com  Fri Jul  8 17:53:20 2005
From: deckrider at gmail.com (deckrider at gmail.com)
Date: Fri, 8 Jul 2005 09:53:20 -0600
Subject: [Qrc-devel] QRC (GayM) 0.34.1 is Released!
Message-ID: <20050708155319.GF19016@elbert.is-a-geek.org>

Get your shiny new release of QRC (GayM) while its hot!

Check the release notes to see what is new:

   http://developer.berlios.de/project/shownotes.php?release_id=6457

Please help us continue to improve the QRC plugin collection by
reporting any bugs you find as well as any items that are on your
wishlist.

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050708/0293d4e8/attachment.pgp>

From deckrider at gmail.com  Sun Jul 10 00:53:19 2005
From: deckrider at gmail.com (David Everly)
Date: Sat, 9 Jul 2005 16:53:19 -0600
Subject: [Qrc-devel] Bio is now available from Buddy List
Message-ID: <20050709225318.GB2765@elbert.is-a-geek.org>

Hi,

The Bio is now available from the Buddy List (both in a possibly
truncated status message just under the name, and in a more complete
form within the tooltip text).

This could use some testing, since it changes completely the way the
buddy list status is maintained.  Formerly, ISON was used, but now WHOIS
is used.

Up to 10 users can be requested in a single WHOIS, so thats what I do.

During development, I had noticed during join, if I held the mouse over
the joining user, it was possible to make gaim crash.  I think this is
fixed (lots of null checking), but its hard to prove.

Please report any problem or misfeature you may encounter.

Thanks,
Dave.

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050709/a90d9fdd/attachment.pgp>

From Evan at CoolRunningConcepts.com  Mon Jul 11 07:38:40 2005
From: Evan at CoolRunningConcepts.com (Evan Langlois)
Date: Mon, 11 Jul 2005 00:38:40 -0500
Subject: [Qrc-devel] Bot Detection, part II
Message-ID: <1121060323.30982.32.camel@taro.coolrunningconcepts.com>

On the task of fightning bots and developing plugins ...

So, you have one of those new AI bots that wants to talk to you.  Its
BIO is clean - no URLS, like this one ...


Stats: Male | 19
Bio: Pvt is okay


Now here is the conversation:


gothwolf: Hi bot
amauglard: hello
gothwolf: lets test your AI
gothwolf: whats your name?
amauglard: see my profile with pics there -> geocities.com/johncampage ** BOT ALERT **
gothwolf: got ya


You'll notice that the bot detector finally detected it when he posted
the URL, and if I had "Ignore Bots" turned on, he would have been put on
ignore at that point.   However, you'll notice that I already knew it
was a bot when I talked to him!

How?

Well, the /trace command will give an IP, and I've already logged the
most common IPs of bots.  There are so far only about 16 in total.  Of
these 16, 3 are from cantv.net and 1 of those 3 is on spamhaus.   Of the
other 13, 7 are on spamhaus.  Over 50% hit ratio is over 50% chance that
any new IP we see that is a bot, will be on the spamhaus site, and few
real users will ever be listed on spamhaus as a spammer (providing you
use the known spammer one and not the open-relay one, but this could be
optional).  Anyway ...

1 - the same IPs are used for multiple bots - once an IP is detected, a
database can block the whole IP and all the bots at that address.   This
is a huge win for incorporating an IP check and an IP list.

2 - Similarly, a reverse of the /trace IP to get the domain name can be
fed into any URL based scan, so that instead of blocking large lists of
IPs, we can block large spam operations by domain, such as the
"genericrev.cantv.net" provider that many bots resolve to (the 3 IPs I
mentioned above)

3 - new bots could be detected by checking their IP against spamhaus or
possibly other RBLs.   Some of these IPs had multiple listings and are
registered in China.  I bet if you look them up and read the full
description you'd find the IP linked to international spam gangs.   Much
of the email spam can be traced to Russian Mafia.  I wouldn't be
surprised if these adbots root there as well.

4 - bots detected via other methods (my current bot code tries to detect
other possibilities besides URL) or user interaction (plugins can add
buttons) can be submitted to a central database.   Eventually they'll
run out of IPs to use.  Anyone know someone that would host a global
BOTRBL?

While a general URL based scanner that watches public, private, and join
messages can catch quite a bit of spam bots, I think if the individual
protocols could communicate IP based information as well as any other
information it finds, such as in a profile or something, I think we
could really make this work well.

-- Evan

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050711/e21073e8/attachment.html>

From deckrider at gmail.com  Wed Jul 13 17:08:22 2005
From: deckrider at gmail.com (David Everly)
Date: Wed, 13 Jul 2005 09:08:22 -0600
Subject: [Qrc-devel] java properties
Message-ID: <20050713150821.GB16498@elbert.is-a-geek.org>

Hi,

Much of what we do involves retrieving and using java properties files.
Some examples are:

   http://gay.com/messenger/get-profile.txt
   http://gay.com/messenger/lists.txt
   http://gay.com/messenger/config.txt

And as time goes by, there may be others we need to use.  Also, there is
much in http://gay.com/messenger/config.txt that we should use, but
currently don't take advantage of.

In helpers.[ch], I've addded the following:

   GHashTable *gaym_properties_new(const char *str);

I would like to suggest that we discontinue individual
processing/parsing of these files and use this function instead.

It will created a GHashTable using g_hash_table_new_full().  This means
that if/when you no longer need the GHashTable, use
g_hash_table_destroy().  There is no need to free the individual
elements.

To retrieve a property, use g_hash_table_lookup().

Thus, in our start up process, we should no longer create
gaym->configtxt, but create the equivalent GHashTable instead.

Then (for example) when we want to retrieve the the "mini" profile for
someone, we should not have a hard coded path (as we do now):

   char *infourl =
      g_strdup_printf(
         "http://www.gay.com/messenger/get-profile.txt?pw=%s&name=%s",
	 gaym->hash_pw,
	 gaym->whois.nick);

Instead, we should use the ohm.profile-url property:

   char *infourl =
      g_strdup_printf(
         "%s?pw=%s&name=%s",
	 g_hash_table_lookup(gaym->confighash, "ohm.profile-url"),
	 gaym->hash_pw,
	 gaym->whois.nick);

Thanks,
Dave.
-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050713/04bd720e/attachment.pgp>

From deckrider at gmail.com  Thu Jul 14 05:23:02 2005
From: deckrider at gmail.com (David Everly)
Date: Wed, 13 Jul 2005 21:23:02 -0600
Subject: [Qrc-devel] Re: configtxt/confighash performance
In-Reply-To: <20050714031920.GA9027@elbert.is-a-geek.org>
References: <20050714031920.GA9027@elbert.is-a-geek.org>
Message-ID: <20050714032302.GB9027@elbert.is-a-geek.org>

I forgot to mention...on my slow system, this takes 16 seconds!

$ cat /proc/cpuinfo
processor       : 0
vendor_id       : GenuineIntel
cpu family      : 6
model           : 6
model name      : Celeron (Mendocino)
stepping        : 0
cpu MHz         : 400.984
cache size      : 128 KB
fdiv_bug        : no
hlt_bug         : no
f00f_bug        : no
coma_bug        : no
fpu             : yes
fpu_exception   : yes
cpuid level     : 2
wp              : yes
flags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 mmx fxsr
bogomips        : 790.52

On Wed, Jul 13, 2005 at 09:19:21PM -0600,  wrote:
> When loading config.txt into the GHashTable within gaym_properties_new(),
> there is a performance pig that I've written to replace $0, $1, ...
> with %s, %s, ...
> 
>     for (i = 0; i < strlen(tmpstr); i++) {
>         if (tmpstr[i] == '$') {
>             if (g_ascii_isdigit(tmpstr[i + 1])) {
>                 tmpstr[i] = '%';
>                 tmpstr[i + 1] = 's';
>                 i++;
>             }
>         }
>     }
> 
> Anyone know a faster/better way?  I need to be sure not to change things
> like $this.variable$, but only the $N (where N is 0..9).
> 
> Thanks,
> Dave.
> -- 
> Encrypted Mail Preferred:
>     Key ID:  8527B9AF
>     Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
>     Information:  http://www.gnupg.org/
>                                                                                 
> ASCII ribbon campaign:
> ()  against HTML email
> /\  against Microsoft attachments
>     Information:  http://www.expita.com/nomime.html



-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050713/961cf413/attachment.pgp>

From deckrider at gmail.com  Thu Jul 14 05:23:02 2005
From: deckrider at gmail.com (deckrider at gmail.com)
Date: Wed, 13 Jul 2005 21:23:02 -0600
Subject: [Qrc-devel] Re: configtxt/confighash performance
In-Reply-To: <20050714031920.GA9027@elbert.is-a-geek.org>
References: <20050714031920.GA9027@elbert.is-a-geek.org>
Message-ID: <20050714032302.GB9027@elbert.is-a-geek.org>

I forgot to mention...on my slow system, this takes 16 seconds!

$ cat /proc/cpuinfo
processor       : 0
vendor_id       : GenuineIntel
cpu family      : 6
model           : 6
model name      : Celeron (Mendocino)
stepping        : 0
cpu MHz         : 400.984
cache size      : 128 KB
fdiv_bug        : no
hlt_bug         : no
f00f_bug        : no
coma_bug        : no
fpu             : yes
fpu_exception   : yes
cpuid level     : 2
wp              : yes
flags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 mmx fxsr
bogomips        : 790.52

On Wed, Jul 13, 2005 at 09:19:21PM -0600,  wrote:
> When loading config.txt into the GHashTable within gaym_properties_new(),
> there is a performance pig that I've written to replace $0, $1, ...
> with %s, %s, ...
> 
>     for (i = 0; i < strlen(tmpstr); i++) {
>         if (tmpstr[i] == '$') {
>             if (g_ascii_isdigit(tmpstr[i + 1])) {
>                 tmpstr[i] = '%';
>                 tmpstr[i + 1] = 's';
>                 i++;
>             }
>         }
>     }
> 
> Anyone know a faster/better way?  I need to be sure not to change things
> like $this.variable$, but only the $N (where N is 0..9).
> 
> Thanks,
> Dave.
> -- 
> Encrypted Mail Preferred:
>     Key ID:  8527B9AF
>     Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
>     Information:  http://www.gnupg.org/
>                                                                                 
> ASCII ribbon campaign:
> ()  against HTML email
> /\  against Microsoft attachments
>     Information:  http://www.expita.com/nomime.html



-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050713/961cf413/attachment-0001.pgp>

From deckrider at gmail.com  Thu Jul 14 06:59:37 2005
From: deckrider at gmail.com (David Everly)
Date: Wed, 13 Jul 2005 22:59:37 -0600
Subject: [Qrc-devel] Re: configtxt/confighash performance
In-Reply-To: <20050714032302.GB9027@elbert.is-a-geek.org>
References: <20050714031920.GA9027@elbert.is-a-geek.org> <20050714032302.GB9027@elbert.is-a-geek.org>
Message-ID: <20050714045937.GD9027@elbert.is-a-geek.org>

Ok, I have it down to 2-3 seconds by processing only the hash table
values after loading the hash table--instead of processing the entire
config.txt file.  Still, if there are any improvments to be had, I'm
interested

On Wed, Jul 13, 2005 at 09:23:02PM -0600,  wrote:
> I forgot to mention...on my slow system, this takes 16 seconds!
> 
> $ cat /proc/cpuinfo
> processor       : 0
> vendor_id       : GenuineIntel
> cpu family      : 6
> model           : 6
> model name      : Celeron (Mendocino)
> stepping        : 0
> cpu MHz         : 400.984
> cache size      : 128 KB
> fdiv_bug        : no
> hlt_bug         : no
> f00f_bug        : no
> coma_bug        : no
> fpu             : yes
> fpu_exception   : yes
> cpuid level     : 2
> wp              : yes
> flags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 mmx fxsr
> bogomips        : 790.52
> 
> On Wed, Jul 13, 2005 at 09:19:21PM -0600,  wrote:
> > When loading config.txt into the GHashTable within gaym_properties_new(),
> > there is a performance pig that I've written to replace $0, $1, ...
> > with %s, %s, ...
> > 
> >     for (i = 0; i < strlen(tmpstr); i++) {
> >         if (tmpstr[i] == '$') {
> >             if (g_ascii_isdigit(tmpstr[i + 1])) {
> >                 tmpstr[i] = '%';
> >                 tmpstr[i + 1] = 's';
> >                 i++;
> >             }
> >         }
> >     }
> > 
> > Anyone know a faster/better way?  I need to be sure not to change things
> > like $this.variable$, but only the $N (where N is 0..9).
> > 
> > Thanks,
> > Dave.
> > -- 
> > Encrypted Mail Preferred:
> >     Key ID:  8527B9AF
> >     Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
> >     Information:  http://www.gnupg.org/
> >                                                                                 
> > ASCII ribbon campaign:
> > ()  against HTML email
> > /\  against Microsoft attachments
> >     Information:  http://www.expita.com/nomime.html
> 
> 
> 
> -- 
> Encrypted Mail Preferred:
>     Key ID:  8527B9AF
>     Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
>     Information:  http://www.gnupg.org/
>                                                                                 
> ASCII ribbon campaign:
> ()  against HTML email
> /\  against Microsoft attachments
>     Information:  http://www.expita.com/nomime.html



-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050713/68b6990e/attachment.pgp>

From deckrider at gmail.com  Sat Jul 16 01:45:34 2005
From: deckrider at gmail.com (David Everly)
Date: Fri, 15 Jul 2005 17:45:34 -0600
Subject: [Qrc-devel] spam info
Message-ID: <20050715234533.GA2895@elbert.is-a-geek.org>

After using this commit for a bit, it seems that a very large amount
of spam (and very little--if any--actual people have :0: for their
code ("no pic and no profile").

For instance here is one raw:

:irc16.live.gay.com 311 deckrider pillance 10358415_999452 * *
:0:/2/86/ad/988120-0-22b832-0-thumb.jpg#18 yo,  5'10, 150, fair, PVT to
playI'm Justin. See my page:  geocities . com / videojust

Unfortunately, this doesn't seem to get the ones that login for a sec
and spew the same url about 4 times in the channel, and then leave.
They have :8: for their code:

:irc16.live.gay.com 311 deckrider Jamesbryant022 10373184_100093 * *
:8:#I need a roommate

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
An embedded message was scrubbed...
From: David Everly at BerliOS <deckrider at berlios.de>
Subject: [Qrc-svn] r210 - qrc/trunk/gaym/src
Date: Sat, 16 Jul 2005 00:46:20 +0200
Size: 6675
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050715/2cb92d9e/attachment.mht>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050715/2cb92d9e/attachment.pgp>

From Evan at CoolRunningConcepts.com  Sat Jul 16 04:48:11 2005
From: Evan at CoolRunningConcepts.com (Evan Langlois)
Date: Fri, 15 Jul 2005 21:48:11 -0500
Subject: [Qrc-devel] spam info
In-Reply-To: <20050715234533.GA2895@elbert.is-a-geek.org>
References: <20050715234533.GA2895@elbert.is-a-geek.org>
Message-ID: <1121482091.13572.6.camel@taro.coolrunningconcepts.com>

On Fri, 2005-07-15 at 17:45 -0600, David Everly wrote:
> After using this commit for a bit, it seems that a very large amount
> of spam (and very little--if any--actual people have :0: for their
> code ("no pic and no profile").

I don't believe this will be reliable.

> For instance here is one raw:
> 
> :irc16.live.gay.com 311 deckrider pillance 10358415_999452 * *
> :0:/2/86/ad/988120-0-22b832-0-thumb.jpg#18 yo,  5'10, 150, fair, PVT to
> playI'm Justin. See my page:  geocities . com / videojust

Under the new algorithm I want to implement, geocities isn't blocked
directly since some people have don't like that (false positives),
however I plan on having a secondary match list to check when geocities
is part of the tested string.  Since geocities matches above, we'd use
the secondary list, and videojust happens to be on that list.

So .. this would be flagged as a bot, and his IP (200.101.123.122) would
also be added as a bot-IP.  Blocking anyone else at that IP.

Secondly, if the URL didn't match at all, and the IP wasn't on the
blocklist already, and it is, then the RBL check shows that IP as being
on the Spamhaus XBL, so again, its a bot, and its blocked.

> Unfortunately, this doesn't seem to get the ones that login for a sec
> and spew the same url about 4 times in the channel, and then leave.
> They have :8: for their code:

This is why an IP check should be done on join as well as the URL check,
and anything they say in channel (like the URL they plaster) should also
be checked against both the static lists I have and an RBL check.  The
message can then be blocked and the bot ignored before the user sees the
message.

I may not have time this weekend to work on this as planned, but I'll
try.





From deckrider at gmail.com  Sat Jul 16 05:11:20 2005
From: deckrider at gmail.com (David Everly)
Date: Fri, 15 Jul 2005 21:11:20 -0600
Subject: [Qrc-devel] spam info
In-Reply-To: <1121482091.13572.6.camel@taro.coolrunningconcepts.com>
References: <20050715234533.GA2895@elbert.is-a-geek.org> <1121482091.13572.6.camel@taro.coolrunningconcepts.com>
Message-ID: <20050716031120.GA15031@elbert.is-a-geek.org>

On Fri, Jul 15, 2005 at 09:48:11PM -0500, Evan Langlois wrote:
> On Fri, 2005-07-15 at 17:45 -0600, David Everly wrote:
> > After using this commit for a bit, it seems that a very large amount
> > of spam (and very little--if any--actual people have :0: for their
> > code ("no pic and no profile").
> 
> I don't believe this will be reliable.

Yeah, I agree that the RBL check is probably better.  I just hadn't
noticed this before, so thought I should report it.

> > For instance here is one raw:
> > 
> > :irc16.live.gay.com 311 deckrider pillance 10358415_999452 * *
> > :0:/2/86/ad/988120-0-22b832-0-thumb.jpg#18 yo,  5'10, 150, fair, PVT to
> > playI'm Justin. See my page:  geocities . com / videojust
> 
> Under the new algorithm I want to implement, geocities isn't blocked
> directly since some people have don't like that (false positives),
> however I plan on having a secondary match list to check when geocities
> is part of the tested string.  Since geocities matches above, we'd use
> the secondary list, and videojust happens to be on that list.
> 
> So .. this would be flagged as a bot, and his IP (200.101.123.122) would
> also be added as a bot-IP.  Blocking anyone else at that IP.
> 
> Secondly, if the URL didn't match at all, and the IP wasn't on the
> blocklist already, and it is, then the RBL check shows that IP as being
> on the Spamhaus XBL, so again, its a bot, and its blocked.
> 
> > Unfortunately, this doesn't seem to get the ones that login for a sec
> > and spew the same url about 4 times in the channel, and then leave.
> > They have :8: for their code:
> 
> This is why an IP check should be done on join as well as the URL check,
> and anything they say in channel (like the URL they plaster) should also
> be checked against both the static lists I have and an RBL check.  The
> message can then be blocked and the bot ignored before the user sees the
> message.
> 
> I may not have time this weekend to work on this as planned, but I'll
> try.
> 
> 
> 

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050715/be8aa102/attachment.pgp>

From deckrider at gmail.com  Sat Jul 16 16:09:40 2005
From: deckrider at gmail.com (David Everly)
Date: Sat, 16 Jul 2005 08:09:40 -0600
Subject: [Qrc-devel] roomlist performance
Message-ID: <20050716140939.GA2525@elbert.is-a-geek.org>

I've been looking into roomlist performance.  I believe the fault
of how slow it is belongs with the Gaim API:

Within build_roomlist_from_config(), if I comment out any calls to the
following ...

   gaim_roomlist_room_add_field()
   gaim_roomlist_room_add()

... the build_roomlist_from_config() completes within less than 1
second.

This is because these Gaim functions use g_list_append(), which gets
slower and slower (linear) as the size of the GList increases: the end
of the list is not saved and g_list append must start and the beginning
of the list and walk through it to find the end so as to perform the
append operation. And we have a large list of rooms.

Current default preferences build 4 chatroom instances for each room
encountered in the config.txt roomlist (i.e. 999=1, 999=2, 999=3, 999=4
in addition to the 999=*).  This takes about 12 seconds to build the
list (when the above Gaim functions are enabled).

If I change this to building no instances (i.e. building only the exact
contents of the config.txt roomlist), it takes between 1 and 1.5 seconds
to do this.

So I think what I'll do is interpret the roomlist literally, and then
implement prpl_info->roomlist_expand_category(list, category) to build
the individual instances when the user clicks to open a category to find
the individual instances.

What I don't see doing is somehow parsing only part of the config.txt
roomlist, since this would become more complex to go back and re-parse
parts of it as the user expands various categories.

Let me know what you think,
Dave

PS:  To give the above times a context:

$ cat /proc/cpuinfo

processor       : 0
vendor_id       : GenuineIntel
cpu family      : 6
model           : 6
model name      : Celeron (Mendocino)
stepping        : 0
cpu MHz         : 400.965
cache size      : 128 KB
fdiv_bug        : no
hlt_bug         : no
f00f_bug        : no
coma_bug        : no
fpu             : yes
fpu_exception   : yes
cpuid level     : 2
wp              : yes
flags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge
                  mca cmov pat pse36 mmx fxsr
bogomips        : 790.52

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050716/ba8bfb41/attachment.pgp>

From gaym at jasonlebrun.info  Sat Jul 16 13:03:53 2005
From: gaym at jasonlebrun.info (Jason LeBrun)
Date: Sat, 16 Jul 2005 13:03:53 +0200
Subject: [Qrc-devel] roomlist performance
In-Reply-To: <20050716140939.GA2525@elbert.is-a-geek.org>
References: <20050716140939.GA2525@elbert.is-a-geek.org>
Message-ID: <1121511834.24325.4.camel@localhost>

> This is because these Gaim functions use g_list_append(), which gets
> slower and slower (linear) as the size of the GList increases: the end
> of the list is not saved and g_list append must start and the beginning
> of the list and walk through it to find the end so as to perform the
> append operation. And we have a large list of rooms.

I think that this wasn't a problem with roomlist because it normally
added the rooms one at a time via callbacks, as IRC returned roomlist
messages. If we could spawn a second thread thta populated the list, it
would most likely solve the problem (at the expense of race conditions
introduced by threading, since threading is basically non-existent in
gaim.)




> So I think what I'll do is interpret the roomlist literally, and then
> implement prpl_info->roomlist_expand_category(list, category) to build
> the individual instances when the user clicks to open a category to find
> the individual instances.
> 

That sounds like  a good idea to me.

Jason




From Evan at CoolRunningConcepts.com  Sat Jul 16 20:38:26 2005
From: Evan at CoolRunningConcepts.com (Evan Langlois)
Date: Sat, 16 Jul 2005 13:38:26 -0500
Subject: [Qrc-devel] roomlist performance
In-Reply-To: <20050716140939.GA2525@elbert.is-a-geek.org>
References: <20050716140939.GA2525@elbert.is-a-geek.org>
Message-ID: <1121539108.13266.50.camel@taro.coolrunningconcepts.com>

On Sat, 2005-07-16 at 08:09 -0600, David Everly wrote:
> This is because these Gaim functions use g_list_append(), which gets
> slower and slower (linear) as the size of the GList increases: the end
> of the list is not saved and g_list append must start and the beginning
> of the list and walk through it to find the end so as to perform the
> append operation. And we have a large list of rooms.

Yup - and its a memory hog too - does EVER do a reverse search?  GList
is a doubly linked list  :/

> So I think what I'll do is interpret the roomlist literally, and then
> implement prpl_info->roomlist_expand_category(list, category) to build
> the individual instances when the user clicks to open a category to find
> the individual instances.

And in the future, that would be a good place to stick any "detect
number of rooms" code.   Basically just a WHO or NAMES or whatever on
the =1, =2, =3, etc, until you don't get any results :)  This seems like
a good idea to me.

> What I don't see doing is somehow parsing only part of the config.txt
> roomlist, since this would become more complex to go back and re-parse
> parts of it as the user expands various categories.

That wouldn't give you much benefit I don't think.  However, if you
wanted to do something similar, parse the whole list of rooms into some
other structure as an intermediate storage area (some sort of tree, and
without the leaf rooms which should still be on-the-fly).  Build it
directly without any searches.  Since its more closely modeled on the
gay.com room list tree, it should be faster to manipulate and possibly
may only require moving some pointers around when the user expands a
branch.

-- Evan




From deckrider at gmail.com  Sun Jul 17 23:22:08 2005
From: deckrider at gmail.com (David Everly)
Date: Sun, 17 Jul 2005 15:22:08 -0600
Subject: [Qrc-devel] Chat Room Thumbnails
Message-ID: <20050717212208.GD2525@elbert.is-a-geek.org>

Hi,

Here is a small dirty patch that shows thumbnail photos in the chat room
as people join.  I generated the patch from SVN revision 215.

This is mostly to show that its possible to do this and to generate some
comment.  Ultimately, I would prefer a chat room user list that looks
like the buddy list.  However, since that seems like it might be a lot
more work, and since there are some Gaim people who have indicated they
are working in that direction, perhaps something similar to this
approach might be ok for the interim?

I thought it might be nice to put the thumbnail in the extra join
message, but also thought that might delay the join announcement, so I'm
simply adding the photo to the chat area when it becomes available.

Again, the patch could probably be better, right now its just a proof of
concept and a tool to generate discussion.  Any comments?

Thanks,
Dave.

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
Index: gaym/src/msgs.c
===================================================================
--- gaym/src/msgs.c	(revision 215)
+++ gaym/src/msgs.c	(working copy)
@@ -105,6 +105,44 @@
     g_free(d);
 }
 
+typedef struct _ChatThumbnailData ChatThumbnailData;
+struct _ChatThumbnailData {
+    struct gaym_conn *gaym;
+    char *nick;
+    char *channel;
+};
+
+void gaym_chat_thumbnail_cb(void *user_data, const char *pic_data,
+                            size_t len)
+{
+    int id = 0;
+
+    if (!user_data || !pic_data) {
+        return;
+    }
+
+    ChatThumbnailData *d = user_data;
+
+    if (GAIM_CONNECTION_IS_VALID(d->gaym->account->gc) && len) {
+        id = gaim_imgstore_add(pic_data, len, NULL);
+
+        GaimConversation *conv =
+            gaim_find_conversation_with_account(d->channel,
+                                                d->gaym->account);
+        char *picture = g_strdup_printf("%s:  <img id=%d>", d->nick, id);
+        gaim_conversation_write(conv, "THUMB", picture,
+                                GAIM_MESSAGE_SYSTEM | GAIM_MESSAGE_NO_LOG,
+                                time(NULL));
+        gaim_imgstore_unref(id);
+    } else {
+        gaim_debug_error("gaym", "Fetching buddy icon failed.\n");
+    }
+
+    g_free(d->nick);
+    g_free(d->channel);
+    g_free(d);
+}
+
 static void gaym_fetch_photo_cb(void *user_data, const char *info_data,
                                 size_t len)
 {
@@ -703,6 +741,24 @@
 
     gaym_buddy_status(gaym, nick, TRUE, args[1]);
 
+    ChatThumbnailData *d = g_new0(ChatThumbnailData, 1);
+    d->nick = g_strdup(nick);
+    d->channel = g_strdup(args[0]);
+    d->gaym = gaym;
+    char *thumbpath = gaym_thumbnail_strdup(args[1]);
+    char *hashurl = NULL;
+    hashurl =
+        g_hash_table_lookup(gaym->confighash,
+                            "mini-profile-panel.thumbnail-prefix");
+    char *url = g_strdup_printf("%s%s", hashurl, thumbpath);
+
+    if (hashurl && thumbpath) {
+        gaim_url_fetch(url, FALSE, "Mozilla/4.0", FALSE,
+                       gaym_chat_thumbnail_cb, d);
+    }
+    g_free(thumbpath);
+    g_free(url);
+
     gboolean gaym_botfilter_permit =
         gaym_botfilter_check(gc, nick, bio, FALSE);
 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050717/ff111c3a/attachment.pgp>

From deckrider at gmail.com  Mon Jul 18 01:44:32 2005
From: deckrider at gmail.com (David Everly)
Date: Sun, 17 Jul 2005 17:44:32 -0600
Subject: [Qrc-devel] Re: Chat Room Thumbnails
In-Reply-To: <20050717212208.GD2525@elbert.is-a-geek.org>
References: <20050717212208.GD2525@elbert.is-a-geek.org>
Message-ID: <20050717234431.GE2525@elbert.is-a-geek.org>

It seems that scrolling doesn't work well unless there is a character
after the photo.  This patch is slightly different from the earlier one,
in that it adds a single space after the picture so scrolling isn't so
irritating.

On Sun, Jul 17, 2005 at 03:22:08PM -0600,  wrote:
> Hi,
> 
> Here is a small dirty patch that shows thumbnail photos in the chat room
> as people join.  I generated the patch from SVN revision 215.
> 
> This is mostly to show that its possible to do this and to generate some
> comment.  Ultimately, I would prefer a chat room user list that looks
> like the buddy list.  However, since that seems like it might be a lot
> more work, and since there are some Gaim people who have indicated they
> are working in that direction, perhaps something similar to this
> approach might be ok for the interim?
> 
> I thought it might be nice to put the thumbnail in the extra join
> message, but also thought that might delay the join announcement, so I'm
> simply adding the photo to the chat area when it becomes available.
> 
> Again, the patch could probably be better, right now its just a proof of
> concept and a tool to generate discussion.  Any comments?

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
Index: gaym/src/msgs.c
===================================================================
--- gaym/src/msgs.c	(revision 215)
+++ gaym/src/msgs.c	(working copy)
@@ -105,6 +105,44 @@
     g_free(d);
 }
 
+typedef struct _ChatThumbnailData ChatThumbnailData;
+struct _ChatThumbnailData {
+    struct gaym_conn *gaym;
+    char *nick;
+    char *channel;
+};
+
+void gaym_chat_thumbnail_cb(void *user_data, const char *pic_data,
+                            size_t len)
+{
+    int id = 0;
+
+    if (!user_data || !pic_data) {
+        return;
+    }
+
+    ChatThumbnailData *d = user_data;
+
+    if (GAIM_CONNECTION_IS_VALID(d->gaym->account->gc) && len) {
+        id = gaim_imgstore_add(pic_data, len, NULL);
+
+        GaimConversation *conv =
+            gaim_find_conversation_with_account(d->channel,
+                                                d->gaym->account);
+        char *picture = g_strdup_printf("%s:  <img id=%d> ", d->nick, id);
+        gaim_conversation_write(conv, "THUMB", picture,
+                                GAIM_MESSAGE_SYSTEM | GAIM_MESSAGE_NO_LOG,
+                                time(NULL));
+        gaim_imgstore_unref(id);
+    } else {
+        gaim_debug_error("gaym", "Fetching buddy icon failed.\n");
+    }
+
+    g_free(d->nick);
+    g_free(d->channel);
+    g_free(d);
+}
+
 static void gaym_fetch_photo_cb(void *user_data, const char *info_data,
                                 size_t len)
 {
@@ -703,6 +741,24 @@
 
     gaym_buddy_status(gaym, nick, TRUE, args[1]);
 
+    ChatThumbnailData *d = g_new0(ChatThumbnailData, 1);
+    d->nick = g_strdup(nick);
+    d->channel = g_strdup(args[0]);
+    d->gaym = gaym;
+    char *thumbpath = gaym_thumbnail_strdup(args[1]);
+    char *hashurl = NULL;
+    hashurl =
+        g_hash_table_lookup(gaym->confighash,
+                            "mini-profile-panel.thumbnail-prefix");
+    char *url = g_strdup_printf("%s%s", hashurl, thumbpath);
+
+    if (hashurl && thumbpath) {
+        gaim_url_fetch(url, FALSE, "Mozilla/4.0", FALSE,
+                       gaym_chat_thumbnail_cb, d);
+    }
+    g_free(thumbpath);
+    g_free(url);
+
     gboolean gaym_botfilter_permit =
         gaym_botfilter_check(gc, nick, bio, FALSE);
 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050717/7ca84f7b/attachment.pgp>

From gaym at jasonlebrun.info  Wed Jul 20 06:47:00 2005
From: gaym at jasonlebrun.info (Jason LeBrun)
Date: Tue, 19 Jul 2005 23:47:00 -0500
Subject: [Qrc-devel] Re: Chat Room Thumbnails
In-Reply-To: <20050717234431.GE2525@elbert.is-a-geek.org>
References: <20050717212208.GD2525@elbert.is-a-geek.org>
	 <20050717234431.GE2525@elbert.is-a-geek.org>
Message-ID: <1121834820.16892.2.camel@localhost>

Neat patch. I made a branch in svn so that it can be checked out.

svn co svn://svn.berlios.de/qrc/qrc/branches/thumbnail_in_chat qrc-thumb

> > Here is a small dirty patch that shows thumbnail photos in the chat room
> > as people join.  I generated the patch from SVN revision 215.




From deckrider at gmail.com  Wed Jul 20 14:00:55 2005
From: deckrider at gmail.com (David Everly)
Date: Wed, 20 Jul 2005 06:00:55 -0600
Subject: [Qrc-devel] Re: Chat Room Thumbnails
In-Reply-To: <1121834820.16892.2.camel@localhost>
References: <20050717212208.GD2525@elbert.is-a-geek.org> <20050717234431.GE2525@elbert.is-a-geek.org> <1121834820.16892.2.camel@localhost>
Message-ID: <20050720120055.GB10874@elbert.is-a-geek.org>

What kind of options do you think this should have?  I was thinking of
using the "Interface | Buddy List | Show buddy icons" option that Gaim
already has.  But perhaps there is an argument for having its own
option?

Also, I think perhaps I'll add some sizing and other things to make the
display more consistent.  Last night someone joined whose photo took up
the entire window, which makes it hard to follow a conversation thread.

I'll work to finish this up over the weekend and have a commit to the
main trunk then.  By then, I'll have integrated the functionality more
properly with the rest of the system.

On Tue, Jul 19, 2005 at 11:47:00PM -0500, Jason LeBrun wrote:
> Neat patch. I made a branch in svn so that it can be checked out.
> 
> svn co svn://svn.berlios.de/qrc/qrc/branches/thumbnail_in_chat qrc-thumb
> 
> > > Here is a small dirty patch that shows thumbnail photos in the chat room
> > > as people join.  I generated the patch from SVN revision 215.
> 
> 
> _______________________________________________
> Qrc-devel mailing list
> Qrc-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/qrc-devel
> 

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050720/712a45f4/attachment.pgp>

From deckrider at gmail.com  Wed Jul 20 13:53:58 2005
From: deckrider at gmail.com (David Everly)
Date: Wed, 20 Jul 2005 05:53:58 -0600
Subject: [Qrc-devel] user type codes/flags
Message-ID: <20050720115357.GA10874@elbert.is-a-geek.org>

There is currently the following flags for gay.com users, which ar
mapped to these GaimConvChatBuddyFlags:

   :0:   GAIM_CBFLAGS_NONE
   :8:   GAIM_CBFLAGS_HALFOP
   :18:  GAIM_CBFLAGS_FOUNDER
   :19:  GAIM_CBFLAGS_OP

Last night I saw this flag:

   :1c:

Does anyone know what it means?  Or is it some brain-dead client that
someone wrote?  Unfortunately, the client can specify anything in this
field--I've tried it.  Same for the thumbnail path too.

Here's what I think the flags we have coded for mean (please correct if
you have better information):

   :0:   no profile and no photo
   :8:   profile but no photo
   :18:  profile and g-rated photo
   :19:  profile and x-rated photo

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050720/3d964ff0/attachment.pgp>

From gaym at jasonlebrun.info  Thu Jul 21 20:01:16 2005
From: gaym at jasonlebrun.info (Jason LeBrun)
Date: Thu, 21 Jul 2005 13:01:16 -0500
Subject: [Qrc-devel] Roomlist order
Message-ID: <1121968876.16892.7.camel@localhost>

Hi,

I committed some modifications (r219) that change the way the roomlist
is populated. Now, you can build with the chatsort plugin enabled
(./configure --enable-chatsort) and if the plugin is enabled, then when
you enter a room, it will not be alpha sorted.

If you're bored, please throw every tough situation you can think of at
this code. I'm made some assumptions about command ordering that may not
hold. If you can get some race conditions to occur, please report them. 

If there is a general negative consensus, I will make a separate svn
copy to further develop this code, rather than developing it on the
mainline.

r219 also throws thumbnails in the bio when full photo is not available.

Jason




From deckrider at gmail.com  Thu Jul 21 20:35:45 2005
From: deckrider at gmail.com (David Everly)
Date: Thu, 21 Jul 2005 12:35:45 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r219 - qrc/trunk/gaym/src
In-Reply-To: <200507211758.j6LHw8jW012383@sheep.berlios.de>
References: <200507211758.j6LHw8jW012383@sheep.berlios.de>
Message-ID: <20050721183545.GA29906@elbert.is-a-geek.org>

On Thu, Jul 21, 2005 at 07:58:08PM +0200, Jason LeBrun at BerliOS wrote:
> Author: jblebrun
> Date: 2005-07-21 19:58:07 +0200 (Thu, 21 Jul 2005)
> New Revision: 219
> 
> Modified:
>    qrc/trunk/gaym/src/gaym.h
>    qrc/trunk/gaym/src/gayminfo.h
>    qrc/trunk/gaym/src/msgs.c
> Log:
> *THIS REVISION NOT SUITABLE FOR RELEASE! 
> 
> *Changed the way the room list is populated initially. 

I assume this is the chat room member list and not the room list (room
list being things like "Denver", "Sacramento", etc.).  True?

> It is more inefficient, but it allows for proper sorting by entry
> order, via the chatsort plugin. This method is a point of debate, due
> to the notable change in roomlist formation. I will fork this code if
> people are unhappy with it.
> 
> *Info dialog shows thumbnail instead of full photo, if no full photo is
> available (adult photos)
> 
> gaym.h: added join_flags to gaym_conn struct, which is populated during
> richnames list, but USED during the subsequent "Names" messages that allows
> us to populate roomlist in entry order.
> 
> gayminfo.h: added thumbnail field to fetch_thumbail_data struct. (Why the
> hell did I name it that, if it didn't even have a thumbnail in it?)

Actually, gaym_fetch_info_cb() should use the photos found in
http://www.gay.com/messenger/get-profile.txt (ohm.profile-url from
confit.txt) and not the thumbnail found from the whois.  The whois
thumbnail is the smaller one used for buddy list, chatroom member list,
etc.  So while we do need to refactor this aspect, I disagree with this
approach.

> msgs.c:
> *richnames messages no longer populate roomlist, they just populate a flags
> list. 
> 
> *info_needed_callback fallsback to thumbnail photo if no full photo exists.

My impression here is that this indicates a highjacked thumbnail, which
is often used by bots.  Not sure we want to embrace this practice.  Can
we discuss?

> *msgs_names now populates the list if gaym->nameconv is null. So, on a
> join_msg, indicating a successful room join, a names command is immediately
> sent out. The response of that names message is what triggers list
> population.

I'm not sure I understand why we need this extra network call.  Are you
saying the original join result does not give the names in the order you
want?  What order does the join result give?  What does the java applet
do?

> Modified: qrc/trunk/gaym/src/gaym.h
> ===================================================================
> --- qrc/trunk/gaym/src/gaym.h	2005-07-21 02:10:29 UTC (rev 218)
> +++ qrc/trunk/gaym/src/gaym.h	2005-07-21 17:58:07 UTC (rev 219)
> @@ -77,7 +77,7 @@
>      gboolean blist_updating;
>      GHashTable *info_window_needed;
>      GHashTable *im_thumbnail_needed;
> -
> +    GList *join_flags; //Temporary holding space for join flags. 
>      GString *motd;
>      GString *names;
>      char *nameconv;
> 
> Modified: qrc/trunk/gaym/src/gayminfo.h
> ===================================================================
> --- qrc/trunk/gaym/src/gayminfo.h	2005-07-21 02:10:29 UTC (rev 218)
> +++ qrc/trunk/gaym/src/gayminfo.h	2005-07-21 17:58:07 UTC (rev 219)
> @@ -37,6 +37,7 @@
>      char *who;
>      char *bio;
>      char *stats;
> +    char *thumbnail;
>  };
>  void gaym_fetch_thumbnail_cb(void *user_data, const char *pic_data,
>                               size_t len);
> 
> Modified: qrc/trunk/gaym/src/msgs.c
> ===================================================================
> --- qrc/trunk/gaym/src/msgs.c	2005-07-21 02:10:29 UTC (rev 218)
> +++ qrc/trunk/gaym/src/msgs.c	2005-07-21 17:58:07 UTC (rev 219)
> @@ -199,6 +199,20 @@
>  
>      picpath = return_string_between(match, "\n", info_data);
>      if (!picpath || strlen(picpath) == 0) {
> +
> +	if(d->thumbnail) {
> +            hashurl =
> +                g_hash_table_lookup(gaym->confighash,
> +                                    "mini-profile-panel.thumbnail-prefix");
> +	    picurl = g_strdup_printf("%s%s",hashurl,d->thumbnail);
> +	    if(picurl) {
> +		gaim_url_fetch(picurl, FALSE, "Mozilla/4.0 (compatible; MSIE 5.0)",
> +                       FALSE, gaym_fetch_photo_cb, user_data);
> +	    
> +		return; 
> +	    }
> +	    
> +	}
>          gaim_notify_userinfo(d->gc, d->who,
>                               t = g_strdup_printf("Gay.com - %s", d->who),
>                               d->who, NULL, info, NULL, NULL);
> @@ -207,6 +221,7 @@
>      }
>  
>      picurl = g_strdup_printf("http://www.gay.com%s", picpath);
> +   
>      if (picurl) {
>          gaim_url_fetch(picurl, FALSE, "Mozilla/4.0 (compatible; MSIE 5.0)",
>                         FALSE, gaym_fetch_photo_cb, user_data);
> @@ -283,6 +298,7 @@
>          data->who = g_strdup(args[1]);
>          data->bio = gaym_bio_strdup(args[5]);
>          data->stats = gaym_stats_strdup(args[5]);
> +	data->thumbnail = gaym_thumbnail_strdup(args[5]);
>  
>          char *infourl = g_strdup_printf("%s?pw=%s&name=%s", hashurl,
>                                          gaym->hash_pw, args[1]);
> @@ -414,7 +430,7 @@
>          if (!convo) {
>              gaim_debug(GAIM_DEBUG_ERROR, "gaym",
>                         "Got a NAMES list for %s, which doesn't exist\n",
> -                       args[2]);
> +                       args[1]);
>              g_string_free(gaym->names, TRUE);
>              gaym->names = NULL;
>              g_free(gaym->nameconv);
> @@ -442,44 +458,47 @@
>              gaym->nameconv = NULL;
>          } else {
>              GList *users = NULL;
> -            GList *flags = NULL;
>  
> -            while (*cur) {
> -                GaimConvChatBuddyFlags f = GAIM_CBFLAGS_NONE;
> +	    gaim_debug_misc("gaym","Using names for initial list population");
> +	    while (*cur) {
>                  end = strchr(cur, ' ');
> -                if (!end)
> -                    end = cur + strlen(cur);
> -                if (*cur == '@') {
> -                    f = GAIM_CBFLAGS_OP;
> -                    cur++;
> -                } else if (*cur == '%') {
> -                    f = GAIM_CBFLAGS_HALFOP;
> -                    cur++;
> -                } else if (*cur == '+') {
> -                    f = GAIM_CBFLAGS_VOICE;
> -                    cur++;
> -                }
> +                //if (!end)
> +                //    end = cur + strlen(cur);
> +                //if (*cur == '@') {
> +                //    f = GAIM_CBFLAGS_OP;
> +                //    cur++;
> +                //} else if (*cur == '%') {
> +                //    f = GAIM_CBFLAGS_HALFOP;
> +                //    cur++;
> +                //} else if (*cur == '+') {
> +                //    f = GAIM_CBFLAGS_VOICE;
> +                //    cur++;
> +                // }
>                  tmp = g_strndup(cur, end - cur);
> +
> +		gcom_nick_to_gaym(tmp);
>                  users = g_list_prepend(users, tmp);
> -                flags = g_list_prepend(flags, GINT_TO_POINTER(f));
> +                //flags = g_list_prepend(flags, GINT_TO_POINTER(f));
>                  cur = end;
>                  if (*cur)
>                      cur++;
>              }
> -            users = g_list_reverse(users);
> -            flags = g_list_reverse(flags);
> +	    //users = g_list_reverse(users);
> +            //flags = g_list_reverse(flags);
>  
>              if (users != NULL) {
>                  GList *l;
>  
>                  gaim_conv_chat_add_users(GAIM_CONV_CHAT(convo), users,
> -                                         flags);
> +                                         gaym->join_flags);
>  
> +		
>                  for (l = users; l != NULL; l = l->next)
>                      g_free(l->data);
>  
>                  g_list_free(users);
> -                g_list_free(flags);
> +                g_list_free(gaym->join_flags);
> +		gaym->join_flags=NULL;
>              }
>          }
>          g_free(names);
> @@ -689,6 +708,8 @@
>          }
>  
>          serv_got_joined_chat(gc, id++, args[0]);
> +	
> +	gaym_cmd_names(gaym, "names", NULL, args);
>          g_free(nick);
>          return;
>      }
> @@ -1236,7 +1257,7 @@
>  {
>      GaimConnection *gc = gaim_account_get_connection(gaym->account);
>      GaimConversation *convo;
> -    GaimConvChatBuddyFlags flags = GAIM_CBFLAGS_NONE;
> +    GaimConvChatBuddyFlags flags;
>      char *channel = args[1];
>      char *nick = args[2];
>      char *extra = args[4];
> @@ -1266,10 +1287,12 @@
>      }
>  
>      flags = chat_pecking_order(extra);
> +    
> +    //g_hash_table_insert(gaym->join_flags, g_strdup(nick), flags);
> +    gaym->join_flags=g_list_prepend(gaym->join_flags, GINT_TO_POINTER(flags));
> +    //gaim_conv_chat_add_user(GAIM_CONV_CHAT(convo), nick, NULL, flags,
> +    //                        FALSE);
>  
> -    gaim_conv_chat_add_user(GAIM_CONV_CHAT(convo), nick, NULL, flags,
> -                            FALSE);
> -
>      /**
>       * Make the ignore.png icon appear next to the nick.
>       */
> 
> _______________________________________________
> Qrc-svn mailing list
> Qrc-svn at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/qrc-svn
> 

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050721/897b41d6/attachment.pgp>

From deckrider at gmail.com  Thu Jul 21 20:48:50 2005
From: deckrider at gmail.com (David Everly)
Date: Thu, 21 Jul 2005 12:48:50 -0600
Subject: [Qrc-devel] Roomlist order
In-Reply-To: <1121968876.16892.7.camel@localhost>
References: <1121968876.16892.7.camel@localhost>
Message-ID: <20050721184850.GB29906@elbert.is-a-geek.org>

I've replied to the commit, but perhaps I should also reply to this...

On Thu, Jul 21, 2005 at 01:01:16PM -0500, Jason LeBrun wrote:
> Hi,
> 
> I committed some modifications (r219) that change the way the roomlist
> is populated. Now, you can build with the chatsort plugin enabled
> (./configure --enable-chatsort) and if the plugin is enabled, then when
> you enter a room, it will not be alpha sorted.
> 
> If you're bored, please throw every tough situation you can think of at
> this code. I'm made some assumptions about command ordering that may not
> hold. If you can get some race conditions to occur, please report them. 

Would you please help us understand why the additional complexity and
additional network traffic is needed here?  Does the join not already
provide the results in the correct order, or an order that would be
correct if it was reversed?

And how does this work with other prpls, such as Yahoo?  Is there a
customization required in them also, or do we need to conform to the
practice of the other prpls?

> If there is a general negative consensus, I will make a separate svn
> copy to further develop this code, rather than developing it on the
> mainline.

The trunk is normally where the new stuff goes, so I have no issue with
that.  You'll notice Gaim follows this approach also.  So I have no
issue with your commit in this respect.

> r219 also throws thumbnails in the bio when full photo is not available.

Under what circumstances is a bio thumbnail available when a full photo
is not?  My impression is that this is only the case for spam/bots.  And
if my impression is correct, then I would disagree with enabling this
spam/bot behavior.

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050721/ba98deec/attachment.pgp>

From evan at coolrunningconcepts.com  Thu Jul 21 22:33:59 2005
From: evan at coolrunningconcepts.com (evan at coolrunningconcepts.com)
Date: Thu, 21 Jul 2005 14:33:59 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r219 - qrc/trunk/gaym/src
In-Reply-To: <20050721183545.GA29906@elbert.is-a-geek.org>
References: <200507211758.j6LHw8jW012383@sheep.berlios.de>
	<20050721183545.GA29906@elbert.is-a-geek.org>
Message-ID: <20050721143359.7dx2dky6kh0ggo08@coolrunningconcepts.com>

Quoting David Everly <deckrider at gmail.com>:

> Actually, gaym_fetch_info_cb() should use the photos found in
> http://www.gay.com/messenger/get-profile.txt (ohm.profile-url from
> confit.txt) and not the thumbnail found from the whois.  The whois
> thumbnail is the smaller one used for buddy list, chatroom member list,
> etc.  So while we do need to refactor this aspect, I disagree with this
> approach.

I think hes doing this so that the thumbnail is available in case the full
picture isn't around.

> My impression here is that this indicates a highjacked thumbnail, which
> is often used by bots.  Not sure we want to embrace this practice.  Can
> we discuss?

Bots are a completely different issue and quite detectable.  I just don't know
if I have the time to implement my algorythm.   What it comes down to, is the
user asked for the information, so lets show them all we have.  Showing the
thumbnail when no picture is available might make it easier for the user to
recognize the bot as being a bot!  Hiding information has no purpose, IMHO.

> I'm not sure I understand why we need this extra network call.  Are you
> saying the original join result does not give the names in the order you
> want?  What order does the join result give?  What does the java applet
> do?

I'm not what purpose this has either.  Probably just to make the first 
change he
mentioned be consistent, so that the channel member list is always 
populated by
the same calls ... am I right?




From deckrider at gmail.com  Thu Jul 21 23:11:02 2005
From: deckrider at gmail.com (David Everly)
Date: Thu, 21 Jul 2005 15:11:02 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r219 - qrc/trunk/gaym/src
In-Reply-To: <20050721143359.7dx2dky6kh0ggo08@coolrunningconcepts.com>
References: <200507211758.j6LHw8jW012383@sheep.berlios.de> <20050721183545.GA29906@elbert.is-a-geek.org> <20050721143359.7dx2dky6kh0ggo08@coolrunningconcepts.com>
Message-ID: <20050721211101.GA32617@elbert.is-a-geek.org>

On Thu, Jul 21, 2005 at 02:33:59PM -0600, evan at coolrunningconcepts.com wrote:
> Quoting David Everly <deckrider at gmail.com>:
> 
> >Actually, gaym_fetch_info_cb() should use the photos found in
> >http://www.gay.com/messenger/get-profile.txt (ohm.profile-url from
> >confit.txt) and not the thumbnail found from the whois.  The whois
> >thumbnail is the smaller one used for buddy list, chatroom member list,
> >etc.  So while we do need to refactor this aspect, I disagree with this
> >approach.
> 
> I think hes doing this so that the thumbnail is available in case the full
> picture isn't around.

Yes, I think that is what is being done here also ...

> >My impression here is that this indicates a highjacked thumbnail, which
> >is often used by bots.  Not sure we want to embrace this practice.  Can
> >we discuss?
> 
> Bots are a completely different issue and quite detectable.  I just don't 
> know
> if I have the time to implement my algorythm.   What it comes down to, is 
> the
> user asked for the information, so lets show them all we have.  Showing the
> thumbnail when no picture is available might make it easier for the user to
> recognize the bot as being a bot!  Hiding information has no purpose, IMHO.

This isn't hiding anything.  Its being more honest than the user who is
pretending to have a thumbnail without actually uploading a picture or a
profile.

If the user uploaded a photo, the thumbnail derives from that, so that
user will have BOTH a photo AND a thumbnail.

If there is a thumbnail and no photo or profile, then the reality is:
that user doesn't have a photo and we should not pretend he does by
displaying the thumbnail that he claims is his when trying to display
the mini-profile.

--
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050721/17827783/attachment.pgp>

From evan at coolrunningconcepts.com  Fri Jul 22 00:23:26 2005
From: evan at coolrunningconcepts.com (evan at coolrunningconcepts.com)
Date: Thu, 21 Jul 2005 16:23:26 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r219 - qrc/trunk/gaym/src
In-Reply-To: <20050721211101.GA32617@elbert.is-a-geek.org>
References: <200507211758.j6LHw8jW012383@sheep.berlios.de>
	<20050721183545.GA29906@elbert.is-a-geek.org>
	<20050721143359.7dx2dky6kh0ggo08@coolrunningconcepts.com>
	<20050721211101.GA32617@elbert.is-a-geek.org>
Message-ID: <20050721162326.lhrxc30v6cgkscs8@coolrunningconcepts.com>

Quoting David Everly <deckrider at gmail.com>:

> If there is a thumbnail and no photo or profile, then the reality is:
> that user doesn't have a photo and we should not pretend he does by
> displaying the thumbnail that he claims is his when trying to display
> the mini-profile.

Wrong it means he uploaded a photo, but has it marked either private or adult,
and you don't have permission to view it.   You are allowed to view the
thumbnail of these photos in chat (not on the web page though).  The case of
bots is the exception, not the rule.  Everyone with an adult photo that 
you try
to Get Info on without having a premium account will simple not 
display, but you
CAN see the thumbnail in the IM window.   Why force people to open the 
IM window
to see it?



From gaym at jasonlebrun.info  Fri Jul 22 04:19:04 2005
From: gaym at jasonlebrun.info (Jason LeBrun)
Date: Thu, 21 Jul 2005 21:19:04 -0500
Subject: [Qrc-devel] Re: [Qrc-svn] r219 - qrc/trunk/gaym/src
In-Reply-To: <20050721183545.GA29906@elbert.is-a-geek.org>
References: <200507211758.j6LHw8jW012383@sheep.berlios.de>
	 <20050721183545.GA29906@elbert.is-a-geek.org>
Message-ID: <1121998744.16892.24.camel@localhost>

> Actually, gaym_fetch_info_cb() should use the photos found in
> http://www.gay.com/messenger/get-profile.txt (ohm.profile-url from
> confit.txt) and not the thumbnail found from the whois.  The whois
> thumbnail is the smaller one used for buddy list, chatroom member list,
> etc.  So while we do need to refactor this aspect, I disagree with this
> approach.
> 

I'm not sure what you mean, here. If there is a photo URL specified in
get-profile.txt, it is still used. As Evan said, if another user has an
adult picture, and the gaym user is not a "premium" member, then the
gaym user will be able to see the thumbnail, but not the full photo. I'd
like to see at least this thumbnail, rather than nothing at all.


> My impression here is that this indicates a highjacked thumbnail, which
> is often used by bots.  Not sure we want to embrace this practice.  Can
> we discuss?

See comment above.

> > *msgs_names now populates the list if gaym->nameconv is null. So, on a
> > join_msg, indicating a successful room join, a names command is immediately
> > sent out. The response of that names message is what triggers list
> > population.
> 
> I'm not sure I understand why we need this extra network call.  Are you
> saying the original join result does not give the names in the order you
> want?  What order does the join result give?  What does the java applet
> do?
> 

When you join a room, the gay.com server responds with a series of
message #690, one for each user. Unfortunately, these messages come in
the order of "newest first". If they came in the order "oldest first,"
there would be no problem. Assume that there were 5 people in the room
when you enter, and then one more enters after you. Then if you simply
sort by the order that the name list was populated, you'd see:

7
6 <---you
1
2
3
4
5

Part of this solution has to do with the way gaim handles user joins.
There is only one signal: chat-buddy-joined. There is no way to
differentiate the behavior between joins that occur when you enter the
channel, and joins that occur after you enter the channel. Gaim just
automatically sorts the list by alpha, so it was never really an issue.
The best way to handle this would be a patch to Gaim that lets us handle
this properly. However, one of my goals personally throughout this
project has been to completely avoid requiring a patch to Gaim, since
many people are unlikely to bother.

The extra "names" call gives us a way to populate the list in one shot.
On further thought (i.e., as I've been typing this) I realize that a
temporary list could be populated as the 690's flow in, and then
reversed at the end. The trick is detecting the "end". There is no
message to demarcate the end, so you have to insert *some* command of
your own that the server can respond to, that will signal the end.

I'm fairly certain that the flow of 690 messages will never be
interrupted. I did a lot of tests, and could not get them to be
interrupted by an intermediate command. I.e., the text flow always looks
like:

690 gaydude
690 guy
690 person
NAMES
690 queer
690 lost_dyke
690 jailbait
690 final_690
NAMES RESPONSE

I will make the changes now to avoid the NAMES command. I will replace
it with a PING, or something. Are there any thoughts about which command
the gay.com server will give the fastest response for? PING seems the
most likely candidate.


Jason



From gaym at jasonlebrun.info  Fri Jul 22 05:07:09 2005
From: gaym at jasonlebrun.info (Jason LeBrun)
Date: Thu, 21 Jul 2005 22:07:09 -0500
Subject: [Qrc-devel] Re: Chat Room Thumbnails
In-Reply-To: <20050720120055.GB10874@elbert.is-a-geek.org>
References: <20050717212208.GD2525@elbert.is-a-geek.org>
	 <20050717234431.GE2525@elbert.is-a-geek.org>
	 <1121834820.16892.2.camel@localhost>
	 <20050720120055.GB10874@elbert.is-a-geek.org>
Message-ID: <1122001629.16892.37.camel@localhost>

If it's going to be in the main trunk, it should definitely be its own
option separate from "Show buddy icons". The buddy icons in pvt messages
windows are much less obtrusive then those directly in the chat window.

It would be nice if we could make a GTK plugin that added a little icon
display just beneath the names list, showing the thumbnail of whoever
was currently selected (a la chat client).

Jason

On Wed, 2005-07-20 at 06:00 -0600, David Everly wrote:
> What kind of options do you think this should have?  I was thinking of
> using the "Interface | Buddy List | Show buddy icons" option that Gaim
> already has.  But perhaps there is an argument for having its own
> option?
> 
> Also, I think perhaps I'll add some sizing and other things to make the
> display more consistent.  Last night someone joined whose photo took up
> the entire window, which makes it hard to follow a conversation thread.
> 
> I'll work to finish this up over the weekend and have a commit to the
> main trunk then.  By then, I'll have integrated the functionality more
> properly with the rest of the system.
> 
> On Tue, Jul 19, 2005 at 11:47:00PM -0500, Jason LeBrun wrote:
> > Neat patch. I made a branch in svn so that it can be checked out.
> > 
> > svn co svn://svn.berlios.de/qrc/qrc/branches/thumbnail_in_chat qrc-thumb
> > 
> > > > Here is a small dirty patch that shows thumbnail photos in the chat room
> > > > as people join.  I generated the patch from SVN revision 215.
> > 
> > 
> > _______________________________________________
> > Qrc-devel mailing list
> > Qrc-devel at lists.berlios.de
> > http://lists.berlios.de/mailman/listinfo/qrc-devel
> > 
> 



From evan at coolrunningconcepts.com  Fri Jul 22 05:20:25 2005
From: evan at coolrunningconcepts.com (evan at coolrunningconcepts.com)
Date: Thu, 21 Jul 2005 21:20:25 -0600
Subject: [Qrc-devel] Re: Chat Room Thumbnails
In-Reply-To: <1122001629.16892.37.camel@localhost>
References: <20050717212208.GD2525@elbert.is-a-geek.org>
	<20050717234431.GE2525@elbert.is-a-geek.org>
	<1121834820.16892.2.camel@localhost>
	<20050720120055.GB10874@elbert.is-a-geek.org>
	<1122001629.16892.37.camel@localhost>
Message-ID: <20050721212025.4n22g8kzfx8kk0s0@coolrunningconcepts.com>

Quoting Jason LeBrun <gaym at jasonlebrun.info>:

> If it's going to be in the main trunk, it should definitely be its own
> option separate from "Show buddy icons". The buddy icons in pvt messages
> windows are much less obtrusive then those directly in the chat window.
>
> It would be nice if we could make a GTK plugin that added a little icon
> display just beneath the names list, showing the thumbnail of whoever
> was currently selected (a la chat client).

Actually its possible to add a button to the interface from a plugin.  
I've seen
a few plugins that do this.   Would it be possible to change the image 
used for
new button based on the thumbnail of the currently selected user.  I 
don't know
what clicking it would do - I guess the same as "Get Info", although a more
detailed GUI picture browser could be done too since it seems to be okay to
make GTK calls from plugins.   Just having the prpl add the button and perform
Get Info when clicked should be enough though for a start.





From gaym at jasonlebrun.info  Fri Jul 22 06:22:15 2005
From: gaym at jasonlebrun.info (Jason LeBrun)
Date: Thu, 21 Jul 2005 23:22:15 -0500
Subject: [Qrc-devel] Re: Chat Room Thumbnails
In-Reply-To: <20050721212025.4n22g8kzfx8kk0s0@coolrunningconcepts.com>
References: <20050717212208.GD2525@elbert.is-a-geek.org>
	 <20050717234431.GE2525@elbert.is-a-geek.org>
	 <1121834820.16892.2.camel@localhost>
	 <20050720120055.GB10874@elbert.is-a-geek.org>
	 <1122001629.16892.37.camel@localhost>
	 <20050721212025.4n22g8kzfx8kk0s0@coolrunningconcepts.com>
Message-ID: <1122006135.16892.41.camel@localhost>

It would be. I just committed a framework we can use. Right now, it just
puts the selected user's name in a button that does nothing. We can
replace the button with an image Widget, and add an icon cache, and it's
done.

Jason

>  Would it be possible to change the image 
> used for
> new button based on the thumbnail of the currently selected user.  I 
> don't know
> what clicking it would do - I guess the same as "Get Info", although a more
> detailed GUI picture browser could be done too since it seems to be okay to
> make GTK calls from plugins.   Just having the prpl add the button and perform
> Get Info when clicked should be enough though for a start.
> 
> 
> 
> _______________________________________________
> Qrc-devel mailing list
> Qrc-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/qrc-devel



From evan at coolrunningconcepts.com  Fri Jul 22 06:50:11 2005
From: evan at coolrunningconcepts.com (evan at coolrunningconcepts.com)
Date: Thu, 21 Jul 2005 22:50:11 -0600
Subject: [Qrc-devel] Re: Chat Room Thumbnails
In-Reply-To: <1122006135.16892.41.camel@localhost>
References: <20050717212208.GD2525@elbert.is-a-geek.org>
	<20050717234431.GE2525@elbert.is-a-geek.org>
	<1121834820.16892.2.camel@localhost>
	<20050720120055.GB10874@elbert.is-a-geek.org>
	<1122001629.16892.37.camel@localhost>
	<20050721212025.4n22g8kzfx8kk0s0@coolrunningconcepts.com>
	<1122006135.16892.41.camel@localhost>
Message-ID: <20050721225011.t1qqf78panwgsw4s@coolrunningconcepts.com>

Quoting Jason LeBrun <gaym at jasonlebrun.info>:

> It would be. I just committed a framework we can use. Right now, it just
> puts the selected user's name in a button that does nothing. We can
> replace the button with an image Widget, and add an icon cache, and it's
> done.

Very cool!






From deckrider at gmail.com  Fri Jul 22 06:18:43 2005
From: deckrider at gmail.com (David Everly)
Date: Thu, 21 Jul 2005 22:18:43 -0600
Subject: [Qrc-devel] Re: Chat Room Thumbnails
In-Reply-To: <1122001629.16892.37.camel@localhost>
References: <20050717212208.GD2525@elbert.is-a-geek.org> <20050717234431.GE2525@elbert.is-a-geek.org> <1121834820.16892.2.camel@localhost> <20050720120055.GB10874@elbert.is-a-geek.org> <1122001629.16892.37.camel@localhost>
Message-ID: <20050722041842.GB5928@elbert.is-a-geek.org>

On Thu, Jul 21, 2005 at 10:07:09PM -0500, Jason LeBrun wrote:
> If it's going to be in the main trunk, it should definitely be its own
> option separate from "Show buddy icons". The buddy icons in pvt messages
> windows are much less obtrusive then those directly in the chat window.

I'm really in no hurry to commit this, since I think there are other
better ways.

> It would be nice if we could make a GTK plugin that added a little icon
> display just beneath the names list, showing the thumbnail of whoever
> was currently selected (a la chat client).

I keep wondering if we couldn't somehow put the <img=id> right in with
the user name in the channel users list.  I haven't tried it but thats
what I would really like to see (similar to the buddy list).  Then there
is no clicking, only scrolling.

> On Wed, 2005-07-20 at 06:00 -0600, David Everly wrote:
> > What kind of options do you think this should have?  I was thinking of
> > using the "Interface | Buddy List | Show buddy icons" option that Gaim
> > already has.  But perhaps there is an argument for having its own
> > option?
> > 
> > Also, I think perhaps I'll add some sizing and other things to make the
> > display more consistent.  Last night someone joined whose photo took up
> > the entire window, which makes it hard to follow a conversation thread.
> > 
> > I'll work to finish this up over the weekend and have a commit to the
> > main trunk then.  By then, I'll have integrated the functionality more
> > properly with the rest of the system.
> > 
> > On Tue, Jul 19, 2005 at 11:47:00PM -0500, Jason LeBrun wrote:
> > > Neat patch. I made a branch in svn so that it can be checked out.
> > > 
> > > svn co svn://svn.berlios.de/qrc/qrc/branches/thumbnail_in_chat qrc-thumb
> > > 
> > > > > Here is a small dirty patch that shows thumbnail photos in the chat room
> > > > > as people join.  I generated the patch from SVN revision 215.
> > > 
> > > 
> > > _______________________________________________
> > > Qrc-devel mailing list
> > > Qrc-devel at lists.berlios.de
> > > http://lists.berlios.de/mailman/listinfo/qrc-devel
> > > 
> > 
> 

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050721/2b1fb421/attachment.pgp>

From evan at coolrunningconcepts.com  Fri Jul 22 07:06:43 2005
From: evan at coolrunningconcepts.com (evan at coolrunningconcepts.com)
Date: Thu, 21 Jul 2005 23:06:43 -0600
Subject: [Qrc-devel] Re: Chat Room Thumbnails
In-Reply-To: <20050722041842.GB5928@elbert.is-a-geek.org>
References: <20050717212208.GD2525@elbert.is-a-geek.org>
	<20050717234431.GE2525@elbert.is-a-geek.org>
	<1121834820.16892.2.camel@localhost>
	<20050720120055.GB10874@elbert.is-a-geek.org>
	<1122001629.16892.37.camel@localhost>
	<20050722041842.GB5928@elbert.is-a-geek.org>
Message-ID: <20050721230643.ye482kc3rls0ocsw@coolrunningconcepts.com>

Quoting David Everly <deckrider at gmail.com>:

> I keep wondering if we couldn't somehow put the <img=id> right in with
> the user name in the channel users list.  I haven't tried it but thats
> what I would really like to see (similar to the buddy list).  Then there
> is no clicking, only scrolling.

Not sure if it will work.   And it would use quite a bit more memory and the
list would end up MUCH bigger so you'd have to scroll really far.  
Would likely
look pretty good if it worked.


-- Evan




From deckrider at gmail.com  Fri Jul 22 06:15:28 2005
From: deckrider at gmail.com (David Everly)
Date: Thu, 21 Jul 2005 22:15:28 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r219 - qrc/trunk/gaym/src
In-Reply-To: <1121998744.16892.24.camel@localhost>
References: <200507211758.j6LHw8jW012383@sheep.berlios.de> <20050721183545.GA29906@elbert.is-a-geek.org> <1121998744.16892.24.camel@localhost>
Message-ID: <20050722041527.GA5928@elbert.is-a-geek.org>

On Thu, Jul 21, 2005 at 09:19:04PM -0500, Jason LeBrun wrote:
> 
> > Actually, gaym_fetch_info_cb() should use the photos found in
> > http://www.gay.com/messenger/get-profile.txt (ohm.profile-url from
> > confit.txt) and not the thumbnail found from the whois.  The whois
> > thumbnail is the smaller one used for buddy list, chatroom member list,
> > etc.  So while we do need to refactor this aspect, I disagree with this
> > approach.
> > 
> 
> I'm not sure what you mean, here. If there is a photo URL specified in
> get-profile.txt, it is still used.

I have no issue so far...

> As Evan said, if another user has an
> adult picture, and the gaym user is not a "premium" member, then the
> gaym user will be able to see the thumbnail, but not the full photo. I'd
> like to see at least this thumbnail, rather than nothing at all.

I think ultimately this thumbnail should be shown somewhere else already
without the user having to go to the mini profile to see it.  For
instance, next to the user it belongs to in the channel's member list.

> > My impression here is that this indicates a highjacked thumbnail, which
> > is often used by bots.  Not sure we want to embrace this practice.  Can
> > we discuss?
> 
> See comment above.
> 
> > > *msgs_names now populates the list if gaym->nameconv is null. So, on a
> > > join_msg, indicating a successful room join, a names command is immediately
> > > sent out. The response of that names message is what triggers list
> > > population.
> > 
> > I'm not sure I understand why we need this extra network call.  Are you
> > saying the original join result does not give the names in the order you
> > want?  What order does the join result give?  What does the java applet
> > do?
> > 
> 
> When you join a room, the gay.com server responds with a series of
> message #690, one for each user. Unfortunately, these messages come in
> the order of "newest first". If they came in the order "oldest first,"
> there would be no problem. Assume that there were 5 people in the room
> when you enter, and then one more enters after you. Then if you simply
> sort by the order that the name list was populated, you'd see:
> 
> 7
> 6 <---you
> 1
> 2
> 3
> 4
> 5
> 
> Part of this solution has to do with the way gaim handles user joins.
> There is only one signal: chat-buddy-joined. There is no way to
> differentiate the behavior between joins that occur when you enter the
> channel, and joins that occur after you enter the channel. Gaim just
> automatically sorts the list by alpha, so it was never really an issue.
> The best way to handle this would be a patch to Gaim that lets us handle
> this properly. However, one of my goals personally throughout this
> project has been to completely avoid requiring a patch to Gaim, since
> many people are unlikely to bother.
> 
> The extra "names" call gives us a way to populate the list in one shot.
> On further thought (i.e., as I've been typing this) I realize that a
> temporary list could be populated as the 690's flow in, and then
> reversed at the end. The trick is detecting the "end". There is no
> message to demarcate the end, so you have to insert *some* command of
> your own that the server can respond to, that will signal the end.
> 
> I'm fairly certain that the flow of 690 messages will never be
> interrupted. I did a lot of tests, and could not get them to be
> interrupted by an intermediate command. I.e., the text flow always looks
> like:
> 
> 690 gaydude
> 690 guy
> 690 person
> NAMES
> 690 queer
> 690 lost_dyke
> 690 jailbait
> 690 final_690
> NAMES RESPONSE
> 
> I will make the changes now to avoid the NAMES command. I will replace
> it with a PING, or something. Are there any thoughts about which command
> the gay.com server will give the fastest response for? PING seems the
> most likely candidate.

Yes, this is where I was going...

And here is another option that involves no extra network stuff.

Reverse the list before the join and again after the join.  I know this
sounds strange, but this way, there is never any worry about a race
condition.  And there are no extra network calls.  To me, its an easy
trade off to have c code that isn't fully optimized to save an
extra network call to the server.  Especially if we are considerate to
those who have dialup connections.

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050721/cd736140/attachment.pgp>

From jason at jasonlebrun.info  Fri Jul 22 07:30:44 2005
From: jason at jasonlebrun.info (Jason LeBrun)
Date: Fri, 22 Jul 2005 00:30:44 -0500
Subject: [Qrc-devel] Re: Chat Room Thumbnails
In-Reply-To: <20050721230643.ye482kc3rls0ocsw@coolrunningconcepts.com>
References: <20050717212208.GD2525@elbert.is-a-geek.org>
	 <20050717234431.GE2525@elbert.is-a-geek.org>
	 <1121834820.16892.2.camel@localhost>
	 <20050720120055.GB10874@elbert.is-a-geek.org>
	 <1122001629.16892.37.camel@localhost>
	 <20050722041842.GB5928@elbert.is-a-geek.org>
	 <20050721230643.ye482kc3rls0ocsw@coolrunningconcepts.com>
Message-ID: <1122010244.16892.43.camel@localhost>

My hunch is that it will not work. I think that the <img=id> thing is a
part of the GtkImHtml widget, only. I could be wrong.

On Thu, 2005-07-21 at 23:06 -0600, evan at coolrunningconcepts.com wrote:
> Quoting David Everly <deckrider at gmail.com>:
> 
> > I keep wondering if we couldn't somehow put the <img=id> right in with
> > the user name in the channel users list.  I haven't tried it but thats
> > what I would really like to see (similar to the buddy list).  Then there
> > is no clicking, only scrolling.
> 
> Not sure if it will work.   And it would use quite a bit more memory and the
> list would end up MUCH bigger so you'd have to scroll really far.  
> Would likely
> look pretty good if it worked.
> 
> 
> -- Evan
> 
> 
> _______________________________________________
> Qrc-devel mailing list
> Qrc-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/qrc-devel



From gaym at jasonlebrun.info  Fri Jul 22 07:51:24 2005
From: gaym at jasonlebrun.info (Jason LeBrun)
Date: Fri, 22 Jul 2005 00:51:24 -0500
Subject: [Qrc-devel] Re: [Qrc-svn] r219 - qrc/trunk/gaym/src
In-Reply-To: <20050722041527.GA5928@elbert.is-a-geek.org>
References: <200507211758.j6LHw8jW012383@sheep.berlios.de>
	 <20050721183545.GA29906@elbert.is-a-geek.org>
	 <1121998744.16892.24.camel@localhost>
	 <20050722041527.GA5928@elbert.is-a-geek.org>
Message-ID: <1122011484.16892.61.camel@localhost>

The extra network command would *still* be necessary to tell when we are
"done" joining the room so that the list can be reversed. There is no
special message that indicates the end of the #690 messages. I don't
think one extra PING is going to be "unfair" for dialup users. :)

As for reversing the list, it's not trivial to simply reverse the gaim
room namelist. it's a gtk element, a GtkListStore, which is displayed in
a GtkTreeView, a sort of content/presentation split. I played around for
a long time with various sorting options, and have not had much luck.
There is no "reverse" function for a GtkListStore, unless it's already
got a sort function applied to it. But if you apply a sort function to
it, you lose the entry order, forever, as far as I can tell, since it's
just the arbitrary way that items are put into the list initially.


> And here is another option that involves no extra network stuff.
> 
> Reverse the list before the join and again after the join.  I know this
> sounds strange, but this way, there is never any worry about a race
> condition.  And there are no extra network calls.  To me, its an easy
> trade off to have c code that isn't fully optimized to save an
> extra network call to the server.  Especially if we are considerate to
> those who have dialup connections.
> 



From evan at coolrunningconcepts.com  Fri Jul 22 07:55:19 2005
From: evan at coolrunningconcepts.com (evan at coolrunningconcepts.com)
Date: Thu, 21 Jul 2005 23:55:19 -0600
Subject: [Qrc-devel] Re: Chat Room Thumbnails
In-Reply-To: <1122010244.16892.43.camel@localhost>
References: <20050717212208.GD2525@elbert.is-a-geek.org>
	<20050717234431.GE2525@elbert.is-a-geek.org>
	<1121834820.16892.2.camel@localhost>
	<20050720120055.GB10874@elbert.is-a-geek.org>
	<1122001629.16892.37.camel@localhost>
	<20050722041842.GB5928@elbert.is-a-geek.org>
	<20050721230643.ye482kc3rls0ocsw@coolrunningconcepts.com>
	<1122010244.16892.43.camel@localhost>
Message-ID: <20050721235519.uyelvbiow0g8oowg@coolrunningconcepts.com>

Quoting Jason LeBrun <jason at jasonlebrun.info>:

> My hunch is that it will not work. I think that the <img=id> thing is a
> part of the GtkImHtml widget, only. I could be wrong.

That was my understanding, however, there are icons next to the names - 
it would
be nice if there was a way to trick GAIM into displaying the thumbnails 
instead
.. possibly with an option for "Don't display adult thumbnails" ... I've seen
enough cock - it all looks the same





From deckrider at gmail.com  Fri Jul 22 13:44:38 2005
From: deckrider at gmail.com (David Everly)
Date: Fri, 22 Jul 2005 05:44:38 -0600
Subject: [Qrc-devel] nightly build didn't run
Message-ID: <20050722114438.GA29614@elbert.is-a-geek.org>

The nightly build didn't run last night.  Tried to run it by hand
this morning but am still getting:

   svn: Can't connect to host 'svn.berlios.de': Connection refused


-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050722/f9088c3b/attachment.pgp>

From deckrider at gmail.com  Fri Jul 22 15:33:15 2005
From: deckrider at gmail.com (David Everly)
Date: Fri, 22 Jul 2005 07:33:15 -0600
Subject: [Qrc-devel] chatsort / 690
In-Reply-To: <20050722041527.GA5928@elbert.is-a-geek.org>
References: <200507211758.j6LHw8jW012383@sheep.berlios.de> <20050721183545.GA29906@elbert.is-a-geek.org> <1121998744.16892.24.camel@localhost> <20050722041527.GA5928@elbert.is-a-geek.org>
Message-ID: <20050722133315.GB29614@elbert.is-a-geek.org>

On Thu, Jul 21, 2005 at 10:15:27PM -0600,  wrote:
> Reverse the list before the join and again after the join.  I know this
> sounds strange, but this way, there is never any worry about a race
> condition.  And there are no extra network calls.  To me, its an easy
> trade off to have c code that isn't fully optimized to save an
> extra network call to the server.  Especially if we are considerate to
> those who have dialup connections.

Skip this suggestion, it sucks.

Here's what I would like to see...

1.  Back out yesterday's chatsort-related changes in gaym/src

2.  Copy this bit of code to the 690 process in msgs.c from
    gaym_privacy_change() in conversation.c and use it instead of
    invoking gaym_privacy_change() (change the names and move
    gaim_conversation_get_ui_ops() as appropriate):

    gaim_conv_chat_set_users(chat,
                g_list_append(gaim_conv_chat_get_users(chat), cb));

    if (ops != NULL && ops->chat_add_user != NULL)
                ops->chat_add_user(conv, user, new_arrival);

3.  change g_list_append() above to g_list_prepend().

Done.  Simple and direct.  No race conditions or network calls.  And
more efficient, since we all know that g_list_append() is a pig.

The downside is we bypass the signals.  But I don't think we need them
anyway during the 690s.

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050722/426bbb68/attachment.pgp>

From deckrider at gmail.com  Fri Jul 22 17:21:09 2005
From: deckrider at gmail.com (David Everly)
Date: Fri, 22 Jul 2005 09:21:09 -0600
Subject: [Qrc-devel] Re: chatsort / 690 / thumbnail
In-Reply-To: <20050722133315.GB29614@elbert.is-a-geek.org>
References: <200507211758.j6LHw8jW012383@sheep.berlios.de> <20050721183545.GA29906@elbert.is-a-geek.org> <1121998744.16892.24.camel@localhost> <20050722041527.GA5928@elbert.is-a-geek.org> <20050722133315.GB29614@elbert.is-a-geek.org>
Message-ID: <20050722152109.GA11408@elbert.is-a-geek.org>

Since we now have a plugin to display thumbnails in the chatroom, I
would like to propose the attached patch be applied to HEAD (currently
revision 223).

This patch leaves thumbnails out of the mini profile (get info), since
they can be displayed in the chat room through the plugin and provides a
simpler, more failsafe (since there are no race conditions possible)
ordering process of the users in the chatroom.

Additionally, this weekend, I would like to commit a more complete
mini-profile approach, taking advantage of all that the mini-profile has
to offer.

By the way, to complete this set of work, we need one more component,
and that is the ability to display the additional text info when the
user's nick is highlighted in the chat room.  I think this can be done
by using what IRC normally uses for the Topic.

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
Index: gaym.h
===================================================================
--- gaym.h	(revision 223)
+++ gaym.h	(working copy)
@@ -77,7 +77,7 @@
     gboolean blist_updating;
     GHashTable *info_window_needed;
     GHashTable *im_thumbnail_needed;
-    GList *join_flags; //Temporary holding space for join flags. 
+
     GString *motd;
     GString *names;
     char *nameconv;
Index: msgs.c
===================================================================
--- msgs.c	(revision 223)
+++ msgs.c	(working copy)
@@ -199,21 +199,6 @@
 
     picpath = return_string_between(match, "\n", info_data);
     if (!picpath || strlen(picpath) == 0) {
-
-        if (d->thumbnail) {
-            hashurl =
-                g_hash_table_lookup(gaym->confighash,
-                                    "mini-profile-panel.thumbnail-prefix");
-            picurl = g_strdup_printf("%s%s", hashurl, d->thumbnail);
-            if (picurl) {
-                gaim_url_fetch(picurl, FALSE,
-                               "Mozilla/4.0 (compatible; MSIE 5.0)", FALSE,
-                               gaym_fetch_photo_cb, user_data);
-
-                return;
-            }
-
-        }
         gaim_notify_userinfo(d->gc, d->who,
                              t = g_strdup_printf("Gay.com - %s", d->who),
                              d->who, NULL, info, NULL, NULL);
@@ -222,7 +207,6 @@
     }
 
     picurl = g_strdup_printf("http://www.gay.com%s", picpath);
-
     if (picurl) {
         gaim_url_fetch(picurl, FALSE, "Mozilla/4.0 (compatible; MSIE 5.0)",
                        FALSE, gaym_fetch_photo_cb, user_data);
@@ -299,7 +283,6 @@
         data->who = g_strdup(args[1]);
         data->bio = gaym_bio_strdup(args[5]);
         data->stats = gaym_stats_strdup(args[5]);
-        data->thumbnail = gaym_thumbnail_strdup(args[5]);
 
         char *infourl = g_strdup_printf("%s?pw=%s&name=%s", hashurl,
                                         gaym->hash_pw, args[1]);
@@ -431,7 +414,7 @@
         if (!convo) {
             gaim_debug(GAIM_DEBUG_ERROR, "gaym",
                        "Got a NAMES list for %s, which doesn't exist\n",
-                       args[1]);
+                       args[2]);
             g_string_free(gaym->names, TRUE);
             gaym->names = NULL;
             g_free(gaym->nameconv);
@@ -459,52 +442,44 @@
             gaym->nameconv = NULL;
         } else {
             GList *users = NULL;
+            GList *flags = NULL;
 
-            gaim_debug_misc("gaym",
-                            "Using names for initial list population");
             while (*cur) {
+                GaimConvChatBuddyFlags f = GAIM_CBFLAGS_NONE;
                 end = strchr(cur, ' ');
-                /**
-                 * if (!end)
-                 * end = cur + strlen(cur);
-                 * if (*cur == '@') {
-                 * f = GAIM_CBFLAGS_OP;
-                 * cur++;
-                 * } else if (*cur == '%') {
-                 * f = GAIM_CBFLAGS_HALFOP;
-                 * cur++;
-                 * } else if (*cur == '+') {
-                 * f = GAIM_CBFLAGS_VOICE;
-                 * cur++;
-                 * }
-                 */
+                if (!end)
+                    end = cur + strlen(cur);
+                if (*cur == '@') {
+                    f = GAIM_CBFLAGS_OP;
+                    cur++;
+                } else if (*cur == '%') {
+                    f = GAIM_CBFLAGS_HALFOP;
+                    cur++;
+                } else if (*cur == '+') {
+                    f = GAIM_CBFLAGS_VOICE;
+                    cur++;
+                }
                 tmp = g_strndup(cur, end - cur);
-
-                gcom_nick_to_gaym(tmp);
                 users = g_list_prepend(users, tmp);
-                /* flags = g_list_prepend(flags, GINT_TO_POINTER(f)); */
+                flags = g_list_prepend(flags, GINT_TO_POINTER(f));
                 cur = end;
                 if (*cur)
                     cur++;
             }
-            /**
-             * users = g_list_reverse(users);
-             * flags = g_list_reverse(flags);
-             */
+            users = g_list_reverse(users);
+            flags = g_list_reverse(flags);
 
             if (users != NULL) {
                 GList *l;
 
                 gaim_conv_chat_add_users(GAIM_CONV_CHAT(convo), users,
-                                         gaym->join_flags);
+                                         flags);
 
-
                 for (l = users; l != NULL; l = l->next)
                     g_free(l->data);
 
                 g_list_free(users);
-                g_list_free(gaym->join_flags);
-                gaym->join_flags = NULL;
+                g_list_free(flags);
             }
         }
         g_free(names);
@@ -714,8 +689,6 @@
         }
 
         serv_got_joined_chat(gc, id++, args[0]);
-
-        gaym_cmd_names(gaym, "names", NULL, (const char **)args);
         g_free(nick);
         return;
     }
@@ -1263,7 +1236,7 @@
 {
     GaimConnection *gc = gaim_account_get_connection(gaym->account);
     GaimConversation *convo;
-    GaimConvChatBuddyFlags flags;
+    GaimConvChatBuddyFlags flags = GAIM_CBFLAGS_NONE;
     char *channel = args[1];
     char *nick = args[2];
     char *extra = args[4];
@@ -1294,20 +1267,21 @@
 
     flags = chat_pecking_order(extra);
 
-    /**
-     * g_hash_table_insert(gaym->join_flags, g_strdup(nick), flags);
-     */
-    gaym->join_flags =
-        g_list_prepend(gaym->join_flags, GINT_TO_POINTER(flags));
-    /**
-     * gaim_conv_chat_add_user(GAIM_CONV_CHAT(convo), nick, NULL, flags,
-     * FALSE);
-     */
+    GaimConversationUiOps *ops = gaim_conversation_get_ui_ops(convo);
 
+    GaimConvChatBuddy *cb = gaim_conv_chat_cb_new(nick, flags);
+
+    gaim_conv_chat_set_users(GAIM_CONV_CHAT(convo),
+                             g_list_prepend(gaim_conv_chat_get_users
+                                           (GAIM_CONV_CHAT(convo)), cb));
+
+    if (ops != NULL && ops->chat_add_user != NULL) {
+        ops->chat_add_user(convo, nick, FALSE);
+    }
+
     /**
      * Make the ignore.png icon appear next to the nick.
      */
-    GaimConversationUiOps *ops = gaim_conversation_get_ui_ops(convo);
     if (gaym_privacy_check(gc, nick) && gaym_botfilter_permit) {
         gaim_conv_chat_unignore(GAIM_CONV_CHAT(convo), nick);
     } else {
Index: gayminfo.h
===================================================================
--- gayminfo.h	(revision 223)
+++ gayminfo.h	(working copy)
@@ -37,7 +37,6 @@
     char *who;
     char *bio;
     char *stats;
-    char *thumbnail;
 };
 void gaym_fetch_thumbnail_cb(void *user_data, const char *pic_data,
                              size_t len);

From gaym at jasonlebrun.info  Sat Jul 23 02:55:15 2005
From: gaym at jasonlebrun.info (Jason LeBrun)
Date: Fri, 22 Jul 2005 19:55:15 -0500
Subject: [Qrc-devel] chatsort / 690
In-Reply-To: <20050722133315.GB29614@elbert.is-a-geek.org>
References: <200507211758.j6LHw8jW012383@sheep.berlios.de>
	 <20050721183545.GA29906@elbert.is-a-geek.org>
	 <1121998744.16892.24.camel@localhost>
	 <20050722041527.GA5928@elbert.is-a-geek.org>
	 <20050722133315.GB29614@elbert.is-a-geek.org>
Message-ID: <1122080115.16892.71.camel@localhost>

This proposal still won't work. The problem is that it will still be
calling ops->chat_add_user in the same order that it does anyway. The
gui list structure is what is causing the problem, not the GList that
the non-gui portion maintains. There is an op->chat_add_users function,
but no op->chat_set_users. The only way to effect your idea is every
time someone joins, call

op->chat_remove_users on the old list
op->chat_add_users on the new list. 

I tried it, and it was *horribly* inefficient. Every time someone
joined, there was massive blinking in the names list. :(

Your idea was not in vain though, it's got me thinking in some different
directions. Good suggestion!

By the way, we wouldn't have to bypass the signals, we could just emit
them ourselves, right?


Jason

> Here's what I would like to see...
> 
> 1.  Back out yesterday's chatsort-related changes in gaym/src
> 
> 2.  Copy this bit of code to the 690 process in msgs.c from
>     gaym_privacy_change() in conversation.c and use it instead of
>     invoking gaym_privacy_change() (change the names and move
>     gaim_conversation_get_ui_ops() as appropriate):
> 
>     gaim_conv_chat_set_users(chat,
>                 g_list_append(gaim_conv_chat_get_users(chat), cb));
> 
>     if (ops != NULL && ops->chat_add_user != NULL)
>                 ops->chat_add_user(conv, user, new_arrival);
> 
> 3.  change g_list_append() above to g_list_prepend().
> 
> Done.  Simple and direct.  No race conditions or network calls.  And
> more efficient, since we all know that g_list_append() is a pig.
> 
> The downside is we bypass the signals.  But I don't think we need them
> anyway during the 690s.
> 



From gaym at jasonlebrun.info  Sat Jul 23 09:02:49 2005
From: gaym at jasonlebrun.info (Jason LeBrun)
Date: Sat, 23 Jul 2005 02:02:49 -0500
Subject: [Qrc-devel] WHOIS codes
Message-ID: <1122102170.16892.80.camel@localhost>

I found someone with 1e as their code. I had a short chat with them, and
they use the gay.com chat client. He said that he was camming, so
perhaps it has something to do with the video features.

Jason



From jason at jasonlebrun.info  Sat Jul 23 18:06:31 2005
From: jason at jasonlebrun.info (Jason LeBrun)
Date: Sat, 23 Jul 2005 11:06:31 -0500
Subject: [Qrc-devel] Why remove chaticon?
Message-ID: <1122134791.16892.85.camel@localhost>

What's the reason for moving the chaticon plugin? It provides the basis
for viewing thumbnails, as well as for viewing someone's bio information
in the "topic" area.

Jason



From deckrider at gmail.com  Sat Jul 23 18:35:42 2005
From: deckrider at gmail.com (David Everly)
Date: Sat, 23 Jul 2005 10:35:42 -0600
Subject: [Qrc-devel] Why remove chaticon?
In-Reply-To: <1122134791.16892.85.camel@localhost>
References: <1122134791.16892.85.camel@localhost>
Message-ID: <20050723163542.GA18998@elbert.is-a-geek.org>

I think I removed only the chatsort plugin.  We need to keep the
chaticon plugin.

On Sat, Jul 23, 2005 at 11:06:31AM -0500, Jason LeBrun wrote:
> What's the reason for moving the chaticon plugin? It provides the basis
> for viewing thumbnails, as well as for viewing someone's bio information
> in the "topic" area.
> 
> Jason
> 
> _______________________________________________
> Qrc-devel mailing list
> Qrc-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/qrc-devel
> 

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050723/a332be3f/attachment.pgp>

From deckrider at gmail.com  Sat Jul 23 18:39:43 2005
From: deckrider at gmail.com (David Everly)
Date: Sat, 23 Jul 2005 10:39:43 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r224 - qrc/trunk/gaym/src
In-Reply-To: <200507230307.j6N375xf008046@sheep.berlios.de>
References: <200507230307.j6N375xf008046@sheep.berlios.de>
Message-ID: <20050723163943.GB18998@elbert.is-a-geek.org>

On Sat, Jul 23, 2005 at 05:07:05AM +0200, Jason LeBrun at BerliOS wrote:
> Author: jblebrun
> Date: 2005-07-23 05:06:59 +0200 (Sat, 23 Jul 2005)
> New Revision: 224
> 
> Modified:
>    qrc/trunk/gaym/src/gaym.c
>    qrc/trunk/gaym/src/gaym.h
>    qrc/trunk/gaym/src/helpers.c
>    qrc/trunk/gaym/src/helpers.h
>    qrc/trunk/gaym/src/msgs.c
> Log:
> Woohoo! Sort by entry without any pesky plugins, by hijacking the
> buddy flags!  There may be one follow-up revision to check for memory
> leaks.

Congratulations on this commit!  Lots of people want this feature.  We
should probably try to have a release in a couple weeks if possible.

I've reverted some of the earlier changes previous to your commit (which
I think are superseded by this commit and by the chaticon plugin) and
added an option to sort by your new method (default) or the old method.

Please check that I haven't damaged something we should keep.

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050723/d0d3aea6/attachment.pgp>

From gaym at jasonlebrun.info  Sun Jul 24 00:30:35 2005
From: gaym at jasonlebrun.info (Jason LeBrun)
Date: Sat, 23 Jul 2005 17:30:35 -0500
Subject: [Qrc-devel] Configure scripts
Message-ID: <1122157835.16892.90.camel@localhost>

When I type "./configure --prefix=/usr/local" it still installs
in /usr/lib/gaim, when I do make install.

Did I miss an email about the correct way to adjust installation
prefixes?

Jason




From deckrider at gmail.com  Sun Jul 24 01:30:08 2005
From: deckrider at gmail.com (David Everly)
Date: Sat, 23 Jul 2005 17:30:08 -0600
Subject: [Qrc-devel] Configure scripts
In-Reply-To: <1122157835.16892.90.camel@localhost>
References: <1122157835.16892.90.camel@localhost>
Message-ID: <20050723233008.GF18998@elbert.is-a-geek.org>

On Sat, Jul 23, 2005 at 05:30:35PM -0500, Jason LeBrun wrote:
> When I type "./configure --prefix=/usr/local" it still installs
> in /usr/lib/gaim, when I do make install.
> 
> Did I miss an email about the correct way to adjust installation
> prefixes?

Since plugins have to be installed exactly where a certain gaim
installation needs them to be installed, --prefix is useless.

Gaim provides a pkg-config file that indicates where it is expecting to
see its plugins and icons.  This is what we use.

To see how to override the various gaim pkg-config values, run:

   ./configure --help | grep -- pkg-config

If you have more than one gaim installation that has provided pkg-config
files in different places, check the pkg-config documentation, but I
think you can set PKG_CONFIG_PATH to point to the oddly-located gaim
pkg-config file that contains your settings.

If you are creating a package and need a temporary location to install
to after building the libraries, do something like:

   ./configure
   make
   make install DESTDIR=/path/to/temporary/install/location

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050723/23f2e9b0/attachment.pgp>

From deckrider at gmail.com  Sun Jul 24 04:04:21 2005
From: deckrider at gmail.com (David Everly)
Date: Sat, 23 Jul 2005 20:04:21 -0600
Subject: [Qrc-devel] Anonymous SVN Server Problem
Message-ID: <20050724020420.GG18998@elbert.is-a-geek.org>

FYI, there has a problem with the anonymous SVN server on berlios for
the last few days, and there are several bug reports open about it:

https://developer.berlios.de/bugs/?func=detailbug&bug_id=4638&group_id=1
https://developer.berlios.de/bugs/?func=detailbug&bug_id=4640&group_id=1
https://developer.berlios.de/bugs/?func=detailbug&bug_id=4642&group_id=1

Hopefully they will have it fixed soon...

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050723/56255de6/attachment.pgp>

From evan at coolrunningconcepts.com  Sun Jul 24 05:34:03 2005
From: evan at coolrunningconcepts.com (evan at coolrunningconcepts.com)
Date: Sat, 23 Jul 2005 21:34:03 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r236 - in qrc/trunk: gaym/src gaym-extras
Message-ID: <20050723213403.duplq88rltj44g8k@coolrunningconcepts.com>

Quoting Jason LeBrun at BerliOS <jblebrun at berlios.de>:

> *A first attempt at chat icons in the room, using the buddy system. 
> For various reason, this method blows, so it's going to be completely 
> re-hauled to use imgstore. But just in caes, the work is being 
> committed.

chat icons in the room?  Do you mean with the thumbnail next to the person's
name?   Hmm .. I'd like to see this.

How can one check out SVN since its down?  Evidently you guys are still 
able to
access it.   Is it only the public one that's down?





From deckrider at gmail.com  Sun Jul 24 05:41:58 2005
From: deckrider at gmail.com (David Everly)
Date: Sat, 23 Jul 2005 21:41:58 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r236 - in qrc/trunk: gaym/src gaym-extras
In-Reply-To: <20050723213403.duplq88rltj44g8k@coolrunningconcepts.com>
References: <20050723213403.duplq88rltj44g8k@coolrunningconcepts.com>
Message-ID: <20050724034158.GH18998@elbert.is-a-geek.org>

On Sat, Jul 23, 2005 at 09:34:03PM -0600, evan at coolrunningconcepts.com wrote:
> How can one check out SVN since its down?  Evidently you guys are still 
> able to
> access it.   Is it only the public one that's down?

Correct, the anonymous svn server is the problem.

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html


From evan at coolrunningconcepts.com  Sun Jul 24 05:47:44 2005
From: evan at coolrunningconcepts.com (evan at coolrunningconcepts.com)
Date: Sat, 23 Jul 2005 21:47:44 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r236 - in qrc/trunk: gaym/src
	gaym-extras
In-Reply-To: <20050724034158.GH18998@elbert.is-a-geek.org>
References: <20050723213403.duplq88rltj44g8k@coolrunningconcepts.com>
	<20050724034158.GH18998@elbert.is-a-geek.org>
Message-ID: <20050723214744.a1hpmrmisuo88ss8@coolrunningconcepts.com>

Quoting David Everly <deckrider at gmail.com>:

> Correct, the anonymous svn server is the problem.

Is there then no way for us low-lifes to get at the code then?   Is 
there an ETA
on when it will be fixed?

I'm doing a -e world right now (only about 300 more packages to go!) 
but I know
its already completed gaim, so it should be safe to compile up a gaim 
module :)




From deckrider at gmail.com  Sun Jul 24 06:16:32 2005
From: deckrider at gmail.com (David Everly)
Date: Sat, 23 Jul 2005 22:16:32 -0600
Subject: [Qrc-devel] Gaim Versions
Message-ID: <20050724041632.GI18998@elbert.is-a-geek.org>

Hi,

I would like to recommend that when we develop for QRC, we use an
earlier version of Gaim to ensure that what we do works for most
everyone.

Perhaps Gaim 1.2.1 would be OK?  Or are there distros out there with
earlier versions?

Thanks,
Dave.

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html


From deckrider at gmail.com  Sun Jul 24 06:23:30 2005
From: deckrider at gmail.com (David Everly)
Date: Sat, 23 Jul 2005 22:23:30 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r236 - in qrc/trunk: gaym/src gaym-extras
In-Reply-To: <20050723214744.a1hpmrmisuo88ss8@coolrunningconcepts.com>
References: <20050723213403.duplq88rltj44g8k@coolrunningconcepts.com> <20050724034158.GH18998@elbert.is-a-geek.org> <20050723214744.a1hpmrmisuo88ss8@coolrunningconcepts.com>
Message-ID: <20050724042329.GJ18998@elbert.is-a-geek.org>

On Sat, Jul 23, 2005 at 09:47:44PM -0600, evan at coolrunningconcepts.com wrote:
> Quoting David Everly <deckrider at gmail.com>:
> 
> >Correct, the anonymous svn server is the problem.
> 
> Is there then no way for us low-lifes to get at the code then?   Is 
> there an ETA
> on when it will be fixed?
> 
> I'm doing a -e world right now (only about 300 more packages to go!) 
> but I know
> its already completed gaim, so it should be safe to compile up a gaim 
> module :)

I know Jason has been doing a lot of work and I've been committing a lot
also today.  And there is more of the same tomorrow.  So you may not
want the lastest right now anyway...perhaps after it settles tomorrow
night.

I'm guessing "-e world" means upgrading everything to the latest
version?  You may want to consider developing QRC on an ancient version
of gaim, like 1.2.1 so as to make sure we work with most everyone out
there.

Gaim Meanwhile seems to allow as early as 1.2.0 (and usually
incrementing the last number indicates a bug fix, not an API change).

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html


From evan at coolrunningconcepts.com  Sun Jul 24 06:53:21 2005
From: evan at coolrunningconcepts.com (evan at coolrunningconcepts.com)
Date: Sat, 23 Jul 2005 22:53:21 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r236 - in qrc/trunk: gaym/src
	gaym-extras
In-Reply-To: <20050724042329.GJ18998@elbert.is-a-geek.org>
References: <20050723213403.duplq88rltj44g8k@coolrunningconcepts.com>
	<20050724034158.GH18998@elbert.is-a-geek.org>
	<20050723214744.a1hpmrmisuo88ss8@coolrunningconcepts.com>
	<20050724042329.GJ18998@elbert.is-a-geek.org>
Message-ID: <20050723225321.vv40iczwkwg8ccos@coolrunningconcepts.com>

Quoting David Everly <deckrider at gmail.com>:
> I'm guessing "-e world" means upgrading everything to the latest
> version?  You may want to consider developing QRC on an ancient version

No thats without -e, -e means to pretend nothing installed.  I changed CPUs so
I'm recompiling everything to change optimization settings.  It also keeps the
toolchain completely accurate.

As for waiting - I'm not patient, but I suppose I don't have a choice.

> of gaim, like 1.2.1 so as to make sure we work with most everyone out
> there.

I'm at 1.4.0 or 1.4.1 or something.  I don't think anything I do will break
under old ones since the documentation is so far outdated anyway.  I mean ..
its not like there are some 1.4 only features I'll be using.   Besides, 
the way
most Linux users upgrade .. is there someone who can't grab the latest 
with yum,
apt-get, or emerge?




From evan at coolrunningconcepts.com  Sun Jul 24 11:59:34 2005
From: evan at coolrunningconcepts.com (evan at coolrunningconcepts.com)
Date: Sun, 24 Jul 2005 03:59:34 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r237 - in qrc/trunk: gaym/src gaym-extras
In-Reply-To: <200507240818.j6O8I8d8014691@sheep.berlios.de>
References: <200507240818.j6O8I8d8014691@sheep.berlios.de>
Message-ID: <20050724035934.0e6oem844im8wc0k@coolrunningconcepts.com>

Quoting Jason LeBrun at BerliOS <jblebrun at berlios.de>:

> Log:
> AWESOME CHATROOM ICON SUPPORT NOW!

Screenshots?




From deckrider at gmail.com  Sun Jul 24 14:11:39 2005
From: deckrider at gmail.com (David Everly)
Date: Sun, 24 Jul 2005 06:11:39 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r238 - qrc/trunk/gaym-extras
In-Reply-To: <200507240853.j6O8rBf3016851@sheep.berlios.de>
References: <200507240853.j6O8rBf3016851@sheep.berlios.de>
Message-ID: <20050724121139.GK18998@elbert.is-a-geek.org>

Sweet!

Is it possible to show a tooltip with all the information like is on the
buddy list?

On Sun, Jul 24, 2005 at 10:53:11AM +0200, Jason LeBrun at BerliOS wrote:
> Author: jblebrun
> Date: 2005-07-24 10:53:02 +0200 (Sun, 24 Jul 2005)
> New Revision: 238
> 
> Modified:
>    qrc/trunk/gaym-extras/gaym-extras.c
> Log:
> Hey, why not show the bio, too. 
> 
> OK, it's not in a beautiful place... but I can't figure out how to get it somewhere better.
> 
> 
> 
> Modified: qrc/trunk/gaym-extras/gaym-extras.c
> ===================================================================
> --- qrc/trunk/gaym-extras/gaym-extras.c	2005-07-24 08:18:06 UTC (rev 237)
> +++ qrc/trunk/gaym-extras/gaym-extras.c	2005-07-24 08:53:02 UTC (rev 238)
> @@ -22,9 +22,7 @@
>  #define CHATSORT_PLUGIN_ID "gtk-chaticon"
>  
>  GHashTable *icons;
> -GHashTable *icon_spots;
>  GHashTable *pending_updates;
> -GaimConvWindow *hider_window;
>  
>  typedef struct _GaymChatIcon {
>  
> @@ -39,15 +37,14 @@
>      GdkPixbufAnimationIter *iter;
>      gboolean animate;
>      guint32 icon_timer;
> +    GtkWidget *bio_area;
>  
>  } GaymChatIcon;
>  
>  
>  
> -void
> -gaym_gtkconv_update_thumbnail(GaimConversation * conv,
> -                              struct gaym_fetch_thumbnail_data
> -                              *thumbnail_data)
> +void gaym_gtkconv_update_thumbnail(GaimConversation * conv, struct gaym_fetch_thumbnail_data
> +                                   *thumbnail_data)
>  {
>      GaimGtkConversation *gtkconv;
>  
> @@ -234,10 +231,6 @@
>      gtk_tree_selection_get_selected(selection, &model, &iter);
>      gtk_tree_model_get(model, &iter, CHAT_USERS_NAME_COLUMN, &name, -1);
>  
> -    gaim_debug_misc("chatsort", "Click: %s\n", name);
> -    gtk_button_set_label(g_hash_table_lookup(icon_spots, c), name);
> -
> -
>      /* Remove the current icon stuff */
>      GaymChatIcon *icon_data = g_hash_table_lookup(icons, c);
>      if (icon_data->event != NULL)
> @@ -249,6 +242,7 @@
>      gaim_debug_misc("chaticon", "got thumbnail url %s for %s\n",
>                      cm->thumbnail, name);
>  
> +    gtk_label_set_text(GTK_LABEL(icon_data->bio_area), cm->bio);
>      // Fetch thumbnail.
>  
>      struct gaym_fetch_thumbnail_data *data;
> @@ -283,15 +277,10 @@
>      gtk_tree_selection_set_mode(select, GTK_SELECTION_SINGLE);
>  
>      oldls = gtk_tree_view_get_model(GTK_TREE_VIEW(gtkchat->list));
> -    GtkBox *vbox = GTK_BOX(gtkchat->list->parent->parent);
>  
>      GtkBox *hbox = GTK_BOX(gtkconv->lower_hbox);
> +    GtkBox *vbox_big = GTK_BOX(gtkconv->lower_hbox->parent);
>  
> -    GtkWidget *button = gtk_button_new_with_label("A Button");
> -    gtk_box_pack_end(vbox, GTK_WIDGET(button), FALSE, FALSE, 0);
> -    gtk_widget_show(button);
> -
> -
>      g_signal_connect(G_OBJECT(select), "changed", G_CALLBACK(changed_cb),
>                       c);
>  
> @@ -329,7 +318,11 @@
>      // g_signal_connect(G_OBJECT(icon_data->event), "button-press-event",
>      // G_CALLBACK(icon_menu), conv);
>      gtk_widget_show(icon_data->event);
> -    g_hash_table_insert(icon_spots, c, button);
> +
> +    icon_data->bio_area = gtk_label_new(_(""));
> +    gtk_box_pack_start(vbox_big, icon_data->bio_area, FALSE, FALSE, 0);
> +    gtk_widget_show(icon_data->bio_area);
> +
>      g_hash_table_insert(icons, c, icon_data);
>  
>  }
> @@ -337,7 +330,6 @@
>  static gboolean plugin_load(GaimPlugin * plugin)
>  {
>      icons = g_hash_table_new(g_direct_hash, g_direct_equal);
> -    icon_spots = g_hash_table_new(g_direct_hash, g_direct_equal);
>      pending_updates = g_hash_table_new(g_direct_hash, g_direct_equal);
>  
>      gaim_signal_connect(gaim_conversations_get_handle(), "chat-joined",
> 
> _______________________________________________
> Qrc-svn mailing list
> Qrc-svn at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/qrc-svn
> 

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050724/4824e41a/attachment.pgp>

From deckrider at gmail.com  Sun Jul 24 14:24:16 2005
From: deckrider at gmail.com (David Everly)
Date: Sun, 24 Jul 2005 06:24:16 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r237 - in qrc/trunk: gaym/src gaym-extras
In-Reply-To: <200507240818.j6O8I8d8014691@sheep.berlios.de>
References: <200507240818.j6O8I8d8014691@sheep.berlios.de>
Message-ID: <20050724122415.GL18998@elbert.is-a-geek.org>

On Sun, Jul 24, 2005 at 10:18:08AM +0200, Jason LeBrun at BerliOS wrote:
> Author: jblebrun
> Date: 2005-07-24 10:18:06 +0200 (Sun, 24 Jul 2005)
> New Revision: 237
> 
> Modified:
>    qrc/trunk/gaym-extras/gaym-extras.c
>    qrc/trunk/gaym/src/gaym.c
>    qrc/trunk/gaym/src/gaym.h
>    qrc/trunk/gaym/src/gayminfo.c
>    qrc/trunk/gaym/src/gayminfo.h
>    qrc/trunk/gaym/src/msgs.c
>    qrc/trunk/gaym/src/weblogin.c
> Log:
> AWESOME CHATROOM ICON SUPPORT NOW!
> 
> *Complete redone chat-icon system, does not use buddy icons or imgstores.
> 
> *gaym now maintains information about people in a hash table as they join the channel. The hash table is cleaned up as they leave, or if you part from the channel. The same people in different rooms are handled using reference counting.
> 
> *Added a gaym API call to allow querying of the channel member info

This is compiling for linux, but not for windows:

Creating library file: .libs/libgaym-extras.dll.a
.libs/gaym-extras.o: In function `changed_cb':
/home/deverly/qrc-svn/gaym-extras/gaym-extras.c:241: undefined reference to `_gaym_get_channel_member_info'
collect2: ld returned 1 exit status
make[2]: *** [libgaym-extras.la] Error 1
make[2]: Leaving directory `/home/deverly/qrc-svn/gaym-extras'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/home/deverly/qrc-svn'
make: *** [all] Error 2

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050724/f1e4a772/attachment.pgp>

From deckrider at gmail.com  Sun Jul 24 14:33:40 2005
From: deckrider at gmail.com (David Everly)
Date: Sun, 24 Jul 2005 06:33:40 -0600
Subject: [Qrc-devel] Re: Anonymous SVN Server Problem
In-Reply-To: <20050724020420.GG18998@elbert.is-a-geek.org>
References: <20050724020420.GG18998@elbert.is-a-geek.org>
Message-ID: <20050724123340.GM18998@elbert.is-a-geek.org>

On Sat, Jul 23, 2005 at 08:04:21PM -0600,  wrote:
> FYI, there has a problem with the anonymous SVN server on berlios for
> the last few days, and there are several bug reports open about it:
> 
> https://developer.berlios.de/bugs/?func=detailbug&bug_id=4638&group_id=1
> https://developer.berlios.de/bugs/?func=detailbug&bug_id=4640&group_id=1
> https://developer.berlios.de/bugs/?func=detailbug&bug_id=4642&group_id=1
> 
> Hopefully they will have it fixed soon...

Its working now.  I'm running the nightly build now (since it wasn't yet
working yet when the build ran last night).

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050724/79209ce2/attachment.pgp>

From deckrider at gmail.com  Sun Jul 24 15:08:20 2005
From: deckrider at gmail.com (David Everly)
Date: Sun, 24 Jul 2005 07:08:20 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r236 - in qrc/trunk: gaym/src gaym-extras
In-Reply-To: <20050723225321.vv40iczwkwg8ccos@coolrunningconcepts.com>
References: <20050723213403.duplq88rltj44g8k@coolrunningconcepts.com> <20050724034158.GH18998@elbert.is-a-geek.org> <20050723214744.a1hpmrmisuo88ss8@coolrunningconcepts.com> <20050724042329.GJ18998@elbert.is-a-geek.org> <20050723225321.vv40iczwkwg8ccos@coolrunningconcepts.com>
Message-ID: <20050724130820.GN18998@elbert.is-a-geek.org>

On Sat, Jul 23, 2005 at 10:53:21PM -0600, evan at coolrunningconcepts.com wrote:
> Quoting David Everly <deckrider at gmail.com>:
> >I'm guessing "-e world" means upgrading everything to the latest
> >version?  You may want to consider developing QRC on an ancient
> >version
> 
> No thats without -e, -e means to pretend nothing installed.  I changed
> CPUs so I'm recompiling everything to change optimization settings.
> It also keeps the toolchain completely accurate.
> 
> As for waiting - I'm not patient, but I suppose I don't have a choice.

Its fixed now.

> >of gaim, like 1.2.1 so as to make sure we work with most everyone out
> >there.
> 
> I'm at 1.4.0 or 1.4.1 or something.  I don't think anything I do will
> break under old ones since the documentation is so far outdated
> anyway.  I mean ..  its not like there are some 1.4 only features I'll
> be using.

We've already seen issues where things are in the header file in 1.4
which aren't in 1.2 or 1.3, so if we use those, then they it won't build
for the earlier versions.

Personally, I think its easier to work with the earliest version we
should be compatible with than work with the latest version and then
later find out I have to do a bunch of rework to make my code compatible
with the earlier versions.  I get into enough trouble without having
decoys in the header files out there I might happen to see and start
using!

> Besides, the way most Linux users upgrade .. is there someone who
> can't grab the latest with yum, apt-get, or emerge?

I'm _not_ arguing that people can't or don't upgrade.

I _am_ arguing that we should be as broadly compatible as possible (I
mean, why wouldn't we aim for this?  I'd like more people to use our
system, not less!).  If there is a specific feature that we need to use
from a more recent version of Gaim, we should discuss it and hopefully:

  - find a way to do it in all versions, or at least ...
  - insert compiler directives so the feature is utilized if used with
    the more recent version and benignly omitted if used with an earlier
    version (i.e., still builds, doesn't crash, etc.).

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050724/24b36659/attachment.pgp>

From deckrider at gmail.com  Sun Jul 24 15:24:42 2005
From: deckrider at gmail.com (David Everly)
Date: Sun, 24 Jul 2005 07:24:42 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r237 - in qrc/trunk: gaym/src gaym-extras
In-Reply-To: <20050724122415.GL18998@elbert.is-a-geek.org>
References: <200507240818.j6O8I8d8014691@sheep.berlios.de> <20050724122415.GL18998@elbert.is-a-geek.org>
Message-ID: <20050724132442.GO18998@elbert.is-a-geek.org>

On Sun, Jul 24, 2005 at 06:24:15AM -0600,  wrote:
> On Sun, Jul 24, 2005 at 10:18:08AM +0200, Jason LeBrun at BerliOS wrote:
> > Author: jblebrun
> > Date: 2005-07-24 10:18:06 +0200 (Sun, 24 Jul 2005)
> > New Revision: 237
> > 
> > Modified:
> >    qrc/trunk/gaym-extras/gaym-extras.c
> >    qrc/trunk/gaym/src/gaym.c
> >    qrc/trunk/gaym/src/gaym.h
> >    qrc/trunk/gaym/src/gayminfo.c
> >    qrc/trunk/gaym/src/gayminfo.h
> >    qrc/trunk/gaym/src/msgs.c
> >    qrc/trunk/gaym/src/weblogin.c
> > Log:
> > AWESOME CHATROOM ICON SUPPORT NOW!
> > 
> > *Complete redone chat-icon system, does not use buddy icons or imgstores.
> > 
> > *gaym now maintains information about people in a hash table as they join the channel. The hash table is cleaned up as they leave, or if you part from the channel. The same people in different rooms are handled using reference counting.
> > 
> > *Added a gaym API call to allow querying of the channel member info
> 
> This is compiling for linux, but not for windows:
> 
> Creating library file: .libs/libgaym-extras.dll.a
> .libs/gaym-extras.o: In function `changed_cb':
> /home/deverly/qrc-svn/gaym-extras/gaym-extras.c:241: undefined reference to `_gaym_get_channel_member_info'
> collect2: ld returned 1 exit status
> make[2]: *** [libgaym-extras.la] Error 1
> make[2]: Leaving directory `/home/deverly/qrc-svn/gaym-extras'
> make[1]: *** [all-recursive] Error 1
> make[1]: Leaving directory `/home/deverly/qrc-svn'
> make: *** [all] Error 2

I think I see whats going on here:

#include "../gaym/src/gaym.h"
#include "../gaym/src/gayminfo.h"

We should come up with a mechanism that the plugins can use to call each
other's functions and a way to share common code or headers among the
gaym-only plugins.

I was originally thinking of the mechanism used by gaim itself where
there is a struct of pointers to functions that is used.  Kind of like
GaimPluginProtocolInfo, only one we define between the related plugins.

Then to invoke the shared function, something like this:

    int i = 0;
    GaimConnection *gc = NULL;
    GaimPluginProtocolInfo *prpl_info = NULL;

    gc = gaim_account_get_connection(account);

    if (gc != NULL && gc->prpl != NULL) {
        prpl_info = GAIM_PLUGIN_PROTOCOL_INFO(gc->prpl);
    }

    if (prpl_info && prpl_info->send_im) {
        i = prpl_info->send_im(gc, recipient, message,
                               GAIM_CONV_IM_AUTO_RESP);
    }

Of course, this is all gaim-specific and we would need something
related to our own needs.

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050724/3a6b0896/attachment.pgp>

From gaym at jasonlebrun.info  Sun Jul 24 18:15:49 2005
From: gaym at jasonlebrun.info (Jason LeBrun)
Date: Sun, 24 Jul 2005 11:15:49 -0500
Subject: [Qrc-devel] Re: [Qrc-svn] r237 - in qrc/trunk: gaym/src
	gaym-extras
In-Reply-To: <20050724122415.GL18998@elbert.is-a-geek.org>
References: <200507240818.j6O8I8d8014691@sheep.berlios.de>
	 <20050724122415.GL18998@elbert.is-a-geek.org>
Message-ID: <1122221750.16892.93.camel@localhost>

Just needs to link to libgaym.dll

Jason

On Sun, 2005-07-24 at 06:24 -0600, David Everly wrote:
> On Sun, Jul 24, 2005 at 10:18:08AM +0200, Jason LeBrun at BerliOS wrote:
> > Author: jblebrun
> > Date: 2005-07-24 10:18:06 +0200 (Sun, 24 Jul 2005)
> > New Revision: 237
> > 
> > Modified:
> >    qrc/trunk/gaym-extras/gaym-extras.c
> >    qrc/trunk/gaym/src/gaym.c
> >    qrc/trunk/gaym/src/gaym.h
> >    qrc/trunk/gaym/src/gayminfo.c
> >    qrc/trunk/gaym/src/gayminfo.h
> >    qrc/trunk/gaym/src/msgs.c
> >    qrc/trunk/gaym/src/weblogin.c
> > Log:
> > AWESOME CHATROOM ICON SUPPORT NOW!
> > 
> > *Complete redone chat-icon system, does not use buddy icons or imgstores.
> > 
> > *gaym now maintains information about people in a hash table as they join the channel. The hash table is cleaned up as they leave, or if you part from the channel. The same people in different rooms are handled using reference counting.
> > 
> > *Added a gaym API call to allow querying of the channel member info
> 
> This is compiling for linux, but not for windows:
> 
> Creating library file: .libs/libgaym-extras.dll.a
> .libs/gaym-extras.o: In function `changed_cb':
> /home/deverly/qrc-svn/gaym-extras/gaym-extras.c:241: undefined reference to `_gaym_get_channel_member_info'
> collect2: ld returned 1 exit status
> make[2]: *** [libgaym-extras.la] Error 1
> make[2]: Leaving directory `/home/deverly/qrc-svn/gaym-extras'
> make[1]: *** [all-recursive] Error 1
> make[1]: Leaving directory `/home/deverly/qrc-svn'
> make: *** [all] Error 2
> 



From evan at coolrunningconcepts.com  Sun Jul 24 23:27:16 2005
From: evan at coolrunningconcepts.com (evan at coolrunningconcepts.com)
Date: Sun, 24 Jul 2005 15:27:16 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r239 - in qrc/trunk: gaym/src gaym-extras
In-Reply-To: <200507241936.j6OJa8dC013004@sheep.berlios.de>
References: <200507241936.j6OJa8dC013004@sheep.berlios.de>
Message-ID: <20050724152716.r8vd2tfrtypwgo8c@coolrunningconcepts.com>

Okay - just checked out latest SVN

Quoting Jason LeBrun at BerliOS <jblebrun at berlios.de>:

> PLEASE BEAT THE HELL OUT OF THIS!

Can't .... turn ... off ... chat ... sort ...

AHHHH!!!   The plugin isn't turned on, but the thing sorts by join 
order all the
time and I can't go back to alphabetical.    I kinda likes alphabetical!

I noticed the little icons that show if they have a picture or not have 
changed.
  Guess I can figure them out.   But .. what is half star vs blank vs orange
thingy?   I got a blank (no icon) with a picture and bio - shouldn't 
that be an
orange thingy?

The thumbnails in chat rooms aren't displayed the same as the 
thumbnails in IMs.
    Not all thumbs fit in the chat room "box" - not sure if thats fixable.

The bio at the bottom of the channel and the age and location and all that is
kinda duplicating whats in the "Get Info" and take up quite a bit of space.
Can it be put in a smaller font for the channel and IM windows?

No one has put in the "profile headline" feature into the Get Info window  (or
in the chat window).  See
http://coolrunningconcepts.com/gaym/Screenshot-getinfo.png

Not the greatest example since the profile headline duplicates much of the BIO
but you get the idea - you get the information from the mini-profile.  
Check it
out.   Good stuff!

I also miss my small joins with blue bios .. but I'll make a plugin to get it
back one of these days :/





From Evan at CoolRunningConcepts.com  Mon Jul 25 01:35:08 2005
From: Evan at CoolRunningConcepts.com (Evan Langlois)
Date: Sun, 24 Jul 2005 18:35:08 -0500
Subject: [Qrc-devel] Re: [Qrc-svn] r239 - in qrc/trunk: gaym/src
	gaym-extras
In-Reply-To: <20050724152716.r8vd2tfrtypwgo8c@coolrunningconcepts.com>
References: <200507241936.j6OJa8dC013004@sheep.berlios.de>
	 <20050724152716.r8vd2tfrtypwgo8c@coolrunningconcepts.com>
Message-ID: <1122248108.19747.0.camel@taro.coolrunningconcepts.com>

On Sun, 2005-07-24 at 15:27 -0600, evan at coolrunningconcepts.com wrote:
> Okay - just checked out latest SVN
> 
> Quoting Jason LeBrun at BerliOS <jblebrun at berlios.de>:
> 
> > PLEASE BEAT THE HELL OUT OF THIS!

Sometimes the BIO text at the bottom of the window is cut in half.




From deckrider at gmail.com  Mon Jul 25 02:41:28 2005
From: deckrider at gmail.com (David Everly)
Date: Sun, 24 Jul 2005 18:41:28 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r239 - in qrc/trunk: gaym/src gaym-extras
In-Reply-To: <20050724152716.r8vd2tfrtypwgo8c@coolrunningconcepts.com>
References: <200507241936.j6OJa8dC013004@sheep.berlios.de> <20050724152716.r8vd2tfrtypwgo8c@coolrunningconcepts.com>
Message-ID: <20050725004128.GS18998@elbert.is-a-geek.org>

On Sun, Jul 24, 2005 at 03:27:16PM -0600, evan at coolrunningconcepts.com wrote:
> Okay - just checked out latest SVN
> 
> Quoting Jason LeBrun at BerliOS <jblebrun at berlios.de>:
> 
> >PLEASE BEAT THE HELL OUT OF THIS!
> 
> Can't .... turn ... off ... chat ... sort ...
> 
> AHHHH!!!   The plugin isn't turned on, but the thing sorts by join 
> order all the
> time and I can't go back to alphabetical.    I kinda likes alphabetical!

Me too...depends on which channel I'm in though.

> I noticed the little icons that show if they have a picture or not have 
> changed.
>  Guess I can figure them out.   But .. what is half star vs blank vs orange
> thingy?   I got a blank (no icon) with a picture and bio - shouldn't 
> that be an
> orange thingy?

Its in README

> The thumbnails in chat rooms aren't displayed the same as the 
> thumbnails in IMs.
>    Not all thumbs fit in the chat room "box" - not sure if thats fixable.

Seriously, some "thumbnails" are 640x480.  Hopefully they will not be
presented that big--we need to have some limit, but not sure what it is.

> The bio at the bottom of the channel and the age and location and all that 
> is
> kinda duplicating whats in the "Get Info" and take up quite a bit of space.
> Can it be put in a smaller font for the channel and IM windows?
> 
> No one has put in the "profile headline" feature into the Get Info window  
> (or
> in the chat window).  See
> http://coolrunningconcepts.com/gaym/Screenshot-getinfo.png
> 
> Not the greatest example since the profile headline duplicates much of the 
> BIO
> but you get the idea - you get the information from the mini-profile.  
> Check it
> out.   Good stuff!

I would ultimately like to see tooltips like the buddy list. and
thumbnails looking like the chat window.  Then "Get Info" would display
either the mini-profile or a message saying the user has no profile.
(I'm working on that, but haven't had much time for it
today....hopefully soon).

> I also miss my small joins with blue bios .. but I'll make a plugin to get 
> it
> back one of these days :/
> 
> 
> 
> _______________________________________________
> Qrc-devel mailing list
> Qrc-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/qrc-devel
> 

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html


From deckrider at gmail.com  Mon Jul 25 02:48:25 2005
From: deckrider at gmail.com (David Everly)
Date: Sun, 24 Jul 2005 18:48:25 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r237 - in qrc/trunk: gaym/src gaym-extras
In-Reply-To: <1122221750.16892.93.camel@localhost>
References: <200507240818.j6O8I8d8014691@sheep.berlios.de> <20050724122415.GL18998@elbert.is-a-geek.org> <1122221750.16892.93.camel@localhost>
Message-ID: <20050725004825.GT18998@elbert.is-a-geek.org>

On Sun, Jul 24, 2005 at 11:15:49AM -0500, Jason LeBrun wrote:
> Just needs to link to libgaym.dll

Your going to kill me for suggesting this but....

This separation seems more and more artificial to me.  I understand that
a prpl containing gtk will never get into the gaim source tree.  Are we
trying for that?  Do we think it will happen one day?

If not, perhaps we should let this code live in the gaym plugin?  Still
try to separate it into logical components (gtk????.c), but since
it won't work with any other prpl, I don't see why we should force
separation?

I'm not suggesting immediate change....but something to think
about....let me hear your thoughts.

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050724/40a5a78c/attachment.pgp>

From jason at jasonlebrun.info  Mon Jul 25 02:58:05 2005
From: jason at jasonlebrun.info (Jason LeBrun)
Date: Sun, 24 Jul 2005 19:58:05 -0500
Subject: [Qrc-devel] Re: [Qrc-svn] r239 - in qrc/trunk: gaym/src
	gaym-extras
In-Reply-To: <20050724152716.r8vd2tfrtypwgo8c@coolrunningconcepts.com>
References: <200507241936.j6OJa8dC013004@sheep.berlios.de>
	 <20050724152716.r8vd2tfrtypwgo8c@coolrunningconcepts.com>
Message-ID: <1122253085.16892.102.camel@localhost>

> Can't .... turn ... off ... chat ... sort ...
> AHHHH!!!   The plugin isn't turned on, but the thing sorts by join 
> order all the
> time and I can't go back to alphabetical.    I kinda likes alphabetical!
> 
Yeah, sorry, it's all kinda rolled into one. What's about to happen is
that you will be able to click a button that will change the sorting of
the room namelist. Bear with me here ;-)



> The thumbnails in chat rooms aren't displayed the same as the 
> thumbnails in IMs.
>     Not all thumbs fit in the chat room "box" - not sure if thats fixable.

It is. I turned off icon scaling, because after looking at config.txt, I
noticed that there is a place that specifies the thumbnail size (57 x
77). I thought they all fit that spec. Since I hadn't seen an icon yet
that didn't fit, I assumed it was always followed. I can easily remedy
this by uncommenting a line. :)

> The bio at the bottom of the channel and the age and location and all that is
> kinda duplicating whats in the "Get Info" and take up quite a bit of space.
> Can it be put in a smaller font for the channel and IM windows?

In order to see "Get Info" you have to click another button, and then
close another window. This functionality is different than that, so I
don't consider it duplication. I will add a feature to disable it. The
font can be made smaller, I just have to find the right gtk call ;-)

> No one has put in the "profile headline" feature into the Get Info window  (or
> in the chat window).  See
> http://coolrunningconcepts.com/gaym/Screenshot-getinfo.png
> 
David mentioned that he is working on completely overhauling the
mini-profile. So I assume he will include your ideas.


> I also miss my small joins with blue bios .. but I'll make a plugin to get it
> back one of these days :/

I can include this in the gaym-extras plugin.

Jason




From gaym at jasonlebrun.info  Mon Jul 25 03:01:41 2005
From: gaym at jasonlebrun.info (Jason LeBrun)
Date: Sun, 24 Jul 2005 20:01:41 -0500
Subject: [Qrc-devel] Re: [Qrc-svn] r239 - in qrc/trunk: gaym/src
	gaym-extras
In-Reply-To: <20050725004128.GS18998@elbert.is-a-geek.org>
References: <200507241936.j6OJa8dC013004@sheep.berlios.de>
	 <20050724152716.r8vd2tfrtypwgo8c@coolrunningconcepts.com>
	 <20050725004128.GS18998@elbert.is-a-geek.org>
Message-ID: <1122253301.16892.107.camel@localhost>

> > The thumbnails in chat rooms aren't displayed the same as the 
> > thumbnails in IMs.
> >    Not all thumbs fit in the chat room "box" - not sure if thats fixable.
> 
> Seriously, some "thumbnails" are 640x480.  Hopefully they will not be
> presented that big--we need to have some limit, but not sure what it is.

They are already limited, they're probably just truncated right now,
yes? Unless they force the frame to expand to fit them. Can someone tell
me a room with big thumbnail people? (I haven't seen a "too big" one
yet.

> I would ultimately like to see tooltips like the buddy list. and
> thumbnails looking like the chat window.  Then "Get Info" would display
> either the mini-profile or a message saying the user has no profile.
> (I'm working on that, but haven't had much time for it
> today....hopefully soon).

Also, the icon and the bioline aren't necessarily in the best place. The
box packing functions don't behave properly, still trying to figure them
out.


The bioline is split into lines because I turned "wrap" on, and for some
reason the label widget won't expand horizontally. Another thing I'm
still playing with.


Jason




From gaym at jasonlebrun.info  Mon Jul 25 03:06:02 2005
From: gaym at jasonlebrun.info (Jason LeBrun)
Date: Sun, 24 Jul 2005 20:06:02 -0500
Subject: [Qrc-devel] Re: [Qrc-svn] r237 - in qrc/trunk: gaym/src
	gaym-extras
In-Reply-To: <20050725004825.GT18998@elbert.is-a-geek.org>
References: <200507240818.j6O8I8d8014691@sheep.berlios.de>
	 <20050724122415.GL18998@elbert.is-a-geek.org>
	 <1122221750.16892.93.camel@localhost>
	 <20050725004825.GT18998@elbert.is-a-geek.org>
Message-ID: <1122253562.16892.112.camel@localhost>

On Sun, 2005-07-24 at 18:48 -0600, David Everly wrote:

> If not, perhaps we should let this code live in the gaym plugin?  Still
> try to separate it into logical components (gtk????.c), but since
> it won't work with any other prpl, I don't see why we should force
> separation?
> I'm not suggesting immediate change....but something to think
> about....let me hear your thoughts.

Another issue is the fact that other IM clients besides Gaim can use
libgaim. So, while we may not be included in the "official" tree, it
still trivializes the act of porting libgaym to a different chat client,
should someone choose to. 

I'm also, in general, a big fan of content/presentation separations, so
I like this model for personal reasons, as well. It makes the code
easier to maintain, too. 

Jason






From deckrider at gmail.com  Mon Jul 25 05:20:07 2005
From: deckrider at gmail.com (David Everly)
Date: Sun, 24 Jul 2005 21:20:07 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r239 - in qrc/trunk: gaym/src gaym-extras
In-Reply-To: <1122253085.16892.102.camel@localhost>
References: <200507241936.j6OJa8dC013004@sheep.berlios.de> <20050724152716.r8vd2tfrtypwgo8c@coolrunningconcepts.com> <1122253085.16892.102.camel@localhost>
Message-ID: <20050725032007.GU18998@elbert.is-a-geek.org>

On Sun, Jul 24, 2005 at 07:58:05PM -0500, Jason LeBrun wrote:
> It is. I turned off icon scaling, because after looking at config.txt, I
> noticed that there is a place that specifies the thumbnail size (57 x
> 77). I thought they all fit that spec. Since I hadn't seen an icon yet
> that didn't fit, I assumed it was always followed. I can easily remedy
> this by uncommenting a line. :)

Actually, gay.com's java applet respects that setting also, and I've
seen thumbnails that are truncated with their own client.

I like the idea of keeping gay.com's settings...and perhaps scale the
larger ones.

> > The bio at the bottom of the channel and the age and location and all that is
> > kinda duplicating whats in the "Get Info" and take up quite a bit of space.
> > Can it be put in a smaller font for the channel and IM windows?
> 
> In order to see "Get Info" you have to click another button, and then
> close another window. This functionality is different than that, so I
> don't consider it duplication. I will add a feature to disable it. The
> font can be made smaller, I just have to find the right gtk call ;-)
> 
> > No one has put in the "profile headline" feature into the Get Info window  (or
> > in the chat window).  See
> > http://coolrunningconcepts.com/gaym/Screenshot-getinfo.png
> > 
> David mentioned that he is working on completely overhauling the
> mini-profile. So I assume he will include your ideas.

Yes, the mini profile is actually a java properties file.  I intend to
display as many properties from it as make sense (for instance, it
doesn't make sense to display pictures.1.width=190) as well as all the
pictures in it.

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050724/4f28d01d/attachment.pgp>

From Evan at CoolRunningConcepts.com  Mon Jul 25 06:48:08 2005
From: Evan at CoolRunningConcepts.com (Evan Langlois)
Date: Sun, 24 Jul 2005 23:48:08 -0500
Subject: [Qrc-devel] Re: [Qrc-svn] r237 - in qrc/trunk: gaym/src
	gaym-extras
In-Reply-To: <1122253562.16892.112.camel@localhost>
References: <200507240818.j6O8I8d8014691@sheep.berlios.de>
	 <20050724122415.GL18998@elbert.is-a-geek.org>
	 <1122221750.16892.93.camel@localhost>
	 <20050725004825.GT18998@elbert.is-a-geek.org>
	 <1122253562.16892.112.camel@localhost>
Message-ID: <1122266890.19747.39.camel@taro.coolrunningconcepts.com>

On Sun, 2005-07-24 at 20:06 -0500, Jason LeBrun wrote:
> Another issue is the fact that other IM clients besides Gaim can use
> libgaim. So, while we may not be included in the "official" tree, it
> still trivializes the act of porting libgaym to a different chat client,
> should someone choose to. 

Like the Mac OS X clients that use libgaim - or the qpe-gaim.  In fact,
the original idea behind gay.com on gaim was because I was using xchat
to talk to gay.com and I could run IRC on my Sharp Zaurus using
qpe-gaim.  Soo ... I'd have to agree to keep gui code out of the prpl.




From Evan at CoolRunningConcepts.com  Mon Jul 25 07:07:45 2005
From: Evan at CoolRunningConcepts.com (Evan Langlois)
Date: Mon, 25 Jul 2005 00:07:45 -0500
Subject: [Qrc-devel] Re: [Qrc-svn] r241 - in qrc/trunk: gaym/src gaym-extras
In-Reply-To: <200507250457.j6P4v91M013374@sheep.berlios.de>
References: <200507250457.j6P4v91M013374@sheep.berlios.de>
Message-ID: <1122268067.19747.43.camel@taro.coolrunningconcepts.com>

On Mon, 2005-07-25 at 06:57 +0200, Jason LeBrun at BerliOS wrote:
> Log:
> Now there is a button to change the sort order. Just for you, Evan!
> Note that I also fixed the stupid "sort upper before lower" behavior.
> If anyone actually found that useful, I'll make another sort state.

yay!

No, I think case sensitive is a waste.

> Can someone make informative icons for the button? 

A chance to use Gimp?  I'm on it!  What size?

> 
> Right now 
> 
> A = Alpha
> E = Entry
> P = Picture type

-- Evan




From jason at jasonlebrun.info  Mon Jul 25 07:07:11 2005
From: jason at jasonlebrun.info (Jason LeBrun)
Date: Mon, 25 Jul 2005 00:07:11 -0500
Subject: [Qrc-devel] A release
Message-ID: <1122268031.16975.3.camel@localhost>

Hi everyone,

I just added a bunch of features this weekend, so like David said, a
release would be good. Before the release, here is what I think needs to
happen:

*I need to fix the hammer code to suck less (I have the design, just
need to add it in).
*I should change the login process as per previous discussions (using
cached hashes, etc)
*Everyone needs to test the icon/bio code.
*I need to get the bio display in private (IM) windows in a better
place. 
*We need icons for the sort-order button.

Please run in debug mode and send core dumps if you crash!

Jason




From Evan at CoolRunningConcepts.com  Mon Jul 25 07:11:26 2005
From: Evan at CoolRunningConcepts.com (Evan Langlois)
Date: Mon, 25 Jul 2005 00:11:26 -0500
Subject: [Qrc-devel] Re: [Qrc-svn] r239 - in qrc/trunk: gaym/src
	gaym-extras
In-Reply-To: <1122253085.16892.102.camel@localhost>
References: <200507241936.j6OJa8dC013004@sheep.berlios.de>
	 <20050724152716.r8vd2tfrtypwgo8c@coolrunningconcepts.com>
	 <1122253085.16892.102.camel@localhost>
Message-ID: <1122268288.19747.47.camel@taro.coolrunningconcepts.com>

On Sun, 2005-07-24 at 19:58 -0500, Jason LeBrun wrote:
> Yeah, sorry, it's all kinda rolled into one. What's about to happen is
> that you will be able to click a button that will change the sorting of
> the room namelist. Bear with me here ;-)

Ah ... ok.  But .. without the plugin enabled it still does this sort?
Or is my chatsort plugin just a leftover from a previous install?

> It is. I turned off icon scaling, because after looking at config.txt, I
> noticed that there is a place that specifies the thumbnail size (57 x
> 77). I thought they all fit that spec. Since I hadn't seen an icon yet
> that didn't fit, I assumed it was always followed. I can easily remedy
> this by uncommenting a line. :)

Well, in the IM windows, the box around the icon changes size.  If you
scale the icon to the box the aspect ratio could be aweful.  Although, I
noticed some pics have really tiny thumbs for some odd reason.  You
could scale it, but I don't think there is enough information to scale.
If the box size can change, great.  If you have to change the icon size,
don't bother.

> In order to see "Get Info" you have to click another button, and then
> close another window. This functionality is different than that, so I
> don't consider it duplication. I will add a feature to disable it. The
> font can be made smaller, I just have to find the right gtk call ;-)

I'm voting for just a smaller font, with maybe the Age & Location
abbreviated like in stats, or use bold for the field names.  Other than
that and odd resizing of the window .. it works really well!

Now there is no more reason for anyone to use Chat Client!

> David mentioned that he is working on completely overhauling the
> mini-profile. So I assume he will include your ideas.

Adding the profile heading to the Age/Location/Bio information you have
in the channel and IM windows may be beneficial.  Once you get used to
seeing this information, you miss it!   Its usually as informative as
the BIO, or better.

> > I also miss my small joins with blue bios .. but I'll make a plugin to get it
> > back one of these days :/
> 
> I can include this in the gaym-extras plugin.

I made a stand-alone plugin for it.  It just changes the size of the
system messages (and un-bolds them) - working on getting the BIO parsed
out and to another color - and eventually someone (maybe me) can add the
user interface options to make it all configurable ... I just can't
stand the big bold join/parts anymore.  

The main issue is that you can easily turn it off and system messages go
back to normal, but it needs to get a GaimConversationUiOps structure,
and all I could think of was to throw a signal in there so that you get
a GaimConv on joining a chanenl and can grab the UiOps from there.
Works fine unless you turn it off and then back on again ... you'll have
to rejoin the channel to get it working.

So .. there's probably a better way!  Suggestions welcome.  However, I
think this method has more possibilities for the future in twisting the
display capabilities



From Evan at CoolRunningConcepts.com  Mon Jul 25 07:14:01 2005
From: Evan at CoolRunningConcepts.com (Evan Langlois)
Date: Mon, 25 Jul 2005 00:14:01 -0500
Subject: [Qrc-devel] Re: [Qrc-svn] r239 - in qrc/trunk: gaym/src
	gaym-extras
In-Reply-To: <1122253085.16892.102.camel@localhost>
References: <200507241936.j6OJa8dC013004@sheep.berlios.de>
	 <20050724152716.r8vd2tfrtypwgo8c@coolrunningconcepts.com>
	 <1122253085.16892.102.camel@localhost>
Message-ID: <1122268442.27339.1.camel@taro.coolrunningconcepts.com>

On Sun, 2005-07-24 at 19:58 -0500, Jason LeBrun wrote: 
> Yeah, sorry, it's all kinda rolled into one. What's about to happen is
> that you will be able to click a button that will change the sorting of
> the room namelist. Bear with me here ;-)

Ah ... ok.  But .. without the plugin enabled it still does this sort?
Or is my chatsort plugin just a leftover from a previous install?

> It is. I turned off icon scaling, because after looking at config.txt, I
> noticed that there is a place that specifies the thumbnail size (57 x
> 77). I thought they all fit that spec. Since I hadn't seen an icon yet
> that didn't fit, I assumed it was always followed. I can easily remedy
> this by uncommenting a line. :)

Well, in the IM windows, the box around the icon changes size.  If you
scale the icon to the box the aspect ratio could be aweful.  Although, I
noticed some pics have really tiny thumbs for some odd reason.  You
could scale it, but I don't think there is enough information to scale.
If the box size can change, great.  If you have to change the icon size,
don't bother.

> In order to see "Get Info" you have to click another button, and then
> close another window. This functionality is different than that, so I
> don't consider it duplication. I will add a feature to disable it. The
> font can be made smaller, I just have to find the right gtk call ;-)

I'm voting for just a smaller font, with maybe the Age & Location
abbreviated like in stats, or use bold for the field names.  Other than
that and odd resizing of the window .. it works really well!

Now there is no more reason for anyone to use Chat Client!

> David mentioned that he is working on completely overhauling the
> mini-profile. So I assume he will include your ideas.

Adding the profile heading to the Age/Location/Bio information you have
in the channel and IM windows may be beneficial.  Once you get used to
seeing this information, you miss it!   Its usually as informative as
the BIO, or better.

> > I also miss my small joins with blue bios .. but I'll make a plugin to get it
> > back one of these days :/
> 
> I can include this in the gaym-extras plugin.

I made a stand-alone plugin for it.  It just changes the size of the
system messages (and un-bolds them) - working on getting the BIO parsed
out and to another color - and eventually someone (maybe me) can add the
user interface options to make it all configurable ... I just can't
stand the big bold join/parts anymore.  

The main issue is that you can easily turn it off and system messages go
back to normal, but it needs to get a GaimConversationUiOps structure,
and all I could think of was to throw a signal in there so that it takes
effect when you join a channel.  Works fine unless you turn it off and
then back on again ... you'll have to rejoin the channel to get it
working.

So .. there's probably a better way!  However, I think this method has
more possibilities for the future in twisting the display capabilities



From gaym at jasonlebrun.info  Mon Jul 25 07:12:04 2005
From: gaym at jasonlebrun.info (Jason LeBrun)
Date: Mon, 25 Jul 2005 00:12:04 -0500
Subject: [Qrc-devel] A release
In-Reply-To: <1122268031.16975.3.camel@localhost>
References: <1122268031.16975.3.camel@localhost>
Message-ID: <1122268324.16975.8.camel@localhost>

Errr, I meant back traces. Not core dumps.
Obviously.

Hehe.

On Mon, 2005-07-25 at 00:07 -0500, Jason LeBrun wrote:
> Hi everyone,

> Please run in debug mode and send core dumps if you crash!
> 
> Jason
> 




From Evan at CoolRunningConcepts.com  Mon Jul 25 07:20:44 2005
From: Evan at CoolRunningConcepts.com (Evan Langlois)
Date: Mon, 25 Jul 2005 00:20:44 -0500
Subject: [Qrc-devel] A release
In-Reply-To: <1122268031.16975.3.camel@localhost>
References: <1122268031.16975.3.camel@localhost>
Message-ID: <1122268844.27339.5.camel@taro.coolrunningconcepts.com>

On Mon, 2005-07-25 at 00:07 -0500, Jason LeBrun wrote:

> *I need to fix the hammer code to suck less (I have the design, just
> need to add it in).

Yeah - ever try to hammer in two channels at once?  Sometimes I try to
join Citywide 2 while Citywide 1 is hammering and it says Citywide 2 is
full ... don't let it hammer both cause it gets confused!

> *I should change the login process as per previous discussions (using
> cached hashes, etc)

No comment.

> *Everyone needs to test the icon/bio code.

OK.  You change it faster than I can download it and compile it!

> *I need to get the bio display in private (IM) windows in a better
> place.

OK

> *We need icons for the sort-order button.

24 x 24 ... coming soon!

Guess I need to checkout the latest SVN now 




From jason at jasonlebrun.info  Mon Jul 25 07:26:00 2005
From: jason at jasonlebrun.info (Jason LeBrun)
Date: Mon, 25 Jul 2005 00:26:00 -0500
Subject: [Qrc-devel] Re: [Qrc-svn] r239 - in qrc/trunk: gaym/src
	gaym-extras
In-Reply-To: <1122268442.27339.1.camel@taro.coolrunningconcepts.com>
References: <200507241936.j6OJa8dC013004@sheep.berlios.de>
	 <20050724152716.r8vd2tfrtypwgo8c@coolrunningconcepts.com>
	 <1122253085.16892.102.camel@localhost>
	 <1122268442.27339.1.camel@taro.coolrunningconcepts.com>
Message-ID: <1122269160.16975.23.camel@localhost>

> Ah ... ok.  But .. without the plugin enabled it still does this sort?
> Or is my chatsort plugin just a leftover from a previous install?

Yeah. Get rid of libchatsort.?? and libroombrowse.?? and libchaticon.??,
if you have them. They're all subsumed by libgaym-extras

> Well, in the IM windows, the box around the icon changes size.  If you
> scale the icon to the box the aspect ratio could be aweful.  Although, I
> noticed some pics have really tiny thumbs for some odd reason.  You
> could scale it, but I don't think there is enough information to scale.
> If the box size can change, great.  If you have to change the icon size,
> don't bother.

There is scaling code that will maintain aspect ratio. I used that. The
frame size should not be changing... mine does not. Hrm.


> I'm voting for just a smaller font, with maybe the Age & Location
> abbreviated like in stats, or use bold for the field names.  Other than
> that and odd resizing of the window .. it works really well!

How about tooltip windows instead? :)

> Now there is no more reason for anyone to use Chat Client!

Some people still won't use it because the can't "lurk" :( 
I'll do that next weekend ;-)
 
> The main issue is that you can easily turn it off and system messages go
> back to normal, but it needs to get a GaimConversationUiOps structure,
> and all I could think of was to throw a signal in there so that it takes
> effect when you join a channel.  Works fine unless you turn it off and
> then back on again ... you'll have to rejoin the channel to get it
> working.
> 
> So .. there's probably a better way!  However, I think this method has
> more possibilities for the future in twisting the display capabilities
> 
On plugin load:

GaimConversationUiOps *the_ops;
GList *conversations = gaim_get_conversations();
conversations = g_list_first(conversations);
while(conversations) {
	GaimConversation *conv = conversations->data;
	if(conv->type == GAIM_CONV_CHAT)
	{
		the_ops = gaim_conversation_get_ui_ops(conv);
		break;
	}
	conversations = g_list_next(conversations);
}



Jason



From Evan at CoolRunningConcepts.com  Mon Jul 25 07:43:17 2005
From: Evan at CoolRunningConcepts.com (Evan Langlois)
Date: Mon, 25 Jul 2005 00:43:17 -0500
Subject: [Qrc-devel] Re: [Qrc-svn] r239 - in qrc/trunk: gaym/src
	gaym-extras
In-Reply-To: <1122269160.16975.23.camel@localhost>
References: <200507241936.j6OJa8dC013004@sheep.berlios.de>
	 <20050724152716.r8vd2tfrtypwgo8c@coolrunningconcepts.com>
	 <1122253085.16892.102.camel@localhost>
	 <1122268442.27339.1.camel@taro.coolrunningconcepts.com>
	 <1122269160.16975.23.camel@localhost>
Message-ID: <1122270197.27339.9.camel@taro.coolrunningconcepts.com>

On Mon, 2005-07-25 at 00:26 -0500, Jason LeBrun wrote:

> On plugin load:
> 
> GaimConversationUiOps *the_ops;
> GList *conversations = gaim_get_conversations();
> conversations = g_list_first(conversations);
> while(conversations) {
> 	GaimConversation *conv = conversations->data;
> 	if(conv->type == GAIM_CONV_CHAT)
> 	{
> 		the_ops = gaim_conversation_get_ui_ops(conv);
> 		break;
> 	}
> 	conversations = g_list_next(conversations);
> }

Thank you!  You Rock!

gaim_get_conversations was what I needed - I was just too lazy to look
it up.





From Evan at CoolRunningConcepts.com  Mon Jul 25 08:17:36 2005
From: Evan at CoolRunningConcepts.com (Evan Langlois)
Date: Mon, 25 Jul 2005 01:17:36 -0500
Subject: [Qrc-devel] "Display" plugin
In-Reply-To: <1122268324.16975.8.camel@localhost>
References: <1122268031.16975.3.camel@localhost>
	 <1122268324.16975.8.camel@localhost>
Message-ID: <1122272257.27339.18.camel@taro.coolrunningconcepts.com>


OK guys ... here's how things look with the "display plugin" changing
the joins & parts .. only 1 message is from a user while the rest are
just join/part messages. 

M2MMidCities [38, 6', 180, brn, blu, 42c, 32w, mascuilne, very oral,
versatile bottom, hiv neg/ddf, non-smoker, looking for a cool buddy]
entered the room.
hotplusbottom..oaklawn: ..........................Horny in Oak
Lawn.....................Looking..................PVT cool
masand0012 entered the room.
twocowboysfun [ looking for good looking guys with stache
mailto:twocowboysfun at aol.com] entered the room.
M2MMidCities left the room.
boredbiplano24 entered the room.
hot_tiger70 [32 5'11 165 Hispanic East of Dallas] entered the room.


The string functions are aweful (stupid g_strsplit didn't work like I
thought).  Not sure if I like that shade of cyan .. not sure if I like
the bold names or I should put those back ... but ... its a start - do
real parsing later and let the user pick the styles and colors.  This
can modify any messages going to the screen just before display - not
just system messages but right now all it touches is system messages.
It doesn't crash, you can turn it off and on, and it affects all
protocols evenly.  Code is attached!

-- Evan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050725/fc75765c/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: displayoptions.c
Type: text/x-csrc
Size: 3852 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050725/fc75765c/attachment.c>

From Evan at CoolRunningConcepts.com  Mon Jul 25 08:28:58 2005
From: Evan at CoolRunningConcepts.com (Evan Langlois)
Date: Mon, 25 Jul 2005 01:28:58 -0500
Subject: [Qrc-devel] A release
In-Reply-To: <1122268031.16975.3.camel@localhost>
References: <1122268031.16975.3.camel@localhost>
Message-ID: <1122272939.27339.23.camel@taro.coolrunningconcepts.com>

On Mon, 2005-07-25 at 00:07 -0500, Jason LeBrun wrote:

> *Everyone needs to test the icon/bio code.

OK - when you click a user to see the thumbnail, the bio in the tooltip
goes away.  Any way to make it come back sooner instead of leaving the
name and coming back?

The icon scaling is definately weird.  Some people have thumbs that fit
the little frame.  Any clue why mine has a huge border around it?

> *I need to get the bio display in private (IM) windows in a better
> place. 

How about at the top?   Is there a field for chatrooms to have a
topic-line?  One of the IRC programs I used used to put some of the
whois information in this line (user at hostmask I think) as a visual clue,
and interface-wise that worked out well.  Having the bio at the top
where the topic-line goes would be nifty.

> *We need icons for the sort-order button.

E and P are reversed.  I'll have some icons for ya soon.  I LOVE how
fast it resorts the room!

> Please run in debug mode and send core dumps if you crash!

Smooth sailing so far.

-- Evan




From deckrider at gmail.com  Mon Jul 25 13:57:49 2005
From: deckrider at gmail.com (David Everly)
Date: Mon, 25 Jul 2005 05:57:49 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r241 - in qrc/trunk: gaym/src gaym-extras
In-Reply-To: <1122268067.19747.43.camel@taro.coolrunningconcepts.com>
References: <200507250457.j6P4v91M013374@sheep.berlios.de> <1122268067.19747.43.camel@taro.coolrunningconcepts.com>
Message-ID: <20050725115749.GV18998@elbert.is-a-geek.org>

On Mon, Jul 25, 2005 at 12:07:45AM -0500, Evan Langlois wrote:
> On Mon, 2005-07-25 at 06:57 +0200, Jason LeBrun at BerliOS wrote:
> > Log:
> > Now there is a button to change the sort order. Just for you, Evan!
> > Note that I also fixed the stupid "sort upper before lower" behavior.
> > If anyone actually found that useful, I'll make another sort state.
> 
> yay!
> 
> No, I think case sensitive is a waste.

Gaim used to sort based on locale and we should too.  If locale is C
then it would be sorted by case.

> > Can someone make informative icons for the button? 
> 
> A chance to use Gimp?  I'm on it!  What size?
> 
> > 
> > Right now 
> > 
> > A = Alpha
> > E = Entry
> > P = Picture type
> 
> -- Evan
> 
> 
> _______________________________________________
> Qrc-devel mailing list
> Qrc-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/qrc-devel
> 

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html


From deckrider at gmail.com  Mon Jul 25 14:02:47 2005
From: deckrider at gmail.com (David Everly)
Date: Mon, 25 Jul 2005 06:02:47 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r239 - in qrc/trunk: gaym/src gaym-extras
In-Reply-To: <1122269160.16975.23.camel@localhost>
References: <200507241936.j6OJa8dC013004@sheep.berlios.de> <20050724152716.r8vd2tfrtypwgo8c@coolrunningconcepts.com> <1122253085.16892.102.camel@localhost> <1122268442.27339.1.camel@taro.coolrunningconcepts.com> <1122269160.16975.23.camel@localhost>
Message-ID: <20050725120247.GW18998@elbert.is-a-geek.org>

On Mon, Jul 25, 2005 at 12:26:00AM -0500, Jason LeBrun wrote:
> Some people still won't use it because the can't "lurk" :( 
> I'll do that next weekend ;-)

Lurking is false....it simply sends a NOTIFY offline....which we ignore
anyway since WHOIS still comes back positive.

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html


From deckrider at gmail.com  Mon Jul 25 14:12:03 2005
From: deckrider at gmail.com (David Everly)
Date: Mon, 25 Jul 2005 06:12:03 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r239 - in qrc/trunk: gaym/src gaym-extras
In-Reply-To: <1122268288.19747.47.camel@taro.coolrunningconcepts.com>
References: <200507241936.j6OJa8dC013004@sheep.berlios.de> <20050724152716.r8vd2tfrtypwgo8c@coolrunningconcepts.com> <1122253085.16892.102.camel@localhost> <1122268288.19747.47.camel@taro.coolrunningconcepts.com>
Message-ID: <20050725121203.GX18998@elbert.is-a-geek.org>

On Mon, Jul 25, 2005 at 12:11:26AM -0500, Evan Langlois wrote:
> Adding the profile heading to the Age/Location/Bio information you have
> in the channel and IM windows may be beneficial.  Once you get used to
> seeing this information, you miss it!   Its usually as informative as
> the BIO, or better.

I disagree.  The extra IRC info is what we should use and it should be
consistently positioned/located across the application.  The only http
call should be for the thumbnail from the IRC info.

The mini-profile should likewise not display the IRC info, but
everything that is available within it.

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html


From deckrider at gmail.com  Mon Jul 25 14:32:27 2005
From: deckrider at gmail.com (David Everly)
Date: Mon, 25 Jul 2005 06:32:27 -0600
Subject: [Qrc-devel] crash
Message-ID: <20050725123226.GZ18998@elbert.is-a-geek.org>

Not sure what I was doing...perhaps tooltip stuff?

Also, on tooltips...we should not display items for which nothing
exists....look at gaym.c for this.  Don't do "Age:?"...just don't show
the age and save the line.

Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread 1084376480 (LWP 27290)]
namelist_tooltip_timeout (data=0x0) at gaym-extras.c:600
600         if (!cm->age && !cm->location && !cm->bio)

(gdb) bt full
#0  namelist_tooltip_timeout (data=0x0) at gaym-extras.c:600
        path = (GtkTreePath *) 0x8413aa8
        iter = {stamp = -1790377838, user_data = 0x8324c78, user_data2 = 0x0,
  user_data3 = 0x0}
        model = (GtkTreeModel *) 0x83401c8
        name = (gchar *) 0x840c338 "deckrider"
        scr_w = 135509176
        scr_h = 1073961284
        w = -1073769032
        h = 1073961920
        x = 72
        y = 138203832
        mon_num = 0
        screen = (GdkScreen *) 0x0
        layout = (PangoLayout *) 0x40778034
        tooltiptext = 0x83401c8 "\uffff"
        mon_size = {x = 1086882788, y = 135566696, width = -1073769000,
  height = 1086872183}
        rect = (GdkRectangle *) 0xbfff95d0
        timeout = (guint *) 0x83a6e00
        tipwindow = (GtkWidget *) 0x813b4b8
        tv = (GtkWidget *) 0x8340c80
        gaym = (struct gaym_conn *) 0x82cc840
        cm = (GaymChannelMember *) 0x0
#1  0x405a6c9c in g_main_context_wakeup () from /usr/lib/libglib-2.0.so.0
No symbol table info available.
#2  0x405a4582 in g_main_depth () from /usr/lib/libglib-2.0.so.0
No symbol table info available.
#3  0x405a55f8 in g_main_context_dispatch () from /usr/lib/libglib-2.0.so.0
No symbol table info available.
#4  0x405a5930 in g_main_context_dispatch () from /usr/lib/libglib-2.0.so.0
No symbol table info available.
#5  0x405a5ed3 in g_main_loop_run () from /usr/lib/libglib-2.0.so.0
No symbol table info available.
#6  0x40264bb3 in gtk_main () from /usr/lib/libgtk-x11-2.0.so.0
No symbol table info available.
#7  0x080f8353 in main ()
No symbol table info available.


-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html


From deckrider at gmail.com  Mon Jul 25 14:35:12 2005
From: deckrider at gmail.com (David Everly)
Date: Mon, 25 Jul 2005 06:35:12 -0600
Subject: [Qrc-devel] Tooltip for IM window
Message-ID: <20050725123512.GA18998@elbert.is-a-geek.org>

I can't find any precedent for this, but can we not take up space for
IRC extra info on the IM window?  Instead, perhaps the same tooltip as
in the buddy list for the window's tab?

I'll break this off into helpers.c so the same code can be used
everywhere.

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html


From deckrider at gmail.com  Mon Jul 25 15:08:34 2005
From: deckrider at gmail.com (David Everly)
Date: Mon, 25 Jul 2005 07:08:34 -0600
Subject: [Qrc-devel] normalize gaym.h
Message-ID: <20050725130834.GB18998@elbert.is-a-geek.org>

We need to do some normalization of gaym.h

For instance, there should be a common struct between gaym_buddy and
channel_member, instead of duplicating as we do now.
-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html


From deckrider at gmail.com  Mon Jul 25 15:52:26 2005
From: deckrider at gmail.com (David Everly)
Date: Mon, 25 Jul 2005 07:52:26 -0600
Subject: [Qrc-devel] [deckrider@berlios.de: [Qrc-svn] r245 - in qrc/trunk: gaym/src gaym-extras]
Message-ID: <20050725135226.GC18998@elbert.is-a-geek.org>

We really should be doing this instead:

                if (prpl_info && prpl_info->tooltip_text) {
                        const char *end;
                        statustext = prpl_info->tooltip_text(b);

                        if(statustext && !g_utf8_validate(statustext, -1, &end)) {
                                char *new = g_strndup(statustext,
                                                g_utf8_pointer_to_offset(statustext, end));
                                g_free(statustext);
                                statustext = new;
                        }
                }

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
An embedded message was scrubbed...
From: David Everly at BerliOS <deckrider at berlios.de>
Subject: [Qrc-svn] r245 - in qrc/trunk: gaym/src gaym-extras
Date: Mon, 25 Jul 2005 15:31:52 +0200
Size: 14391
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050725/394cade3/attachment.mht>

From deckrider at gmail.com  Mon Jul 25 15:55:16 2005
From: deckrider at gmail.com (David Everly)
Date: Mon, 25 Jul 2005 07:55:16 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r237 - in qrc/trunk: gaym/src gaym-extras
In-Reply-To: <1122253562.16892.112.camel@localhost>
References: <200507240818.j6O8I8d8014691@sheep.berlios.de> <20050724122415.GL18998@elbert.is-a-geek.org> <1122221750.16892.93.camel@localhost> <20050725004825.GT18998@elbert.is-a-geek.org> <1122253562.16892.112.camel@localhost>
Message-ID: <20050725135516.GD18998@elbert.is-a-geek.org>

On Sun, Jul 24, 2005 at 08:06:02PM -0500, Jason LeBrun wrote:
> On Sun, 2005-07-24 at 18:48 -0600, David Everly wrote:
> 
> > If not, perhaps we should let this code live in the gaym plugin?  Still
> > try to separate it into logical components (gtk????.c), but since
> > it won't work with any other prpl, I don't see why we should force
> > separation?
> > I'm not suggesting immediate change....but something to think
> > about....let me hear your thoughts.
> 
> Another issue is the fact that other IM clients besides Gaim can use
> libgaim. So, while we may not be included in the "official" tree, it
> still trivializes the act of porting libgaym to a different chat client,
> should someone choose to. 
> 
> I'm also, in general, a big fan of content/presentation separations, so
> I like this model for personal reasons, as well. It makes the code
> easier to maintain, too. 

Ok. If we keep the separation, then we need to do it right and eliminate
linking libgaym.so to libgaym-extras.so.  We need to follow the
mechanism for making certain functions "public".  For one, this means
using prpl_info when it is usefull (such as for the tooltip).  For
things that we need that aren't in prpl_info, we must make our own
gaym_info and use it.

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html


From deckrider at gmail.com  Mon Jul 25 14:26:58 2005
From: deckrider at gmail.com (deckrider at gmail.com)
Date: Mon, 25 Jul 2005 06:26:58 -0600
Subject: [Qrc-devel] thumbnail dimensions
Message-ID: <20050725122658.GY18998@elbert.is-a-geek.org>

Can we use the following properties instead of hard-coding the size:

   mini-profile-panel.thumbnail.width
   mini-profile-panel.thumbnail.height

Thanks,
Dave.
-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html


From deckrider at gmail.com  Mon Jul 25 17:36:24 2005
From: deckrider at gmail.com (David Everly)
Date: Mon, 25 Jul 2005 09:36:24 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r237 - in qrc/trunk: gaym/src gaym-extras
In-Reply-To: <20050725135516.GD18998@elbert.is-a-geek.org>
References: <200507240818.j6O8I8d8014691@sheep.berlios.de> <20050724122415.GL18998@elbert.is-a-geek.org> <1122221750.16892.93.camel@localhost> <20050725004825.GT18998@elbert.is-a-geek.org> <1122253562.16892.112.camel@localhost> <20050725135516.GD18998@elbert.is-a-geek.org>
Message-ID: <20050725153623.GA6711@elbert.is-a-geek.org>

On Mon, Jul 25, 2005 at 07:55:16AM -0600,  wrote:
> On Sun, Jul 24, 2005 at 08:06:02PM -0500, Jason LeBrun wrote:
> > On Sun, 2005-07-24 at 18:48 -0600, David Everly wrote:
> > 
> > > If not, perhaps we should let this code live in the gaym plugin?  Still
> > > try to separate it into logical components (gtk????.c), but since
> > > it won't work with any other prpl, I don't see why we should force
> > > separation?
> > > I'm not suggesting immediate change....but something to think
> > > about....let me hear your thoughts.
> > 
> > Another issue is the fact that other IM clients besides Gaim can use
> > libgaim. So, while we may not be included in the "official" tree, it
> > still trivializes the act of porting libgaym to a different chat client,
> > should someone choose to. 
> > 
> > I'm also, in general, a big fan of content/presentation separations, so
> > I like this model for personal reasons, as well. It makes the code
> > easier to maintain, too. 
> 
> Ok. If we keep the separation, then we need to do it right and eliminate
> linking libgaym.so to libgaym-extras.so.  We need to follow the
> mechanism for making certain functions "public".  For one, this means
> using prpl_info when it is usefull (such as for the tooltip).  For
> things that we need that aren't in prpl_info, we must make our own
> gaym_info and use it.

And as I think of it, I believe one of the following is already a place
for this:

   GaimPlugin->extra;
   GaimPluginInfo->extra_info;

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html


From Evan at CoolRunningConcepts.com  Mon Jul 25 19:15:47 2005
From: Evan at CoolRunningConcepts.com (Evan Langlois)
Date: Mon, 25 Jul 2005 12:15:47 -0500
Subject: [Qrc-devel] Re: [Qrc-svn] r239 - in qrc/trunk: gaym/src
	gaym-extras
In-Reply-To: <20050725121203.GX18998@elbert.is-a-geek.org>
References: <200507241936.j6OJa8dC013004@sheep.berlios.de>
	 <20050724152716.r8vd2tfrtypwgo8c@coolrunningconcepts.com>
	 <1122253085.16892.102.camel@localhost>
	 <1122268288.19747.47.camel@taro.coolrunningconcepts.com>
	 <20050725121203.GX18998@elbert.is-a-geek.org>
Message-ID: <1122311748.12782.1.camel@taro.coolrunningconcepts.com>

On Mon, 2005-07-25 at 06:12 -0600, David Everly wrote:

> I disagree.  The extra IRC info is what we should use and it should be
> consistently positioned/located across the application.  The only http
> call should be for the thumbnail from the IRC info.
> 
> The mini-profile should likewise not display the IRC info, but
> everything that is available within it.

A good interface has nothing to do with where gay.com puts their
information.  I'll consider other arguments, but the simply doesn't care
where the information comes from - why should you?




From Evan at CoolRunningConcepts.com  Mon Jul 25 19:18:52 2005
From: Evan at CoolRunningConcepts.com (Evan Langlois)
Date: Mon, 25 Jul 2005 12:18:52 -0500
Subject: [Qrc-devel] crash
In-Reply-To: <20050725123226.GZ18998@elbert.is-a-geek.org>
References: <20050725123226.GZ18998@elbert.is-a-geek.org>
Message-ID: <1122311933.12782.4.camel@taro.coolrunningconcepts.com>

On Mon, 2005-07-25 at 06:32 -0600, David Everly wrote:
> Not sure what I was doing...perhaps tooltip stuff?

I had one crash, but when I re-ran it under gdb I wasn't able to
reproduce it.

> Also, on tooltips...we should not display items for which nothing
> exists....look at gaym.c for this.  Don't do "Age:?"...just don't show
> the age and save the line.

Also putting the name of the user (in a larger font) in the tooltip like
the buddy list does would be nice.  Not only more consistent but a
visual indication of who your mouse is over and that you don't have the
wrong one.





From Evan at CoolRunningConcepts.com  Mon Jul 25 19:22:02 2005
From: Evan at CoolRunningConcepts.com (Evan Langlois)
Date: Mon, 25 Jul 2005 12:22:02 -0500
Subject: [Qrc-devel] Re: [Qrc-svn] r241 - in qrc/trunk: gaym/src
	gaym-extras
In-Reply-To: <20050725115749.GV18998@elbert.is-a-geek.org>
References: <200507250457.j6P4v91M013374@sheep.berlios.de>
	 <1122268067.19747.43.camel@taro.coolrunningconcepts.com>
	 <20050725115749.GV18998@elbert.is-a-geek.org>
Message-ID: <1122312122.12782.7.camel@taro.coolrunningconcepts.com>

On Mon, 2005-07-25 at 05:57 -0600, David Everly wrote:
> Gaim used to sort based on locale and we should too.  If locale is C
> then it would be sorted by case.

We always get into these arguments.  You want to do things gaim's way,
but I think gaim's way is useless.  This is just like the Allows list -
make it work useful, not "gaim's way".

-- Evan




From deckrider at gmail.com  Mon Jul 25 19:59:56 2005
From: deckrider at gmail.com (David Everly)
Date: Mon, 25 Jul 2005 11:59:56 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r241 - in qrc/trunk: gaym/src gaym-extras
In-Reply-To: <1122312122.12782.7.camel@taro.coolrunningconcepts.com>
References: <200507250457.j6P4v91M013374@sheep.berlios.de> <1122268067.19747.43.camel@taro.coolrunningconcepts.com> <20050725115749.GV18998@elbert.is-a-geek.org> <1122312122.12782.7.camel@taro.coolrunningconcepts.com>
Message-ID: <20050725175956.GA7933@elbert.is-a-geek.org>

On Mon, Jul 25, 2005 at 12:22:02PM -0500, Evan Langlois wrote:
> On Mon, 2005-07-25 at 05:57 -0600, David Everly wrote:
> > Gaim used to sort based on locale and we should too.  If locale is C
> > then it would be sorted by case.
> 
> We always get into these arguments.  You want to do things gaim's way,
> but I think gaim's way is useless.  This is just like the Allows list -
> make it work useful, not "gaim's way".

I'm sorry, are you suggesting we do not respect the user's locale?  If
so, why?

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html


From deckrider at gmail.com  Mon Jul 25 20:36:10 2005
From: deckrider at gmail.com (David Everly)
Date: Mon, 25 Jul 2005 12:36:10 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r239 - in qrc/trunk: gaym/src gaym-extras
In-Reply-To: <1122311748.12782.1.camel@taro.coolrunningconcepts.com>
References: <200507241936.j6OJa8dC013004@sheep.berlios.de> <20050724152716.r8vd2tfrtypwgo8c@coolrunningconcepts.com> <1122253085.16892.102.camel@localhost> <1122268288.19747.47.camel@taro.coolrunningconcepts.com> <20050725121203.GX18998@elbert.is-a-geek.org> <1122311748.12782.1.camel@taro.coolrunningconcepts.com>
Message-ID: <20050725183609.GB7933@elbert.is-a-geek.org>

On Mon, Jul 25, 2005 at 12:15:47PM -0500, Evan Langlois wrote:
> On Mon, 2005-07-25 at 06:12 -0600, David Everly wrote:
> 
> > I disagree.  The extra IRC info is what we should use and it should be
> > consistently positioned/located across the application.  The only http
> > call should be for the thumbnail from the IRC info.
> > 
> > The mini-profile should likewise not display the IRC info, but
> > everything that is available within it.
> 
> A good interface has nothing to do with where gay.com puts their
> information.

A good interface reflects the intention of the protocol.  The only
intention I think its valid to deviate from is when you can get some
paid feature at an unpaid price without too much standing on one's head
to do it.  Polling instead of using notifications is one concession in
that area (and is also a good example of why its bad to do this, because
it causes you do work with the protocol in a network-inefficient manner.

> I'll consider other arguments, but the simply doesn't care where the
> information comes from - why should you?

The interface should not break the grouping of information.

The IRC-related stuff is more temporal.

The IRC-related stuff does not require additional http requests.  We
should minimize additional http requests when populating chat, IM, buddy
frames.  (Clearly, thumbnail is an exception, and is meant to be so, as
evidenced by gay.com's own client).

The profile stuff should be grouped together, and "Get Info" is the
logical collection of profile stuff.  It is not so "immediate" in that
it is not meant to be changed as often as the bio (notifications are
sent when the bio is changed).

On the larger question, I think we should follow these rules (and we
should settle this at some point by discussing at this level rather than
re-hashing this issue every time something new comes up):

   - Presentation should be as Gaim-like as possible and should be our
     default starting position.  If we deviate, we should have a good
     rationale.  "I like it better", "Field X is more informative to me
     than field Y", "Some other application does it this way" are all
     not good enough reasons to deviate.  Like it or not, we are
     supporting integrated chat by working with Gaim, so we should try
     to do it as similarly as possible so as to make it easier for our
     users to understand.

   - Protocol interaction should be as much like Gay.com as possible,
     especially for efficiency and to keep us out of trouble by putting
     too much stress on the Gay.com servers and making them angry with
     us.  Exceptions to this are instances when Gaim consistency
     requires a slightly different approach.  And a long-standing
     exception is allowing the users to have buddy lists with complete
     names instead of truncated names.

   - We should respect logical protocol grouping and reflect that
     grouping within the user interface.

Without respecting such guidelines, what I want to know is what
rationale do we have against someone who wants to display everything in
the user's full profile in the IM or Chat windows?  Clearly there just
isn't enough space for this, but when you say "I want field X from the
user's profile to be displayed in these windows", I want to know how you
can objectively justify that field and not the inclusion of some 20 other
fields?  "I think this field is as relevant or more relevant than this
other field" is _not_ an objective answer, because someone with a
different opinion can come in and disagree.  Respecting the grouping
inherent in the protocol itself _is_ an objective measure, and can help
us be more effective in our efforts and less arbitrary in our decisions.

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html


From gaym at jasonlebrun.info  Tue Jul 26 04:59:35 2005
From: gaym at jasonlebrun.info (Jason LeBrun)
Date: Mon, 25 Jul 2005 21:59:35 -0500
Subject: [Qrc-devel] A release
In-Reply-To: <1122272939.27339.23.camel@taro.coolrunningconcepts.com>
References: <1122268031.16975.3.camel@localhost>
	 <1122272939.27339.23.camel@taro.coolrunningconcepts.com>
Message-ID: <1122346775.16975.32.camel@localhost>

> OK - when you click a user to see the thumbnail, the bio in the tooltip
> goes away.  Any way to make it come back sooner instead of leaving the
> name and coming back?

Noted. I can fix that easily.

> The icon scaling is definately weird.  Some people have thumbs that fit
> the little frame.  Any clue why mine has a huge border around it?

The frame should be fixed at 57x77 no matter the size of the icon.
That's how it behaves on mine. Can you send a few screenshots of your
icon area with various icons?

> > *I need to get the bio display in private (IM) windows in a better
> > place. 
> 
> How about at the top?   Is there a field for chatrooms to have a
> topic-line?  One of the IRC programs I used used to put some of the
> whois information in this line (user at hostmask I think) as a visual clue,
> and interface-wise that worked out well.  Having the bio at the top
> where the topic-line goes would be nifty.

I've been trying to get it at the top. If you enable OPT_PROTO_TOPIC
then the topic line appears, but it always has the Topic: label which
makes no sense. Anyway, the topic line does not show up at all for IM
windows, I don't think

It's not much harder to just make a new widget; a label instead of a
text entry area, so it doesn't look like you should be typing things in.
I just have to figure out how to order things correctly. I don't quite
understand box_pack_start and box_pack_end -- visually, they do the same
thing. I might have to tear up and re-pack the boxes to get my own thing
at the top.

In any case, I'll be playing around with that a lot more :)

Jason



From gaym at jasonlebrun.info  Tue Jul 26 05:00:51 2005
From: gaym at jasonlebrun.info (Jason LeBrun)
Date: Mon, 25 Jul 2005 22:00:51 -0500
Subject: [Qrc-devel] Re: [Qrc-svn] r239 - in qrc/trunk: gaym/src
	gaym-extras
In-Reply-To: <20050725120247.GW18998@elbert.is-a-geek.org>
References: <200507241936.j6OJa8dC013004@sheep.berlios.de>
	 <20050724152716.r8vd2tfrtypwgo8c@coolrunningconcepts.com>
	 <1122253085.16892.102.camel@localhost>
	 <1122268442.27339.1.camel@taro.coolrunningconcepts.com>
	 <1122269160.16975.23.camel@localhost>
	 <20050725120247.GW18998@elbert.is-a-geek.org>
Message-ID: <1122346852.16975.35.camel@localhost>

By "Lurking," I mean doing a /names on the room with an interface. So,
you'd see a list of names, and be able to browse
thumbnails/bios/profiles, without actually entering the room.

I'm not talking about "invisible" mode.

On Mon, 2005-07-25 at 06:02 -0600, David Everly wrote:
> On Mon, Jul 25, 2005 at 12:26:00AM -0500, Jason LeBrun wrote:
> > Some people still won't use it because the can't "lurk" :( 
> > I'll do that next weekend ;-)
> 
> Lurking is false....it simply sends a NOTIFY offline....which we ignore
> anyway since WHOIS still comes back positive.
> 



From gaym at jasonlebrun.info  Tue Jul 26 06:08:12 2005
From: gaym at jasonlebrun.info (Jason LeBrun)
Date: Mon, 25 Jul 2005 23:08:12 -0500
Subject: [Qrc-devel] Re: [Qrc-svn] r237 - in qrc/trunk: gaym/src
	gaym-extras
In-Reply-To: <20050725153623.GA6711@elbert.is-a-geek.org>
References: <200507240818.j6O8I8d8014691@sheep.berlios.de>
	 <20050724122415.GL18998@elbert.is-a-geek.org>
	 <1122221750.16892.93.camel@localhost>
	 <20050725004825.GT18998@elbert.is-a-geek.org>
	 <1122253562.16892.112.camel@localhost>
	 <20050725135516.GD18998@elbert.is-a-geek.org>
	 <20050725153623.GA6711@elbert.is-a-geek.org>
Message-ID: <1122350892.16975.51.camel@localhost>

> And as I think of it, I believe one of the following is already a place
> for this:
> 
>    GaimPlugin->extra;
>    GaimPluginInfo->extra_info;

Even if we register function pointers in an extra_info structure, the
pointers must be registered in some sort of structure. For example, we
might say that the extra_info points to:

struct GaymAPI {
	GaymBuddy* (*get_gaym_buddy);
	char* (*something_else);
}

In this case, the structures must be known by both gaym and gaym-extras.
This means that gaym-extras needs to see at *least* one of gaym's
headers. Since this is the case, why not just call the already exported
function directly? 

Jason








From evan at coolrunningconcepts.com  Tue Jul 26 06:38:30 2005
From: evan at coolrunningconcepts.com (evan at coolrunningconcepts.com)
Date: Mon, 25 Jul 2005 22:38:30 -0600
Subject: [Qrc-devel] A release
In-Reply-To: <1122346775.16975.32.camel@localhost>
References: <1122268031.16975.3.camel@localhost>
	<1122272939.27339.23.camel@taro.coolrunningconcepts.com>
	<1122346775.16975.32.camel@localhost>
Message-ID: <20050725223830.exybglenr97kkckk@coolrunningconcepts.com>

Quoting Jason LeBrun <gaym at jasonlebrun.info>:


> The frame should be fixed at 57x77 no matter the size of the icon.
> That's how it behaves on mine. Can you send a few screenshots of your
> icon area with various icons?

Not what I meant

The frame IS at 57x77, but in an IM window, the frame is always the 
size of the
icon.  Its not a big deal, its just consistent.   Also, I have no idea 
why, but
my icon ends up being centered in the 57x77 frame with a border of nothing
around it - no idea why it scales it down smaller than it needs to, but I'm
guessing its gay.com's fault.





From deckrider at gmail.com  Tue Jul 26 07:11:36 2005
From: deckrider at gmail.com (David Everly)
Date: Mon, 25 Jul 2005 23:11:36 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r237 - in qrc/trunk: gaym/src gaym-extras
In-Reply-To: <1122350892.16975.51.camel@localhost>
References: <200507240818.j6O8I8d8014691@sheep.berlios.de> <20050724122415.GL18998@elbert.is-a-geek.org> <1122221750.16892.93.camel@localhost> <20050725004825.GT18998@elbert.is-a-geek.org> <1122253562.16892.112.camel@localhost> <20050725135516.GD18998@elbert.is-a-geek.org> <20050725153623.GA6711@elbert.is-a-geek.org> <1122350892.16975.51.camel@localhost>
Message-ID: <20050726051136.GA18737@elbert.is-a-geek.org>

On Mon, Jul 25, 2005 at 11:08:12PM -0500, Jason LeBrun wrote:
> > And as I think of it, I believe one of the following is already a place
> > for this:
> > 
> >    GaimPlugin->extra;
> >    GaimPluginInfo->extra_info;
> 
> Even if we register function pointers in an extra_info structure, the
> pointers must be registered in some sort of structure. For example, we
> might say that the extra_info points to:
> 
> struct GaymAPI {
> 	GaymBuddy* (*get_gaym_buddy);
> 	char* (*something_else);
> }
> 
> In this case, the structures must be known by both gaym and gaym-extras.
> This means that gaym-extras needs to see at *least* one of gaym's
> headers. Since this is the case, why not just call the already exported
> function directly? 

Plugins are supposed to be able to be built independently of each other.
This mechanism lets the plugin decide what its "public" interfaces are.

The only reason we can call the function directly is because we have a
common tree available during our build process.  But this doesn't mean
we should be sloppy about our implementation.

Whats the technical objection for not following this mechanism?


-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html


From gaym at jasonlebrun.info  Tue Jul 26 07:50:00 2005
From: gaym at jasonlebrun.info (Jason LeBrun)
Date: Tue, 26 Jul 2005 00:50:00 -0500
Subject: [Qrc-devel] Re: [Qrc-svn] r237 - in qrc/trunk: gaym/src
	gaym-extras
In-Reply-To: <20050726051136.GA18737@elbert.is-a-geek.org>
References: <200507240818.j6O8I8d8014691@sheep.berlios.de>
	 <20050724122415.GL18998@elbert.is-a-geek.org>
	 <1122221750.16892.93.camel@localhost>
	 <20050725004825.GT18998@elbert.is-a-geek.org>
	 <1122253562.16892.112.camel@localhost>
	 <20050725135516.GD18998@elbert.is-a-geek.org>
	 <20050725153623.GA6711@elbert.is-a-geek.org>
	 <1122350892.16975.51.camel@localhost>
	 <20050726051136.GA18737@elbert.is-a-geek.org>
Message-ID: <1122357000.16975.56.camel@localhost>

> Plugins are supposed to be able to be built independently of each other.
> This mechanism lets the plugin decide what its "public" interfaces are.
> 
> The only reason we can call the function directly is because we have a
> common tree available during our build process.  But this doesn't mean
> we should be sloppy about our implementation.
> 
> Whats the technical objection for not following this mechanism?

We have to include the header anyway. We need gaym.h so that he have the
struct definitions. What's the technical reasoning for adding new
pointers, new structs, when we can simply call a function, since we
*HAVE* to have its definition, anyway? If the function pointer method
could avoid including the header, I'd consider it. But it can't.






From jason at jasonlebrun.info  Tue Jul 26 08:09:04 2005
From: jason at jasonlebrun.info (Jason LeBrun)
Date: Tue, 26 Jul 2005 01:09:04 -0500
Subject: [Qrc-devel] Login process
Message-ID: <1122358144.16975.60.camel@localhost>

I'm working on the login process updates. I need some help, especially
if someone can get dumps of chat client/chattage.

I'm trying to avoid using session-based html fetches if I can. I'm stuck
on one thing, right now: getting the thumbnail URL for the user's
thumbnail. Is there ANYWAY to get it besides from messenger/applet.html?

I can not get messenger/applet.html to load without establishing the
session cookies, which means we'd have to save all those as well...
yucky.

Any suggestions?

Jason



From deckrider at gmail.com  Tue Jul 26 12:36:08 2005
From: deckrider at gmail.com (David Everly)
Date: Tue, 26 Jul 2005 04:36:08 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r237 - in qrc/trunk: gaym/src gaym-extras
In-Reply-To: <1122357000.16975.56.camel@localhost>
References: <200507240818.j6O8I8d8014691@sheep.berlios.de> <20050724122415.GL18998@elbert.is-a-geek.org> <1122221750.16892.93.camel@localhost> <20050725004825.GT18998@elbert.is-a-geek.org> <1122253562.16892.112.camel@localhost> <20050725135516.GD18998@elbert.is-a-geek.org> <20050725153623.GA6711@elbert.is-a-geek.org> <1122350892.16975.51.camel@localhost> <20050726051136.GA18737@elbert.is-a-geek.org> <1122357000.16975.56.camel@localhost>
Message-ID: <20050726103608.GB18737@elbert.is-a-geek.org>

On Tue, Jul 26, 2005 at 12:50:00AM -0500, Jason LeBrun wrote:
> 
> > Plugins are supposed to be able to be built independently of each other.
> > This mechanism lets the plugin decide what its "public" interfaces are.
> > 
> > The only reason we can call the function directly is because we have a
> > common tree available during our build process.  But this doesn't mean
> > we should be sloppy about our implementation.
> > 
> > Whats the technical objection for not following this mechanism?
> 
> We have to include the header anyway. We need gaym.h so that he have the
> struct definitions. What's the technical reasoning for adding new
> pointers, new structs, when we can simply call a function, since we
> *HAVE* to have its definition, anyway? If the function pointer method
> could avoid including the header, I'd consider it. But it can't.

But we're still linking with your way.  With Gaim's way the link is not
necessary on any platform.

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html


From deckrider at gmail.com  Tue Jul 26 14:29:56 2005
From: deckrider at gmail.com (David Everly)
Date: Tue, 26 Jul 2005 06:29:56 -0600
Subject: [Qrc-devel] build is still broken
Message-ID: <20050726122955.GC18737@elbert.is-a-geek.org>

Creating library file: .libs/libgaym-extras.dll.a
.libs/gaym-extras.o: In function `changed_cb':
/home/deverly/qrc-nightly/trunk/gaym-extras/gaym-extras.c:422: undefined reference to `_gaym_get_channel_member_info'
.libs/gaym-extras.o: In function `tooltip_timeout':
/home/deverly/qrc-nightly/trunk/gaym-extras/gaym-extras.c:607: undefined reference to `_gaym_get_channel_member_info'
collect2: ld returned 1 exit status
make[2]: *** [libgaym-extras.la] Error 1
make[2]: Leaving directory `/home/deverly/qrc-nightly/trunk/gaym-extras'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/home/deverly/qrc-nightly/trunk'
make: *** [all] Error 2

-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html


From deckrider at gmail.com  Wed Jul 27 00:35:55 2005
From: deckrider at gmail.com (David Everly)
Date: Tue, 26 Jul 2005 16:35:55 -0600
Subject: [Qrc-devel] get info patch
Message-ID: <20050726223554.GA19330@elbert.is-a-geek.org>

Well it looks like I'm not going to have time to work on qrc for a
while.

Here is as far as I've gotten with Get Info.
-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
Index: gaym/src/gaym.h
===================================================================
--- gaym/src/gaym.h	(revision 247)
+++ gaym/src/gaym.h	(working copy)
@@ -28,6 +28,7 @@
 #include <glib.h>
 
 #include "roomlist.h"
+#include "connection.h"
 
 #define IRC_DEFAULT_SERVER "www.gay.com"
 #define IRC_DEFAULT_PORT 7514
@@ -52,6 +53,13 @@
     GString *string;
 };
 
+typedef struct _GaymProfile GaymProfile;
+struct _GaymProfile {
+    struct GaimGonnection *gc;
+    char *who;
+    GHashTable *profile;
+};
+
 enum { IRC_USEROPT_SERVER, IRC_USEROPT_PORT, IRC_USEROPT_CHARSET };
 enum gaym_state { IRC_STATE_NEW, IRC_STATE_ESTABLISHED };
 
@@ -79,7 +87,6 @@
     char *bio;
 
     gboolean blist_updating;
-    GHashTable *info_window_needed;
     GHashTable *im_thumbnail_needed;
 
     GString *motd;
Index: gaym/src/gayminfo.c
===================================================================
--- gaym/src/gayminfo.c	(revision 247)
+++ gaym/src/gayminfo.c	(working copy)
@@ -25,6 +25,10 @@
 #include "gayminfo.h"
 #include "util.h"
 #include "debug.h"
+#include "notify.h"
+#include "imgstore.h"
+#include "helpers.h"
+#include "gaym.h"
 
 char *gaym_thumbnail_strdup(const char *info)
 {
@@ -219,6 +223,195 @@
     return;
 }
 
+void gaym_display_profile(GaymProfile * gp)
+{
+    int i = 0;
+    char *tmp = NULL;
+    char *lookup = NULL;
+    char *title = g_strdup_printf("GayM - %s", gp->who);
+    char *primary = gp->who;
+
+    char *secondary = g_hash_table_lookup(gp->profile, "profhead");
+
+    GString *string = g_string_new("");
+
+    char *line = "<p><b>%s:</b> %s</p><br />\n";
+    char *caption = "<hr /><p><b>%s</b></p><br />\n";
+    char *image = "<p><img id=%s></p><br />\n";
+
+    lookup = g_hash_table_lookup(gp->profile, "headline");
+    if (lookup) {
+        g_string_append_printf(string, line, _("Headline"), lookup);
+        lookup = NULL;
+    }
+    lookup = g_hash_table_lookup(gp->profile, "modified_date");
+    if (lookup) {
+        g_string_append_printf(string, line, _("Last Updated"), lookup);
+        lookup = NULL;
+    }
+    lookup = g_hash_table_lookup(gp->profile, "loc_visible");
+    if (lookup) {
+        g_string_append_printf(string, line, _("Location"), lookup);
+        lookup = NULL;
+    }
+    lookup = g_hash_table_lookup(gp->profile, "age");
+    if (lookup) {
+        g_string_append_printf(string, line, _("Age"), lookup);
+        lookup = NULL;
+    }
+    lookup = g_hash_table_lookup(gp->profile, "anonymous");
+    if (lookup) {
+        g_string_append_printf(string, line, _("Anonymous"), lookup);
+        lookup = NULL;
+    }
+    lookup = g_hash_table_lookup(gp->profile, "my-private-pics-unlocked");
+    if (lookup) {
+        g_string_append_printf(string, line,
+                               _("Can see my private pictures"), lookup);
+        lookup = NULL;
+    }
+    lookup =
+        g_hash_table_lookup(gp->profile, "their-private-pics-unlocked");
+    if (lookup) {
+        g_string_append_printf(string, line,
+                               _("Can see their private pictures"),
+                               lookup);
+        lookup = NULL;
+    }
+    lookup = g_hash_table_lookup(gp->profile, "onhotlist");
+    if (lookup) {
+        g_string_append_printf(string, line, _("On my Hot List"), lookup);
+        lookup = NULL;
+    }
+    lookup = g_hash_table_lookup(gp->profile, "onbuddylist");
+    if (lookup) {
+        g_string_append_printf(string, line, _("On my Buddy List"),
+                               lookup);
+        lookup = NULL;
+    }
+
+    for (i = 0; TRUE; i++) {
+        tmp = g_strdup_printf("pictures.%d.url", i);
+        char *id = g_hash_table_lookup(gp->profile, tmp);
+        g_free(tmp);
+        tmp = NULL;
+        if (id != NULL) {
+            tmp = g_strdup_printf("pictures.%d.caption", i);
+            lookup = g_hash_table_lookup(gp->profile, tmp);
+            g_free(tmp);
+            tmp = NULL;
+            if (lookup != NULL) {
+                g_string_append_printf(string, caption, lookup);
+            }
+            g_string_append_printf(string, image, id);
+        } else {
+            /* no more pictures to display */
+            break;
+        }
+    }
+
+    char *text = g_string_free(string, FALSE);
+
+    gaim_notify_userinfo((GaimConnection *) gp->gc, gp->who, title,
+                         primary, secondary, text, NULL, NULL);
+
+    g_free(title);
+    g_free(text);
+
+    g_hash_table_destroy(gp->profile);
+    g_free(gp->who);
+    g_free(gp);
+}
+
+void gaym_profile_cb(void *data, const char *result, size_t len)
+{
+    int i = 0;
+
+    GaymProfile *gp = (GaymProfile *) data;
+    g_return_if_fail(gp != NULL);
+
+    GaimConnection *gc = (GaimConnection *) gp->gc;
+    struct gaym_conn *gaym = gc->proto_data;
+
+    if (gp->profile == NULL) {
+        /* we just got profile.txt, so process it */
+        gp->profile = gaym_properties_new(result);
+        if (gp->profile == NULL) {
+            /* FIXME: display or log error message */
+            g_free(gp->who);
+            g_free(gp);
+            return;
+        }
+        char *status = g_hash_table_lookup(gp->profile, "status");
+        if (status == NULL) {
+            /* FIXME: display or log error message */
+            g_hash_table_destroy(gp->profile);
+            g_free(gp->who);
+            g_free(gp);
+            return;
+        }
+        if (gaim_utf8_strcasecmp(status, "available") == 0) {
+            /* this user has a profile */
+            char *count = g_hash_table_lookup(gp->profile,
+                                              "pictures.count");
+            if (count == NULL) {
+                /* FIXME: display or log error message */
+                g_hash_table_destroy(gp->profile);
+                g_free(gp->who);
+                g_free(gp);
+                return;
+            }
+            for (i = atoi(count); i > 0; i--) {
+                char *prop = g_strdup_printf("pictures.%d.url", i - 1);
+                char *path = g_hash_table_lookup(gp->profile, prop);
+                g_free(prop);
+                if (path) {
+                    g_hash_table_replace(gp->profile,
+                                         g_strdup("pictures.count"),
+                                         g_strdup_printf("%d", i - 1));
+                    char *url =
+                        g_strdup_printf("http://%s%s", gaym->server,
+                                        path);
+                    gaim_url_fetch(url, FALSE, "Mozilla/4.0", FALSE,
+                                   gaym_profile_cb, gp);
+                    g_free(url);
+                    return;
+                }
+            }
+            /* this user has a profile, but no pictures */
+            gaym_display_profile(gp);
+            return;
+        } else {
+            /* FIXME: indicate that this user has no profile */
+        }
+    } else {
+        /* we just got a picture back */
+        int id = gaim_imgstore_add(result, len, NULL);
+        char *count = g_hash_table_lookup(gp->profile, "pictures.count");
+        char *prop = g_strdup_printf("pictures.%s.url", count);
+        g_hash_table_replace(gp->profile, prop, g_strdup_printf("%d", id));
+        for (i = atoi(count); i > 0; i--) {
+            char *prop = g_strdup_printf("pictures.%d.url", i - 1);
+            char *path = g_hash_table_lookup(gp->profile, prop);
+            g_free(prop);
+            if (path) {
+                g_hash_table_replace(gp->profile,
+                                     g_strdup("pictures.count"),
+                                     g_strdup_printf("%d", i));
+                char *url = g_strdup_printf("http://%s%s", gaym->server,
+                                            path);
+                gaim_url_fetch(url, FALSE, "Mozilla/4.0", FALSE,
+                               gaym_profile_cb, gp);
+                g_free(url);
+                return;
+            }
+        }
+        /* we are finished getting all the pictures */
+        gaym_display_profile(gp);
+        return;
+    }
+}
+
 /**
  * vim:tabstop=4:shiftwidth=4:expandtab:
  */
Index: gaym/src/msgs.c
===================================================================
--- gaym/src/msgs.c	(revision 247)
+++ gaym/src/msgs.c	(working copy)
@@ -109,115 +109,6 @@
     g_free(d);
 }
 
-static void gaym_fetch_photo_cb(void *user_data, const char *info_data,
-                                size_t len)
-{
-    if (!info_data || !user_data) {
-        return;
-    }
-
-    struct gaym_fetch_thumbnail_data *d = user_data;
-
-    char *info, *t;
-
-    struct gaym_conn *gaym = d->gc->proto_data;
-
-    char *hashurl =
-        g_hash_table_lookup(gaym->confighash, "view-profile-url");
-    g_return_if_fail(hashurl != NULL);
-
-    int id = gaim_imgstore_add(info_data, len, NULL);
-    if (d->stats && d->bio)
-        info =
-            g_strdup_printf
-            ("<b>Stats:</b> %s<br><b>Bio:</b> %s<br><img id=%d><br><a href='%s%s'>Full Profile</a>",
-             d->stats, d->bio, id, hashurl, d->who);
-    else if (d->stats)
-        info =
-            g_strdup_printf
-            ("<b>Stats:</b> %s<br><img id=%d><br><a href='%s%s'>Full Profile</a>",
-             d->stats, id, hashurl, d->who);
-    else if (d->bio)
-        info =
-            g_strdup_printf
-            ("<b>Bio:</b> %s<br><img id=%d><br><a href='%s%s'>Full Profile</a>",
-             d->bio, id, hashurl, d->who);
-    else
-        info =
-            g_strdup_printf
-            ("No Info Found<br><img id=%d><br><a href='%s%s'>Full Profile</a>",
-             id, hashurl, d->who);
-
-    gaim_notify_userinfo(d->gc, d->who,
-                         t = g_strdup_printf("Gay.com - %s", d->who),
-                         d->who, NULL, info, NULL, NULL);
-    g_free(t);
-
-    if (d) {
-        if (d->who)
-            g_free(d->who);
-        if (d->bio)
-            g_free(d->bio);
-        if (d->stats)
-            g_free(d->stats);
-        g_free(d);
-    }
-    gaim_imgstore_unref(id);
-}
-
-static void gaym_fetch_info_cb(void *user_data, const char *info_data,
-                               size_t len)
-{
-    struct gaym_fetch_thumbnail_data *d = user_data;
-    char *picpath;
-    char *picurl;
-    char *info, *t;
-    char *match = "pictures.0.url=";
-
-    struct gaym_conn *gaym = d->gc->proto_data;
-
-    char *hashurl =
-        g_hash_table_lookup(gaym->confighash, "view-profile-url");
-    g_return_if_fail(hashurl != NULL);
-
-    if (d->stats && d->bio)
-        info =
-            g_strdup_printf
-            ("<b>Stats:</b> %s<br><b>Bio:</b> %s<br><a href='%s%s'>Full Profile</a>",
-             d->stats, d->bio, hashurl, d->who);
-    else if (d->stats)
-        info =
-            g_strdup_printf
-            ("<b>Stats:</b> %s<br><a href='%s%s'>Full Profile</a>",
-             d->stats, hashurl, d->who);
-    else if (d->bio)
-        info =
-            g_strdup_printf
-            ("<b>Bio:</b> %s<br><a href='%s%s'>Full Profile</a>",
-             d->bio, hashurl, d->who);
-    else
-        info =
-            g_strdup_printf
-            ("No Info Found<br><a href='%s%s'>Full Profile</a>",
-             hashurl, d->who);
-
-    picpath = return_string_between(match, "\n", info_data);
-    if (!picpath || strlen(picpath) == 0) {
-        gaim_notify_userinfo(d->gc, d->who,
-                             t = g_strdup_printf("Gay.com - %s", d->who),
-                             d->who, NULL, info, NULL, NULL);
-        g_free(t);
-        return;
-    }
-
-    picurl = g_strdup_printf("http://www.gay.com%s", picpath);
-    if (picurl) {
-        gaim_url_fetch(picurl, FALSE, "Mozilla/4.0 (compatible; MSIE 5.0)",
-                       FALSE, gaym_fetch_photo_cb, user_data);
-        return;
-    }
-}
-
 void gaym_msg_no_such_nick(struct gaym_conn *gaym, const char *name,
                            const char *from, char **args)
 {
@@ -234,26 +125,6 @@
     gcom_nick_to_gaym(args[1]);
 
     gaym_buddy_status(gaym, args[1], FALSE, NULL);
-
-    char *normalized = g_strdup(gaim_normalize(gaym->account, args[1]));
-
-    if (g_hash_table_lookup(gaym->info_window_needed, normalized)) {
-        g_hash_table_remove(gaym->info_window_needed, normalized);
-
-        char *hashurl =
-            g_hash_table_lookup(gaym->confighash, "view-profile-url");
-        g_return_if_fail(hashurl != NULL);
-
-        char *buf;
-        buf =
-            g_strdup_printf
-            ("That user is not logged on. Check <a href='%s%s'>here</a> to see if that user has a profile.",
-             hashurl, args[1]);
-        gaim_notify_userinfo(gaim_account_get_connection(gaym->account),
-                             NULL, NULL, "No such user", NULL, buf, NULL,
-                             NULL);
-    }
-    g_free(normalized);
 }
 
 void gaym_msg_whois(struct gaym_conn *gaym, const char *name,
@@ -273,39 +144,14 @@
 
     gaym_buddy_status(gaym, args[1], TRUE, args[5]);
 
-    char *normalized = g_strdup(gaim_normalize(gaym->account, args[1]));
-
-    struct gaym_fetch_thumbnail_data *data;
-
-    // Update, but then release the reference. It was already opened
-    // during conversation-created.
+    /**
+     * Update, but then release the reference. It was already opened
+     * during conversation-created.
+     */
     gaym_update_channel_member(gaym, args[1], args[5]);
     gaym_unreference_channel_member(gaym, args[1]);
     gaim_signal_emit(gaim_accounts_get_handle(), "info-updated",
                      gaym->account, args[1]);
-
-    if (g_hash_table_lookup(gaym->info_window_needed, normalized)) {
-
-        data = g_new0(struct gaym_fetch_thumbnail_data, 1);
-        data->gc = gaim_account_get_connection(gaym->account);
-        data->who = g_strdup(args[1]);
-        data->bio = gaym_bio_strdup(args[5]);
-        data->stats = gaym_stats_strdup(args[5]);
-        g_hash_table_remove(gaym->info_window_needed, normalized);
-        char *hashurl = g_hash_table_lookup(gaym->confighash,
-                                            "ohm.profile-url");
-        g_return_if_fail(hashurl != NULL);
-
-        char *infourl = g_strdup_printf("%s?pw=%s&name=%s", hashurl,
-                                        gaym->chat_key, args[1]);
-        if (infourl) {
-            gaim_url_fetch(infourl, FALSE,
-                           "Mozilla/4.0 (compatible; MSIE 5.0)", FALSE,
-                           gaym_fetch_info_cb, data);
-            g_free(infourl);
-        }
-    }
-    g_free(normalized);
 }
 
 void gaym_msg_login_failed(struct gaym_conn *gaym, const char *name,
Index: gaym/src/gayminfo.h
===================================================================
--- gaym/src/gayminfo.h	(revision 247)
+++ gaym/src/gayminfo.h	(working copy)
@@ -87,6 +87,7 @@
 void gaym_buddy_status(struct gaym_conn *gaym, char *name,
                        gboolean online, char *info);
 
+void gaym_profile_cb(void *data, const char *result, size_t len);
 
 void gaym_update_channel_member(struct gaym_conn *gaym, const char *nick,
                                 const char *info);
Index: gaym/src/gaym.c
===================================================================
--- gaym/src/gaym.c	(revision 247)
+++ gaym/src/gaym.c	(working copy)
@@ -494,21 +494,16 @@
     gaym->msgs = g_hash_table_new(g_str_hash, g_str_equal);
     gaym_msg_table_build(gaym);
     gaym->roomlist_filter = NULL;
-    /**
-     * The last parameter needs to be NULL here, since the same
-     * field is added for both the key and the value (and if we
-     * free it twice, thats bad and causes crashing!).
-     */
-    gaym->info_window_needed =
-        g_hash_table_new_full(g_str_hash, g_str_equal, g_free, NULL);
 
     gaym->entry_order =
         g_hash_table_new_full(g_str_hash, g_str_equal, g_free, g_free);
 
     /**
-     * This is similar to gaym->info_window_needed, except this is
-     * for thumbails inside the IM conversation window if the
+     * For thumbails inside the IM conversation window if the
      * person is not already on the buddy list
+     * The last parameter needs to be NULL here, since the same
+     * field is added for both the key and the value (and if we
+     * free it twice, thats bad and causes crashing!).
      */
     gaym->im_thumbnail_needed =
         g_hash_table_new_full(g_str_hash, g_str_equal, g_free, NULL);
@@ -684,7 +679,6 @@
 
     g_hash_table_destroy(gaym->cmds);
     g_hash_table_destroy(gaym->msgs);
-    g_hash_table_destroy(gaym->info_window_needed);
     g_hash_table_destroy(gaym->entry_order);
     g_hash_table_destroy(gaym->im_thumbnail_needed);
     if (gaym->motd)
@@ -739,18 +733,27 @@
 static void gaym_get_info(GaimConnection * gc, const char *who)
 {
     struct gaym_conn *gaym = gc->proto_data;
-    const char *args[1];
-    args[0] = who;
+    g_return_if_fail(gaym != NULL);
+    g_return_if_fail(gaym->confighash != NULL);
+    g_return_if_fail(gaym->chat_key != NULL);
 
-    char *normalized = g_strdup(gaim_normalize(gc->account, who));
-    /**
-     * We are adding the same char* to both the key and the value.
-     * If this changes, we need to change the corresponding
-     * g_hash_table_new_full() so that things are properly cleaned
-     * up during the remove/destroy phase.
-     */
-    g_hash_table_insert(gaym->info_window_needed, normalized, normalized);
-    gaym_cmd_whois(gaym, "whois", NULL, args);
+    char *hashurl =
+        g_hash_table_lookup(gaym->confighash, "ohm.profile-url");
+    g_return_if_fail(hashurl != NULL);
+
+    GaymProfile *gp = g_new0(GaymProfile, 1);
+    gp->gc = (struct GaimGonnection *) gc;
+    gp->who = g_strdup(gaim_normalize(gc->account, who));
+    gp->profile = NULL;
+
+    char *infourl = g_strdup_printf("%s?pw=%s&name=%s", hashurl,
+                                    gaym->chat_key, who);
+
+    if (infourl) {
+        gaim_url_fetch(infourl, FALSE, "Mozilla/4.0", FALSE,
+                       gaym_profile_cb, gp);
+        g_free(infourl);
+    }
 }
 
 static void gaym_set_away(GaimConnection * gc, const char *state,
@@ -1125,11 +1128,11 @@
 
 static guint gaym_nick_hash(const char *nick)
 {
-    char *lc=NULL;
+    char *lc = NULL;
     guint bucket;
-    
-    if(!nick)
-	return NULL;
+
+    if (!nick)
+        return NULL;
     lc = g_utf8_strdown(nick, -1);
     bucket = g_str_hash(lc);
     g_free(lc);

From deckrider at gmail.com  Wed Jul 27 00:40:14 2005
From: deckrider at gmail.com (David Everly)
Date: Tue, 26 Jul 2005 16:40:14 -0600
Subject: [Qrc-devel] nightly build
Message-ID: <20050726224014.GB19330@elbert.is-a-geek.org>

Here is the script I was using for the nightly build.  It isn't very
elegant, perhaps someone else may find a better way:



-- 
Encrypted Mail Preferred:
    Key ID:  8527B9AF
    Key Fingerprint:  E1B6 40B6 B73F 695E 0D3B  644E 6427 DD74 8527 B9AF
    Information:  http://www.gnupg.org/
                                                                                
ASCII ribbon campaign:
()  against HTML email
/\  against Microsoft attachments
    Information:  http://www.expita.com/nomime.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: build.sh
Type: application/x-sh
Size: 1893 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050726/9bff3b38/attachment.sh>

From gaym at jasonlebrun.info  Wed Jul 27 06:10:15 2005
From: gaym at jasonlebrun.info (Jason LeBrun)
Date: Tue, 26 Jul 2005 23:10:15 -0500
Subject: [Qrc-devel] Request for packet dumps
Message-ID: <1122437415.16993.11.camel@localhost>

Hey everyone,

If any is a windows user, and uses chattage or gayboi.org's chat client,
and you know how to use Ethereal, can you send me a pcap of the login
process of those clients, from start to finish? I just want to take a
look at them to see if there's any new information I can use.

Thanks!

Jason




From Evan at CoolRunningConcepts.com  Wed Jul 27 21:23:48 2005
From: Evan at CoolRunningConcepts.com (Evan Langlois)
Date: Wed, 27 Jul 2005 14:23:48 -0500
Subject: [Qrc-devel] Re: [Qrc-svn] r248 - in qrc/trunk: . gaym/src gaym-extras
In-Reply-To: <200507270748.j6R7mLED002822@sheep.berlios.de>
References: <200507270748.j6R7mLED002822@sheep.berlios.de>
Message-ID: <1122492228.32635.37.camel@taro.coolrunningconcepts.com>

On Wed, 2005-07-27 at 09:48 +0200, Jason LeBrun at BerliOS wrote:

> *File-Caching of images locally to avoid http requests
> *Icons in tooltip popups
> *Restructuring of gaym-extras files to be neater
> 
> Question for everyone: Should we get rid of Icon in corner completely, in chat windows?

Which corner icon?  If you mean in pop-ups (since the icon would be the
same for everyone), you could put a thumbnail there, which may be better
than the gay.com/chat client method.

> Things to be done before next release:
> *Fix hammering
> *Finish thumbnail-caching system
> *Perfect popup layout
> *Clean up icon rendering code (uses a lot of crap for animated icons)
> *Use info-updated signal to signal popup repaints
> *Verify a windows build

Hammering is horribly broken.  A windows build would be really nice
since bugs that don't hurt Linux often make the Windows version crash.
Also - add Get Info changes to the list ... at least get the profile
header in there.

Wish the qrc-svn list had a reply-to of svn-devel.



From Evan at CoolRunningConcepts.com  Wed Jul 27 22:03:54 2005
From: Evan at CoolRunningConcepts.com (Evan Langlois)
Date: Wed, 27 Jul 2005 15:03:54 -0500
Subject: [Qrc-devel] Re: [Qrc-svn] r248 - in qrc/trunk: . gaym/src gaym-extras
In-Reply-To: <200507270748.j6R7mLED002822@sheep.berlios.de>
References: <200507270748.j6R7mLED002822@sheep.berlios.de>
Message-ID: <1122494634.23279.1.camel@taro.coolrunningconcepts.com>

Just an FYI - r 248 crashes even if I just go to Tools->Preferences.  I
had to go back to 247.




From gaym at jasonlebrun.info  Thu Jul 28 06:39:10 2005
From: gaym at jasonlebrun.info (Jason LeBrun)
Date: Wed, 27 Jul 2005 23:39:10 -0500
Subject: [Qrc-devel] Login process!
Message-ID: <1122525550.19563.5.camel@localhost>

It seems like the login process is being further confounded, and that
you need to get cookies from some of the ad servers in order to properly
log in. Can anyone confirm this? I could definitely use some help fixing
this, so if anyone is any good with Ethereal, now would be the time to
jump in.

Jason




From gaym at jasonlebrun.info  Thu Jul 28 08:10:07 2005
From: gaym at jasonlebrun.info (Jason LeBrun)
Date: Thu, 28 Jul 2005 01:10:07 -0500
Subject: [Qrc-devel] Login
Message-ID: <1122531007.19563.13.camel@localhost>

I've identified the problem. Nothing to do with ads, after all. It will
be fixed in a day or so.

Sorry, I do have to sleep, you know.

Jason



From evan at coolrunningconcepts.com  Thu Jul 28 09:38:10 2005
From: evan at coolrunningconcepts.com (evan at coolrunningconcepts.com)
Date: Thu, 28 Jul 2005 01:38:10 -0600
Subject: [Qrc-devel] Login process!
In-Reply-To: <1122525550.19563.5.camel@localhost>
References: <1122525550.19563.5.camel@localhost>
Message-ID: <20050728013810.t96sz5dhi7swc8c4@coolrunningconcepts.com>

Quoting Jason LeBrun <gaym at jasonlebrun.info>:

> It seems like the login process is being further confounded, and that
> you need to get cookies from some of the ad servers in order to properly
> log in. Can anyone confirm this? I could definitely use some help fixing
> this, so if anyone is any good with Ethereal, now would be the time to
> jump in.

I have an ethereal dump if you need it, but it looks like r247 is broken (was
working hours ago), but the released version does in fact work (I have 
it under
Windows and it seems to work fine).

So, whatever was changed in the login process - change it back.

Why did we change the login procedure?

-- Evan




From gaym at jasonlebrun.info  Thu Jul 28 10:08:41 2005
From: gaym at jasonlebrun.info (Jason LeBrun)
Date: Thu, 28 Jul 2005 03:08:41 -0500
Subject: [Qrc-devel] svn is broken :(
In-Reply-To: <20050728010143.afkc6i0zvzkskkgg@coolrunningconcepts.com>
References: <1122525550.19563.5.camel@localhost>
	 <20050727232137.pb9gndcv5r4kk4co@coolrunningconcepts.com>
	 <1122528089.19563.7.camel@localhost>
	 <20050727233826.wvpmr9wkri84occc@coolrunningconcepts.com>
	 <1122530966.19563.11.camel@localhost>
	 <20050728010143.afkc6i0zvzkskkgg@coolrunningconcepts.com>
Message-ID: <1122538121.19563.21.camel@localhost>

i can not commit.
if you already have r248 as your working copy, this patch fixes a lot.


this was the log:
*Lots of bugfixes!
*Chat icons in popups, if they've been cached in a file already.
*Fixed cookie code so gay.com lets us login again.
*Applied indent to everything


We need a new numbering system. How about this is release 0.9?
Still on the table before a release:
*Fix hammer code.
*Finish thumbnail caching system (it's never cleaned at ALL, once you
get an icon, that's what you'll see forever).
*Have popups trigger thumbnail fetches
*Have popups update when thumbnails arrive
*Windows build? Anyone want to test this? It builds... need some dll
guinea pigs. See README.mingw for details.

Longer term goals (release 1.0
*Completely redone info window
*Floating info window
*Caching of things like your thumbnail and config.txt, so we can login
super fast.
*Roombrowser (see who is in a room without entering... super /names)


On Thu, 2005-07-28 at 01:01 -0600, evan at coolrunningconcepts.com wrote:
> Quoting Jason LeBrun <gaym at jasonlebrun.info>:
> 
> > Ok, I got my python script working again. It seems that it didn't like
> > my haphazard way of sending cookies. I'm gonna have to clean it up a
> > lot.
> 
> I'm wondering what gay.com has changed, and has the gaym cookie code 
> changed any
> time recently?
> 
> 
> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: r249-svn-is-broke.patch
Type: text/x-patch
Size: 34619 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/qrc-devel/attachments/20050728/934e3111/attachment.bin>

From evan at coolrunningconcepts.com  Thu Jul 28 12:21:13 2005
From: evan at coolrunningconcepts.com (evan at coolrunningconcepts.com)
Date: Thu, 28 Jul 2005 04:21:13 -0600
Subject: [Qrc-devel] Login process!
In-Reply-To: <1122537428.19563.16.camel@localhost>
References: <1122525550.19563.5.camel@localhost>
	<20050727232137.pb9gndcv5r4kk4co@coolrunningconcepts.com>
	<1122528089.19563.7.camel@localhost>
	<20050727233826.wvpmr9wkri84occc@coolrunningconcepts.com>
	<1122530966.19563.11.camel@localhost>
	<20050728010143.afkc6i0zvzkskkgg@coolrunningconcepts.com>
	<1122537428.19563.16.camel@localhost>
Message-ID: <20050728042113.yuv116436ok8wows@coolrunningconcepts.com>

Quoting Jason LeBrun <gaym at jasonlebrun.info>:

> The gaym cookie code didn't change at all. It was really bad to begin
> with. It just blindly appending every cookie field it got onto a giant
> string. I guess gay.com didn't like all the garbage, anymore. The newly
> committed system uses hash tables and is much prettier. I also got rid
> of two steps that are not necessary anymore.

OK, so why is it that r247 (r248 won't run for me - I can't even open the
Preferences dialog without a crash) won't log in, but older versions DO work
just fine.   I have a Windows box right next to my Linux box (mainly for
testing web sites in IE to make sure they display) and the Windows box has the
last released Windows version of gaim.

If the login code didn't change, why does the Windows box log in to 
gay.com just
fine using gaim?

Why is SVN broke again?



From evan at coolrunningconcepts.com  Fri Jul 29 03:24:53 2005
From: evan at coolrunningconcepts.com (evan at coolrunningconcepts.com)
Date: Thu, 28 Jul 2005 19:24:53 -0600
Subject: [Qrc-devel] Thumbnails
In-Reply-To: <20050728042113.yuv116436ok8wows@coolrunningconcepts.com>
References: <1122525550.19563.5.camel@localhost>
	<20050727232137.pb9gndcv5r4kk4co@coolrunningconcepts.com>
	<1122528089.19563.7.camel@localhost>
	<20050727233826.wvpmr9wkri84occc@coolrunningconcepts.com>
	<1122530966.19563.11.camel@localhost>
	<20050728010143.afkc6i0zvzkskkgg@coolrunningconcepts.com>
	<1122537428.19563.16.camel@localhost>
	<20050728042113.yuv116436ok8wows@coolrunningconcepts.com>
Message-ID: <20050728192453.qvndm8y8awzoc04o@coolrunningconcepts.com>

Hey ... just an idea since the subject of caching thumbnails was 
brought up and
when to refresh them and all that, and I noticed there isn't currently any
prefetch so there is almost never a previously cached copy unless you 
bother to
fetch it.  A prefetch might be nice.

How about when someone joins the channel, grab the thumbnail URL and if its
different from what is in cache, then fetch the new one.  Since this would
cause a huge amount of network traffic when you first join a channel, don't do
updates and rely on cached copies until you see someone join after your join
message.  Otherwise, use the cached copy, relying on join messages to refresh
any old data - and possibly doing another fetch "on click" like it does now.

It would also be nice to be able to force a reload of the thumbnail 
even if the
URL hasn't changed and there is no join, etc, in case the cache is old or the
user JUST changed their profile .. perhaps during a Get Info force a thumb
reload?

Just ideas ...

-- Evan





From jason at jasonlebrun.info  Fri Jul 29 04:22:01 2005
From: jason at jasonlebrun.info (Jason LeBrun)
Date: Thu, 28 Jul 2005 21:22:01 -0500
Subject: [Qrc-devel] Thumbnails
In-Reply-To: <20050728192453.qvndm8y8awzoc04o@coolrunningconcepts.com>
References: <1122525550.19563.5.camel@localhost>
	 <20050727232137.pb9gndcv5r4kk4co@coolrunningconcepts.com>
	 <1122528089.19563.7.camel@localhost>
	 <20050727233826.wvpmr9wkri84occc@coolrunningconcepts.com>
	 <1122530966.19563.11.camel@localhost>
	 <20050728010143.afkc6i0zvzkskkgg@coolrunningconcepts.com>
	 <1122537428.19563.16.camel@localhost>
	 <20050728042113.yuv116436ok8wows@coolrunningconcepts.com>
	 <20050728192453.qvndm8y8awzoc04o@coolrunningconcepts.com>
Message-ID: <1122603721.19563.25.camel@localhost>

> How about when someone joins the channel, grab the thumbnail URL and if its
> different from what is in cache, then fetch the new one.  Since this would
> cause a huge amount of network traffic when you first join a channel, don't do

You totally read my mind today. Right now, gaym-extras fetches a photo.
I'm going to change it to gaym fetching the photo and chaching it in
gaym/icons, and then gaym-extras *ONLY* working with photos. If anyone
has a problem with that, then they obviously have a network pipe that
*FAR* exceed their ability to cache a few megs of photos, and frankly, I
would be bitter about that, and not change it, anyway.

> It would also be nice to be able to force a reload of the thumbnail 
> even if the
> URL hasn't changed and there is no join, etc, in case the cache is old or the

I could do that. Have you verified any cases where the same url path
points to a different jpg picture? 

Jason



From Evan at CoolRunningConcepts.com  Sat Jul 30 03:28:02 2005
From: Evan at CoolRunningConcepts.com (Evan Langlois)
Date: Fri, 29 Jul 2005 20:28:02 -0500
Subject: [Qrc-devel] BUG: gaym-extras
Message-ID: <1122686882.679.3.camel@taro.coolrunningconcepts.com>

OKay,

gaym-extras seems to be causing some weird bugs.  It looks like its
interfering with other protocols, because its crashing when using aim,
yahoo, and irc.  It works fine with gaym, but here's what happened when
I tried to close an IRC PVT (from freenode's nickserv or whatever) ...


Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread -1216153936 (LWP 671)]
0x63656e6e in ?? ()
(gdb) bt
#0  0x63656e6e in ?? ()
#1  0xb7b51349 in g_hash_table_lookup () from /usr/lib/libglib-2.0.so.0
#2  0xbfff806c in ?? ()
#3  0xb75f114f in gaym_unreference_channel_member (gaym=0x6e6f632d,
    name=0x841bb00 "\001") at gaym.c:838
Previous frame inner to this frame (corrupt stack?)
(gdb)


Sorry I don't have debugging turned on for gaim, so the places where
gaim and the default protocols are called is blank, but notice that
gaym_unreference_channel_member is called for IRC!

Can someone look into this.  I think all the instabilities and crashes
are due to the plugin trying to mess with stuff in all protocols and not
just gaym.





From Evan at CoolRunningConcepts.com  Sat Jul 30 04:05:16 2005
From: Evan at CoolRunningConcepts.com (Evan Langlois)
Date: Fri, 29 Jul 2005 21:05:16 -0500
Subject: [Qrc-devel] Thumbnails
In-Reply-To: <20050728192453.qvndm8y8awzoc04o@coolrunningconcepts.com>
References: <1122525550.19563.5.camel@localhost>
	 <20050727232137.pb9gndcv5r4kk4co@coolrunningconcepts.com>
	 <1122528089.19563.7.camel@localhost>
	 <20050727233826.wvpmr9wkri84occc@coolrunningconcepts.com>
	 <1122530966.19563.11.camel@localhost>
	 <20050728010143.afkc6i0zvzkskkgg@coolrunningconcepts.com>
	 <1122537428.19563.16.camel@localhost>
	 <20050728042113.yuv116436ok8wows@coolrunningconcepts.com>
	 <20050728192453.qvndm8y8awzoc04o@coolrunningconcepts.com>
Message-ID: <1122689117.786.1.camel@taro.coolrunningconcepts.com>

This time with just gaim/gaym and no other protocols.


Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread -1216153936 (LWP 713)]
0xb75e383d in tooltip_timeout (data=0x870acf8) at bio-popups.c:110
110     bio-popups.c: No such file or directory.
        in bio-popups.c
(gdb) bt
#0  0xb75e383d in tooltip_timeout (data=0x870acf8) at bio-popups.c:110
#1  0xb7b5cbf2 in g_main_context_wakeup ()
from /usr/lib/libglib-2.0.so.0
#2  0x08711a88 in ?? ()
#3  0xb7bac520 in ?? () from /usr/lib/libglib-2.0.so.0
#4  0x08711a88 in ?? ()
#5  0xb7bac820 in g_idle_funcs () from /usr/lib/libglib-2.0.so.0
#6  0xb7b5af02 in g_main_depth () from /usr/lib/libglib-2.0.so.0
#7  0x08711a88 in ?? ()
#8  0xb75e3800 in namelist_paint_tip () at bio-popups.c:52
Previous frame inner to this frame (corrupt stack?)




From jason at jasonlebrun.info  Sat Jul 30 06:49:17 2005
From: jason at jasonlebrun.info (Jason LeBrun)
Date: Fri, 29 Jul 2005 23:49:17 -0500
Subject: [Qrc-devel] Thumbnails
In-Reply-To: <1122689117.786.1.camel@taro.coolrunningconcepts.com>
References: <1122525550.19563.5.camel@localhost>
	 <20050727232137.pb9gndcv5r4kk4co@coolrunningconcepts.com>
	 <1122528089.19563.7.camel@localhost>
	 <20050727233826.wvpmr9wkri84occc@coolrunningconcepts.com>
	 <1122530966.19563.11.camel@localhost>
	 <20050728010143.afkc6i0zvzkskkgg@coolrunningconcepts.com>
	 <1122537428.19563.16.camel@localhost>
	 <20050728042113.yuv116436ok8wows@coolrunningconcepts.com>
	 <20050728192453.qvndm8y8awzoc04o@coolrunningconcepts.com>
	 <1122689117.786.1.camel@taro.coolrunningconcepts.com>
Message-ID: <1122698957.19563.38.camel@localhost>

Thanks for the report! The first problem was that it was trying to do
bio/thumbnail popups for all protocols. That's fixed. The second one
looks like a potential race condition. I'll have to look into it more.

Jason


On Fri, 2005-07-29 at 21:05 -0500, Evan Langlois wrote:
> This time with just gaim/gaym and no other protocols.
> 
> 
> Program received signal SIGSEGV, Segmentation fault.
> [Switching to Thread -1216153936 (LWP 713)]
> 0xb75e383d in tooltip_timeout (data=0x870acf8) at bio-popups.c:110
> 110     bio-popups.c: No such file or directory.
>         in bio-popups.c
> (gdb) bt
> #0  0xb75e383d in tooltip_timeout (data=0x870acf8) at bio-popups.c:110
> #1  0xb7b5cbf2 in g_main_context_wakeup ()
> from /usr/lib/libglib-2.0.so.0
> #2  0x08711a88 in ?? ()
> #3  0xb7bac520 in ?? () from /usr/lib/libglib-2.0.so.0
> #4  0x08711a88 in ?? ()
> #5  0xb7bac820 in g_idle_funcs () from /usr/lib/libglib-2.0.so.0
> #6  0xb7b5af02 in g_main_depth () from /usr/lib/libglib-2.0.so.0
> #7  0x08711a88 in ?? ()
> #8  0xb75e3800 in namelist_paint_tip () at bio-popups.c:52
> Previous frame inner to this frame (corrupt stack?)
> 
> 
> _______________________________________________
> Qrc-devel mailing list
> Qrc-devel at lists.berlios.de
> http://lists.berlios.de/mailman/listinfo/qrc-devel



From gaym at jasonlebrun.info  Sat Jul 30 11:07:48 2005
From: gaym at jasonlebrun.info (Jason LeBrun)
Date: Sat, 30 Jul 2005 04:07:48 -0500
Subject: [Qrc-devel] New commit
Message-ID: <1122714468.19563.42.camel@localhost>

There is a new version in SVN. Lots of bugs fixed, a new thumbnail
caching system, and lots of bugs to still find. So give it a try!

I will post windows builds later today.

Jason



From evan at coolrunningconcepts.com  Sat Jul 30 11:42:10 2005
From: evan at coolrunningconcepts.com (evan at coolrunningconcepts.com)
Date: Sat, 30 Jul 2005 03:42:10 -0600
Subject: [Qrc-devel] New commit
In-Reply-To: <1122714468.19563.42.camel@localhost>
References: <1122714468.19563.42.camel@localhost>
Message-ID: <20050730034210.99blbxhgowso4ksw@coolrunningconcepts.com>

Quoting Jason LeBrun <gaym at jasonlebrun.info>:

> There is a new version in SVN. Lots of bugs fixed, a new thumbnail
> caching system, and lots of bugs to still find. So give it a try!

Will do

> I will post windows builds later today.

I can test those too :)





From gaym at jasonlebrun.info  Sat Jul 30 17:32:06 2005
From: gaym at jasonlebrun.info (Jason LeBrun)
Date: Sat, 30 Jul 2005 10:32:06 -0500
Subject: [Qrc-devel] (no subject)
In-Reply-To: <20050730035755.1mddlzjtfb2g48gk@coolrunningconcepts.com>
References: <1122714468.19563.42.camel@localhost>
	 <20050730035755.1mddlzjtfb2g48gk@coolrunningconcepts.com>
Message-ID: <1122737526.19563.49.camel@localhost>

On Sat, 2005-07-30 at 03:57 -0600, evan at coolrunningconcepts.com wrote:
> 253 is way unstable - dies the moment it tries to display a thumbnail
> need a backtrace?   It should be easily reproduceable.   Testing 252 now...

I am seeing some dumb behavior with 253, but I haven't gotten it to
crash, yet.  A backtrace would definitely help... in particular, the
filename:line# part.

> 252 doesn't ever fetch the icons at all, and something about the tooltips has
> changed ... they seem to get in the way .. right clicking a user is often
> impossible because the tooltip won't get out of the way.

252+253 were a split commit. I don't know why I did that. Late and not
thinking clearly. I should have committed gaym in 252 and gaym-extras
and 253. Oops.

> BTW .. how tough would it be to add the person's name you just clicked 
> on to the
> tooltip?

I can do that.

> I'm going back to 250 .. and commenting out the bad line that was 
> making it die.
>   That was way more stable.  Sorry.

That's fine. Hopefully HEAD will become stable today.



From gaym at jasonlebrun.info  Sat Jul 30 23:36:40 2005
From: gaym at jasonlebrun.info (Jason LeBrun)
Date: Sat, 30 Jul 2005 16:36:40 -0500
Subject: [Qrc-devel] (no subject)
In-Reply-To: <20050730151335.z3xfd0pda8ocokk4@coolrunningconcepts.com>
References: <1122714468.19563.42.camel@localhost>
	 <20050730035755.1mddlzjtfb2g48gk@coolrunningconcepts.com>
	 <1122737526.19563.49.camel@localhost>
	 <20050730151335.z3xfd0pda8ocokk4@coolrunningconcepts.com>
Message-ID: <1122759400.19563.58.camel@localhost>

> Yay!  Names rock.  If there is no Location given, and the name is pretty long,
> then it gets cut slightly.  Looks like the code doesn't know that an italic
> takes up more room - can probably just bump up the width slightly.  Also it
> looks like the height is off too.  There is a nice border on the top and sides
> of the thumbnail in the popup, but some users have just a BIO and nothing else
> in the popup, so the thumbnail is on the very edge of the popup.  It doesn't
> look like it gets cut off .. but the zero border makes you wonder if it did or
> not.

If you find users that have oddly rendering bio popups, give me their
names, so I can check them out. Same with bizarre corner icons in the
chat panes.

> Is the sort icon/letters supposed to show the current sort or supposed to show
> what it will sort as if you click it.  It doesn't quite seem like its
> consistent - maybe its me.  It starts as E and sorts right, but as you change
> it, it stops making sense.

Logic bug. Should be fixed, with tooltips to help.

> Did you get the icons?  Not like em?

Just put 'em in the latest commit.

> > That's fine. Hopefully HEAD will become stable today.
> So far so good.  Its really fast at pulling those pics from the cache

When you join a room, it runs down the list, compares URLs with the
cache, and pipelines however many fetches it needs. You could have up to
100 HTTP requests firing off at once. I might have to change that, I'm
not sure if that is a bad thing or not.


> Oops .. wait .. SIGABRT .. looks like maybe a NULL pointer was passed 
> (maybe as
> a function pointer for a callback) to some gaim function and it logged it and
> through an abort.  Maybe it was an assert?    If I can make it happen 
> again and
> figure out when it does it, I'll recompile gaim with DEBUG set so I can 
> see what
> that last function is.

Asserts (g_return_if_fail) shouldn't cause aborts, just logged error
messages. I have been pretty aggressive about handling NULL pointers,
and I think most of the code is null-safe. Usually my problems are
un-initialized pointers, lately.

Jason



From evan at coolrunningconcepts.com  Sun Jul 31 00:26:23 2005
From: evan at coolrunningconcepts.com (evan at coolrunningconcepts.com)
Date: Sat, 30 Jul 2005 16:26:23 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r257 - in qrc/trunk: gaym/src gaym-extras/pixmaps
 gaym-extras/src
In-Reply-To: <200507302159.j6ULxQuu029856@sheep.berlios.de>
References: <200507302159.j6ULxQuu029856@sheep.berlios.de>
Message-ID: <20050730162623.jz2m56he878k8cc4@coolrunningconcepts.com>

> Layout fixes, one crash fix, and removal of over-committed files 
> (makefiles and .libs and .deps)

Oddly, I'm not getting mouse-overs on private messages

The chat sort icons aren't showing.  Not sure whats up with that .. I 
even went
into the directory and ran a make install

Ideas?




From evan at coolrunningconcepts.com  Sun Jul 31 04:07:26 2005
From: evan at coolrunningconcepts.com (evan at coolrunningconcepts.com)
Date: Sat, 30 Jul 2005 20:07:26 -0600
Subject: [Qrc-devel] Re: [Qrc-svn] r259 - in qrc/trunk: . gaym/src gaym-extras/src
In-Reply-To: <200507302219.j6UMJUpO031266@sheep.berlios.de>
References: <200507302219.j6UMJUpO031266@sheep.berlios.de>
Message-ID: <20050730200726.17oj3z57jnokccsg@coolrunningconcepts.com>

Odd ...

Pictures stopped displaying after having it running for awhile.

No clue why.

-- Evan



From evan at coolrunningconcepts.com  Sun Jul 31 04:24:45 2005
From: evan at coolrunningconcepts.com (evan at coolrunningconcepts.com)
Date: Sat, 30 Jul 2005 20:24:45 -0600
Subject: [Qrc-devel] File Descriptor Leak
In-Reply-To: <20050730200726.17oj3z57jnokccsg@coolrunningconcepts.com>
References: <200507302219.j6UMJUpO031266@sheep.berlios.de>
	<20050730200726.17oj3z57jnokccsg@coolrunningconcepts.com>
Message-ID: <20050730202445.6dt2i5z3cmg0g4go@coolrunningconcepts.com>

Quoting evan at coolrunningconcepts.com:

> Odd ...
>
> Pictures stopped displaying after having it running for awhile.
>
> No clue why.
>

No pictures display anywhere.  Not with Get Info or anything.  All the 
icons say
that no one has a pic anymore.  Not sure whats going on.  Maybe we overflowed
the hash table?

No icons in the buddy list anymore either.   Not even the mini icons .. every
image is going away.

Aha -- failed to create pipe - too many open files.  Looks like we have a file
descriptor leak!


*cry*

-- Evan




From evan at coolrunningconcepts.com  Sun Jul 31 04:42:48 2005
From: evan at coolrunningconcepts.com (evan at coolrunningconcepts.com)
Date: Sat, 30 Jul 2005 20:42:48 -0600
Subject: [Qrc-devel] FIX for File Descriptor Leak
In-Reply-To: <20050730202445.6dt2i5z3cmg0g4go@coolrunningconcepts.com>
References: <200507302219.j6UMJUpO031266@sheep.berlios.de>
	<20050730200726.17oj3z57jnokccsg@coolrunningconcepts.com>
	<20050730202445.6dt2i5z3cmg0g4go@coolrunningconcepts.com>
Message-ID: <20050730204248.0t6thdxmtykowk4s@coolrunningconcepts.com>

> Aha -- failed to create pipe - too many open files.  Looks like we 
> have a file
> descriptor leak!

Looks like in loopup_cached_thumbnail there is a g_dir_open() and no
g_dir_close().
I'm adding a g_dir_close(gdir); which I believe should replace g_free(gdir).
I'm trying it right before the g_free() instead to make sure, but I believe
that g_dir_close() should free the RAM as well (so I'll get a double 
free and a
crash).

Yup - double free .. crash.  Just replace the g_free(gdir) with
g_dir_close(gdir) on line 106.

I don't know if this will fix the too many open handles problem, but 
I'm betting
it will.

-- Evan




From evan at coolrunningconcepts.com  Sun Jul 31 04:47:42 2005
From: evan at coolrunningconcepts.com (evan at coolrunningconcepts.com)
Date: Sat, 30 Jul 2005 20:47:42 -0600
Subject: [Qrc-devel] pop-up bug
In-Reply-To: <20050730202445.6dt2i5z3cmg0g4go@coolrunningconcepts.com>
References: <200507302219.j6UMJUpO031266@sheep.berlios.de>
	<20050730200726.17oj3z57jnokccsg@coolrunningconcepts.com>
	<20050730202445.6dt2i5z3cmg0g4go@coolrunningconcepts.com>
Message-ID: <20050730204742.572xn9y4ps68kkg8@coolrunningconcepts.com>

If you switch to another tab before the pop-up goes away, or some 
combination of
right click menus and popups ... still looking on it .. then you can 
get a popup
that never goes away - this will eventually cause a crash.





From evan at coolrunningconcepts.com  Sun Jul 31 05:04:03 2005
From: evan at coolrunningconcepts.com (evan at coolrunningconcepts.com)
Date: Sat, 30 Jul 2005 21:04:03 -0600
Subject: [Qrc-devel] Channel JOIN bug
In-Reply-To: <20050730204742.572xn9y4ps68kkg8@coolrunningconcepts.com>
References: <200507302219.j6UMJUpO031266@sheep.berlios.de>
	<20050730200726.17oj3z57jnokccsg@coolrunningconcepts.com>
	<20050730202445.6dt2i5z3cmg0g4go@coolrunningconcepts.com>
	<20050730204742.572xn9y4ps68kkg8@coolrunningconcepts.com>
Message-ID: <20050730210403.paht41gyxrks8ccs@coolrunningconcepts.com>

Also seems to be some erratic behavior in the channel joins.  I pop 
from channel
to channel a lot so that it queues up lots of picture fetches (I abuse 
programs
when I test them).  Now I never get the pop-up telling me the channel is full
and asking if I want to hammer.

Not sure whats up with that, but it seems to be some sort of memory bug 
since if
I do it when I first start, it works .. it just fails sometime after that.

-- Evan




From evan at coolrunningconcepts.com  Sun Jul 31 11:21:20 2005
From: evan at coolrunningconcepts.com (evan at coolrunningconcepts.com)
Date: Sun, 31 Jul 2005 03:21:20 -0600
Subject: [Qrc-devel] Thumbnail compatibility
Message-ID: <20050731032120.3vmj5pnkkwckokw8@coolrunningconcepts.com>

This is slightly off-topic, but one of the things I want to do as far as display
options would involve user thumbnails, and gay.com really has the most. 
However, other protocols do as well.

Is there any sort of psuedo-standard way for a plugin to inquire the what the
thumbnail picture for a user is, which would be compatible to multiple prpls. 
Basically, I want to always get what would be displayed in the IM window or
Buddy List.

This possible?   I modified the display mangling plugin I did to make system
messages small and it no longer forwards the display to a gaim function but
actually has a local copy of the function.  Now I can change whatever I want
about it gets displayed ... assuming I know how and that the display widget has
enough capability.

Are there docs on what sort of formatting and layout are available?  I haven't
decided what configuration options I want yet, but perhaps some sort of theme
system?   May also add a "ignore repeats" flag since it would be fairly simple
- I only want to see the first one .. not all of em!

-- Evan


From evan at coolrunningconcepts.com  Sun Jul 31 13:35:48 2005
From: evan at coolrunningconcepts.com (evan at coolrunningconcepts.com)
Date: Sun, 31 Jul 2005 05:35:48 -0600
Subject: [Qrc-devel] GTKIMHTML
In-Reply-To: <20050731032120.3vmj5pnkkwckokw8@coolrunningconcepts.com>
References: <20050731032120.3vmj5pnkkwckokw8@coolrunningconcepts.com>
Message-ID: <20050731053548.s7708p5k64g08ckk@coolrunningconcepts.com>

Ugh .. anyone have docs on the GTKIMHTML widget that Gaim uses?

This thing is killing me.  Can't find any sort of positioning, and no way to
change a background color for part of the window, other than a font 
background.
  I want something like a DIV background or table background.

Anyone know how to tame this ugly beast?




From jason at jasonlebrun.info  Sun Jul 31 19:44:37 2005
From: jason at jasonlebrun.info (Jason LeBrun)
Date: Sun, 31 Jul 2005 12:44:37 -0500
Subject: [Qrc-devel] Thumbnail compatibility
In-Reply-To: <20050731032120.3vmj5pnkkwckokw8@coolrunningconcepts.com>
References: <20050731032120.3vmj5pnkkwckokw8@coolrunningconcepts.com>
Message-ID: <1122831877.19563.122.camel@localhost>

> Is there any sort of psuedo-standard way for a plugin to inquire the what the
> thumbnail picture for a user is, which would be compatible to multiple prpls. 
> Basically, I want to always get what would be displayed in the IM window or
> Buddy List.
> 

GaimBuddyIcon* icon=gaim_buddy_icons_find(account, username);
char* icon_data=gaim_buddy_icon_get_data(icon);

There is no way that I know of, however, to trigger an icon fetch, so it
only works for users in your buddy list, or who you are having a
conversation with. 


> This possible?   I modified the display mangling plugin I did to make system
> messages small and it no longer forwards the display to a gaim function but
> actually has a local copy of the function.  Now I can change whatever I want
> about it gets displayed ... assuming I know how and that the display widget has
> enough capability.

Can we make the usernames into profile links? I wanted to do that, but
it's impossible in the original display function, since HTML always
gets unescaped.

> Are there docs on what sort of formatting and layout are available?  I haven't
> decided what configuration options I want yet, but perhaps some sort of theme
> system?   May also add a "ignore repeats" flag since it would be fairly simple
> - I only want to see the first one .. not all of em!

http://gaim.sourceforge.net/api/gtkimhtml_8h.html



